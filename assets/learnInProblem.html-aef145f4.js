import{_ as e,W as o,X as c,a0 as n,a1 as s,Z as t,$ as p,C as i}from"./framework-c8643d23.js";const l="/Computer-Science-Learn-Notes/assets/logo-4bd1deea.jpg",u="/Computer-Science-Learn-Notes/assets/image-20220521211257013-42cc7f32.png",r="/Computer-Science-Learn-Notes/assets/image-20220521212519888-901b0930.png",d="/Computer-Science-Learn-Notes/assets/image-20220523105431566-19674118.png",k="/Computer-Science-Learn-Notes/assets/image-20220524232214510-ed884a8c.png",v="/Computer-Science-Learn-Notes/assets/image-20220525124905645-6facb95f.png",m="/Computer-Science-Learn-Notes/assets/image-20220529135255808-0bffa268.png",b="/Computer-Science-Learn-Notes/assets/image-20220529141540704-db0ed48f.png",g="/Computer-Science-Learn-Notes/assets/image-20220530203334648-31259c24.png",f="/Computer-Science-Learn-Notes/assets/image-20220529141826436-830b3126.png",h="/Computer-Science-Learn-Notes/assets/image-20220609131536632-6b9d36de.png",q="data:image/png;base64,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",y="data:image/png;base64,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",w="data:image/png;base64,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",A="/Computer-Science-Learn-Notes/assets/image-20220609140443914-b72d9545.png",x={},E=p('<h1 id="golang-learn-in-problem-从问题中学习到go的精髓" tabindex="-1"><a class="header-anchor" href="#golang-learn-in-problem-从问题中学习到go的精髓" aria-hidden="true">#</a> Golang-Learn-In-Problem 从问题中学习到Go的精髓</h1><figure><img src="'+l+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言" aria-hidden="true">#</a> 前言</h2><p>参考书目及视频：</p>',4),S={href:"https://github.com/unknwon/the-way-to-go_ZH_CN",target:"_blank",rel:"noopener noreferrer"},C={href:"https://geektutu.com/post/quick-golang.html",target:"_blank",rel:"noopener noreferrer"},L={href:"https://www.udemy.com/course/go-the-complete-developers-guide/",target:"_blank",rel:"noopener noreferrer"},N={href:"https://www.udemy.com/course/go-the-complete-developers-guide/",target:"_blank",rel:"noopener noreferrer"},D=n("h2",{id:"start",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#start","aria-hidden":"true"},"#"),s(" Start!")],-1),B=n("p",null,"下面的问题有些是自己思考问自己的，解答来自视频和思考。",-1),R={href:"https://go.dev/doc/faq%EF%BC%89",target:"_blank",rel:"noopener noreferrer"},T=p('<h3 id="golang为什么要有一个main的包" tabindex="-1"><a class="header-anchor" href="#golang为什么要有一个main的包" aria-hidden="true">#</a> Golang为什么要有一个main的包？</h3><p>这个问题我在第一次学习Go的时候没有深究（因为使用的是Goland进行编写）</p><p>Golang的包分为两种：可执行包和可重复使用的包 or 依赖类型的包（里面放了很多可重用的辅助函数或可重用的东西），后者可以再分为包计算者和包上传者，如下图所示</p><figure><img src="'+u+`" alt="image-20220521211257013" tabindex="0" loading="lazy"><figcaption>image-20220521211257013</figcaption></figure><p>通过实验（使用go build编译）可以看到，如果我把package换成了其他，例如：xiaomi，没有生成文件</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Mode                 LastWriteTime         Length Name

----                 -------------         ------ ----

-a----         <span class="token number">2022</span>/5/21     <span class="token number">21</span>:17             <span class="token number">76</span> main.go
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果归为main包，就可以看到</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----         <span class="token number">2022</span>/5/21     <span class="token number">21</span>:18        <span class="token number">1891328</span> main.exe
-a----         <span class="token number">2022</span>/5/21     <span class="token number">21</span>:18             <span class="token number">74</span> main.go
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>代码示例：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, world!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="go中的import是个什么原理" tabindex="-1"><a class="header-anchor" href="#go中的import是个什么原理" aria-hidden="true">#</a> Go中的import是个什么原理？</h3>`,11),I={href:"https://pkg.go.dev/std",target:"_blank",rel:"noopener noreferrer"},P=p('<p>我的理解是通过import连接其它的可重用文件（链接其他包）</p><figure><img src="'+r+`" alt="image-20220521212519888" tabindex="0" loading="lazy"><figcaption>image-20220521212519888</figcaption></figure><h3 id="【比较学习-举一反三】go在声明上和java有什么区别" tabindex="-1"><a class="header-anchor" href="#【比较学习-举一反三】go在声明上和java有什么区别" aria-hidden="true">#</a> 【比较学习，举一反三】Go在声明上和Java有什么区别？</h3><p>Java声明函数举例：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Go函数声明：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Java声明变量：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">String</span> a <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Go声明变量：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">var</span> a <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span>
or
a <span class="token operator">:=</span> <span class="token string">&quot;123&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Java声明数组：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Go的切片：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>a := []int{1, 2, 3, 4}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>其中的不同就是Go的切片可以相当于Java使用ArrayList</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code>a <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Java的for循环</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
or
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> ac in a<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
or <span class="token punctuation">(</span><span class="token keyword">if</span> a is a <span class="token class-name">List</span><span class="token punctuation">)</span>
a<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>e <span class="token operator">-&gt;</span> xxx<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Go的for循环</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">for</span> i<span class="token punctuation">,</span> num <span class="token operator">:=</span> <span class="token keyword">range</span> a <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Python的for循环</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">for</span> i<span class="token punctuation">,</span>num <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
    xxxx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Go的自定义类型：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> num <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>甚至可以为这个自定义类型声明一个成员函数</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> num <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>n num<span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> i<span class="token punctuation">,</span> nu <span class="token operator">:=</span> <span class="token keyword">range</span> n <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> nu<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+d+`" alt="image-20220523105431566" tabindex="0" loading="lazy"><figcaption>image-20220523105431566</figcaption></figure><p>上述中的 func (n num)中的<code>(n num)</code>实际上是接收器参数，每一个num类型的变量都可以调用此函数，老师的意思是实际上这是一个引用！</p><h3 id="go中的返回类型和java中有什么区别" tabindex="-1"><a class="header-anchor" href="#go中的返回类型和java中有什么区别" aria-hidden="true">#</a> Go中的返回类型和Java中有什么区别？</h3><p>Go可以返回多个，这个就和Java不一样，首先在函数的屁股后面加上返回的类型和个数，然后可以选择分片返回，这是Java8做不到的</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">deal</span><span class="token punctuation">(</span>d deck<span class="token punctuation">,</span> handSize <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>deck<span class="token punctuation">,</span> deck<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> d<span class="token punctuation">[</span><span class="token punctuation">:</span>handSize<span class="token punctuation">]</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span>handSize<span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里的分片又和python有异曲同工之妙，用法都一样</p><h3 id="go是如何读写文件的" tabindex="-1"><a class="header-anchor" href="#go是如何读写文件的" aria-hidden="true">#</a> Go是如何读写文件的？</h3><p>写</p><hr><p>首先它返回一个error，原因是这个工具包如果出错会抛出一个异常；另外toString做了把一个数组转换为一坨字符串的效果；最后的0666是权限，这个一般是任何人都可以用</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>d deck<span class="token punctuation">)</span> <span class="token function">saveToFile</span><span class="token punctuation">(</span>filename <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> ioutil<span class="token punctuation">.</span><span class="token function">WriteFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0666</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>再看[]byte做了什么</p><figure><img src="`+k+`" alt="image-20220524232214510" tabindex="0" loading="lazy"><figcaption>image-20220524232214510</figcaption></figure><p>最后看它函数的定义</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">WriteFile</span><span class="token punctuation">(</span>filename <span class="token builtin">string</span><span class="token punctuation">,</span> data <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> perm fs<span class="token punctuation">.</span>FileMode<span class="token punctuation">)</span> <span class="token builtin">error</span>

解释：WriteFile 将数据写入由文件名命名的文件。  如果文件不存在，WriteFile 使用权限 perm（在 umask 之前）创建它；  否则 WriteFile 在写入之前将其截断，而不更改权限。

<span class="token comment">// 官方例子</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	message <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, Gophers!&quot;</span><span class="token punctuation">)</span>
	err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">WriteFile</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">,</span> <span class="token number">0644</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>读</p><hr><p>先看看API函数：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">ReadFile</span><span class="token punctuation">(</span>filename <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
ReadFile 读取由 filename 命名的文件并返回内容。  成功的调用返回 err <span class="token operator">==</span> <span class="token boolean">nil</span>，而不是 err <span class="token operator">==</span> EOF。  因为 ReadFile 读取整个文件，所以它不会将 Read 中的 EOF 视为要报告的错误。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>返回值也有不同</p><figure><img src="`+v+`" alt="image-20220525124905645" tabindex="0" loading="lazy"><figcaption>image-20220525124905645</figcaption></figure><p>当然这时会在想[]byte如何转换成string？当然就是直接转换即可string（[]byte）</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code>bs<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token comment">// Option #1 - log the error and return a call to newDeck()</span>
    <span class="token comment">// Option #2 - log the error and entirely quit the program</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
s <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>bs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="go什么时候接收器-什么时候又把这个参数放到括号内" tabindex="-1"><a class="header-anchor" href="#go什么时候接收器-什么时候又把这个参数放到括号内" aria-hidden="true">#</a> Go什么时候接收器，什么时候又把这个参数放到括号内？</h3><h3 id="go的测试功能要怎么写呢" tabindex="-1"><a class="header-anchor" href="#go的测试功能要怎么写呢" aria-hidden="true">#</a> Go的测试功能要怎么写呢？</h3><p>在Java中直接引入包然后注解@Test即可</p><p>在Go中需要导入<code>testing</code></p><p>参数处还有写上：<code>t *testing.T</code></p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">TestNewDeck</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	d <span class="token operator">:=</span> <span class="token function">newDeck</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">16</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Expected deck length of 16, but got %v&quot;</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">&quot;Ace of Spades&quot;</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Expected first card of Ace of Spades, but got %v&quot;</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> d<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">&quot;Four of Clubs&quot;</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Expected last card of Four of Clubs, but got %v&quot;</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Go如何测试文件的写入和读取？</p><p>流程是这样的：</p><ol><li>删除任何一个当前项目中含有相同名字的文件，例如：&quot;_decktesting&quot;</li><li>创建一个想要测试的类</li><li>保存这个文件</li><li>加载这个文件</li><li>断言这个文件的长度</li><li>删除现在文件中的包含这个名字的文件，例如：&quot;_decktesting&quot;</li></ol><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">TestSaveToDeckAndNewDeckFromFile</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	os<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span><span class="token string">&quot;_decktesting&quot;</span><span class="token punctuation">)</span>

	d <span class="token operator">:=</span> <span class="token function">newDeck</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	d<span class="token punctuation">.</span><span class="token function">saveToFile</span><span class="token punctuation">(</span><span class="token string">&quot;_decktesting&quot;</span><span class="token punctuation">)</span>

	loadedDeck <span class="token operator">:=</span> <span class="token function">newDeckFromFile</span><span class="token punctuation">(</span><span class="token string">&quot;_decktesting&quot;</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>loadedDeck<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">16</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Expected 16 cards in deck, got %v&quot;</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>loadedDeck<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	os<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span><span class="token string">&quot;_decktesting&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="go中的结构体" tabindex="-1"><a class="header-anchor" href="#go中的结构体" aria-hidden="true">#</a> Go中的结构体</h3><p>老师在课程当中形容的很形象，这个struct就像python中的字典：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	lastName  <span class="token builtin">string</span>
	firstName <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	alex <span class="token operator">:=</span> person<span class="token punctuation">{</span>firstName<span class="token punctuation">:</span> <span class="token string">&quot;Alex&quot;</span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string">&quot;Anderson&quot;</span><span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以通过这个语句查看key-value：<code>fmt.Printf(&quot;%+v&quot;, alex)</code></p><p>注：<code>%+v 先输出字段类型，再输出该字段的值</code></p><h3 id="go结构体中调用接收体会在内存中复制的问题" tabindex="-1"><a class="header-anchor" href="#go结构体中调用接收体会在内存中复制的问题" aria-hidden="true">#</a> Go结构体中调用接收体会在内存中复制的问题</h3><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> contactInfo <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	email   <span class="token builtin">string</span>
	zipCode <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	lastName  <span class="token builtin">string</span>
	firstName <span class="token builtin">string</span>
	contactInfo
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	jim <span class="token operator">:=</span> person<span class="token punctuation">{</span>
		firstName<span class="token punctuation">:</span> <span class="token string">&quot;Jim&quot;</span><span class="token punctuation">,</span>
		lastName<span class="token punctuation">:</span>  <span class="token string">&quot;Party&quot;</span><span class="token punctuation">,</span>
		contactInfo<span class="token punctuation">:</span> contactInfo<span class="token punctuation">{</span>
			email<span class="token punctuation">:</span>   <span class="token string">&quot;jim@gmail.com&quot;</span><span class="token punctuation">,</span>
			zipCode<span class="token punctuation">:</span> <span class="token number">94000</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	jim<span class="token punctuation">.</span><span class="token function">updateName</span><span class="token punctuation">(</span><span class="token string">&quot;Jimmy&quot;</span><span class="token punctuation">)</span>

	jim<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>pointerToPerson <span class="token operator">*</span>person<span class="token punctuation">)</span> <span class="token function">updateName</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">(</span><span class="token operator">*</span>pointerToPerson<span class="token punctuation">)</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> name
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>person<span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%+v&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果直接调用接收体这种函数，在内存当中Go会把原先的复制，然后在新的内存中开辟再进行修改，像是下面这个图</p><figure><img src="`+m+`" alt="image-20220529135255808" tabindex="0" loading="lazy"><figcaption>image-20220529135255808</figcaption></figure><p>那么，我们如果不进行复制这步操作如何呢？首先要使用<code>&amp;</code>获取到这个结构体所在内存的位置，然后通过Go中的指针去改变当前的结构体内容</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>
    jim <span class="token operator">:=</span> person<span class="token punctuation">{</span>
        firstName<span class="token punctuation">:</span> <span class="token string">&quot;Jim&quot;</span><span class="token punctuation">,</span>
        lastName<span class="token punctuation">:</span>  <span class="token string">&quot;Party&quot;</span><span class="token punctuation">,</span>
        contactInfo<span class="token punctuation">:</span> contactInfo<span class="token punctuation">{</span>
            email<span class="token punctuation">:</span>   <span class="token string">&quot;jim@gmail.com&quot;</span><span class="token punctuation">,</span>
            zipCode<span class="token punctuation">:</span> <span class="token number">94000</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    jimPointer <span class="token operator">:=</span> <span class="token operator">&amp;</span>jim
    jimPointer<span class="token punctuation">.</span><span class="token function">updateName</span><span class="token punctuation">(</span><span class="token string">&quot;Jimmy&quot;</span><span class="token punctuation">)</span>

    jim<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>pointerToPerson <span class="token operator">*</span>person<span class="token punctuation">)</span> <span class="token function">updateName</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">(</span><span class="token operator">*</span>pointerToPerson<span class="token punctuation">)</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> name
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>而每当看到<code>*</code>的时候就是想看到这个指针的值</p><p>总结：每当使用接收者作为参数传给函数的时候数据就会被复制，所以默认情况下都是再副本下完成的</p><p>而在数组切片中又有所不同：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	mySlice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;Hi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;There&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;How&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Are&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;You&quot;</span><span class="token punctuation">}</span>

	<span class="token function">updateSlice</span><span class="token punctuation">(</span>mySlice<span class="token punctuation">)</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>mySlice<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">updateSlice</span><span class="token punctuation">(</span>s <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Bye&quot;</span>
<span class="token punctuation">}</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">[</span>Bye There How Are You<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+b+'" alt="image-20220529141540704" tabindex="0" loading="lazy"><figcaption>image-20220529141540704</figcaption></figure><p>每个数组都会分配这样的属性值（length, cap, ptr to head)，然后如果要进行切片操作的话就会进行一层复制，但是这个复制只是对其属性的复制，底层还是操作着同一个数组</p><figure><img src="'+g+'" alt="image-20220530203334648" tabindex="0" loading="lazy"><figcaption>image-20220530203334648</figcaption></figure><h3 id="map的形容介绍" tabindex="-1"><a class="header-anchor" href="#map的形容介绍" aria-hidden="true">#</a> Map的形容介绍</h3><figure><img src="'+f+`" alt="image-20220529141826436" tabindex="0" loading="lazy"><figcaption>image-20220529141826436</figcaption></figure><h3 id="go在创建map的时候有什么不同" tabindex="-1"><a class="header-anchor" href="#go在创建map的时候有什么不同" aria-hidden="true">#</a> Go在创建Map的时候有什么不同？</h3><p>在Go中一般有3种方法创建map</p><p>这两个是没有初始化值的</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">var</span> colors <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span>

colors <span class="token punctuation">;</span><span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果有值的话：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code>colors <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
		<span class="token string">&quot;red&quot;</span><span class="token punctuation">:</span>   <span class="token string">&quot;#ff0000&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;green&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;#4bf745&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;white&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;#ffffff&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>而在Java中一般创建hashmap都是这样：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
or
<span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token punctuation">{</span>
        <span class="token function">put</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;one&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">put</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
or
<span class="token class-name">Map</span><span class="token punctuation">.</span><span class="token function">ofEntries</span><span class="token punctuation">(</span>
        <span class="token function">entry</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;one&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">entry</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">entry</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;three&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
or
<span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">SimpleEntry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;one&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">SimpleEntry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">SimpleEntry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;three&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">SimpleEntry</span><span class="token operator">::</span><span class="token function">getKey</span><span class="token punctuation">,</span> <span class="token class-name">SimpleEntry</span><span class="token operator">::</span><span class="token function">getValue</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>而这个map的删除元素的函数也是有所不同，使用<code>delete</code>进行删除</p><h3 id="和-的区别" tabindex="-1"><a class="header-anchor" href="#和-的区别" aria-hidden="true">#</a> <code>=</code> 和 <code>:=</code> 的区别？</h3><p>=是赋值变量，:=是定义变量。</p><h3 id="指针的作用" tabindex="-1"><a class="header-anchor" href="#指针的作用" aria-hidden="true">#</a> 指针的作用</h3><p>一个指针可以指向任意变量的地址，它所指向的地址在32位或64位机器上分别<strong>固定</strong>占4或8个字节。指针的作用有：</p><ul><li>获取变量的值</li></ul><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token keyword">import</span> fmt
 
 <span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  a <span class="token operator">:=</span> <span class="token number">1</span>
  p <span class="token operator">:=</span> <span class="token operator">&amp;</span>a<span class="token comment">//取址&amp;</span>
  fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d\\n&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//取值*</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>改变变量的值</li></ul><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token comment">// 交换函数</span>
 <span class="token keyword">func</span> <span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token operator">*</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token operator">*</span>b <span class="token operator">=</span> <span class="token operator">*</span>b<span class="token punctuation">,</span> <span class="token operator">*</span>a
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>用指针替代值传入函数，比如类的接收器就是这样的。</li></ul><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token keyword">type</span> A <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
 
 <span class="token keyword">func</span> <span class="token punctuation">(</span>a <span class="token operator">*</span>A<span class="token punctuation">)</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="go-允许多个返回值吗" tabindex="-1"><a class="header-anchor" href="#go-允许多个返回值吗" aria-hidden="true">#</a> Go 允许多个返回值吗？</h3><p>可以。通常函数除了一般返回值还会返回一个error。</p><h3 id="go-有异常类型吗" tabindex="-1"><a class="header-anchor" href="#go-有异常类型吗" aria-hidden="true">#</a> Go 有异常类型吗？</h3><p>有。Go用error类型代替try...catch语句，这样可以节省资源。同时增加代码可读性：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token boolean">_</span><span class="token punctuation">,</span>err <span class="token operator">:=</span> <span class="token function">errorDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> err<span class="token operator">!=</span><span class="token boolean">nil</span><span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
   <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>也可以用errors.New()来定义自己的异常。errors.Error()会返回异常的字符串表示。只要实现error接口就可以定义自己的异常，</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token keyword">type</span> errorString <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  s <span class="token builtin">string</span>
 <span class="token punctuation">}</span>
 
 <span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>errorString<span class="token punctuation">)</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> e<span class="token punctuation">.</span>s
 <span class="token punctuation">}</span>
 
 <span class="token comment">// 多一个函数当作构造函数</span>
 <span class="token keyword">func</span> <span class="token function">New</span><span class="token punctuation">(</span>text <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&amp;</span>errorString<span class="token punctuation">{</span>text<span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="什么是协程-goroutine" tabindex="-1"><a class="header-anchor" href="#什么是协程-goroutine" aria-hidden="true">#</a> 什么是协程（Goroutine）</h3><p>协程是<strong>用户态轻量级线程</strong>，它是<strong>线程调度的基本单位</strong>。通常在函数前加上go关键字就能实现并发。一个Goroutine会以一个很小的栈启动2KB或4KB，当遇到栈空间不足时，栈会<strong>自动伸缩</strong>， 因此可以轻易实现成千上万个goroutine同时启动。</p><h3 id="如何高效地拼接字符串" tabindex="-1"><a class="header-anchor" href="#如何高效地拼接字符串" aria-hidden="true">#</a> 如何高效地拼接字符串</h3><p>拼接字符串的方式有：&quot;+&quot;, fmt.Sprintf, strings.Builder, bytes.Buffer, strings.Join</p><ol><li>&quot;+&quot;</li></ol><p>使用<code>+</code>操作符进行拼接时，会对字符串进行遍历，计算并开辟一个新的空间来存储原来的两个字符串。</p><ol start="2"><li>fmt.Sprintf</li></ol><p>由于采用了接口参数，必须要用反射获取值，因此有性能损耗。</p><ol start="3"><li>strings.Builder：</li></ol><p>用WriteString()进行拼接，内部实现是指针+切片，同时String()返回拼接后的字符串，它是直接把[]byte转换为string，从而避免变量拷贝。</p><p><code>strings.builder</code>的实现原理很简单，结构如下：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token keyword">type</span> Builder <span class="token keyword">struct</span> <span class="token punctuation">{</span>
     addr <span class="token operator">*</span>Builder <span class="token comment">// of receiver, to detect copies by value</span>
     buf  <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span> <span class="token comment">// 1</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>addr</code>字段主要是做<code>copycheck</code>，<code>buf</code>字段是一个<code>byte</code>类型的切片，这个就是用来存放字符串内容的，提供的<code>writeString()</code>方法就是像切片<code>buf</code>中追加数据：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>Builder<span class="token punctuation">)</span> <span class="token function">WriteString</span><span class="token punctuation">(</span>s <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     b<span class="token punctuation">.</span><span class="token function">copyCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     b<span class="token punctuation">.</span>buf <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>buf<span class="token punctuation">,</span> s<span class="token operator">...</span><span class="token punctuation">)</span>
     <span class="token keyword">return</span> <span class="token function">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>提供的<code>String</code>方法就是将<code>[]byte</code>转换为<code>string</code>类型，这里为了避免内存拷贝的问题，使用了强制转换来避免内存拷贝：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>Builder<span class="token punctuation">)</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">(</span>unsafe<span class="token punctuation">.</span><span class="token function">Pointer</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">.</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>bytes.Buffer</li></ol><p><code>bytes.Buffer</code>是一个一个缓冲<code>byte</code>类型的缓冲器，这个缓冲器里存放着都是<code>byte</code>。使用方式如下：</p><p><code>bytes.buffer</code>底层也是一个<code>[]byte</code>切片，结构体如下：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>type Buffer struct {
    buf      []byte // contents are the bytes buf[off : len(buf)]
    off      int    // read at &amp;buf[off], write at &amp;buf[len(buf)]
    lastRead readOp // last read operation, so that Unread* can work correctly.
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>因为<code>bytes.Buffer</code>可以持续向<code>Buffer</code>尾部写入数据，从<code>Buffer</code>头部读取数据，所以<code>off</code>字段用来记录读取位置，再利用切片的<code>cap</code>特性来知道写入位置，这个不是本次的重点，重点看一下<code>WriteString</code>方法是如何拼接字符串的：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>Buffer<span class="token punctuation">)</span> <span class="token function">WriteString</span><span class="token punctuation">(</span>s <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    b<span class="token punctuation">.</span>lastRead <span class="token operator">=</span> opInvalid
    m<span class="token punctuation">,</span> ok <span class="token operator">:=</span> b<span class="token punctuation">.</span><span class="token function">tryGrowByReslice</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">{</span>
        m <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">grow</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">copy</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>buf<span class="token punctuation">[</span>m<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>切片在创建时并不会申请内存块，只有在往里写数据时才会申请，首次申请的大小即为写入数据的大小。如果写入的数据小于64字节，则按64字节申请。采用动态扩展<code>slice</code>的机制，字符串追加采用<code>copy</code>的方式将追加的部分拷贝到尾部，<code>copy</code>是内置的拷贝函数，可以减少内存分配。</p><p>但是在将<code>[]byte</code>转换为<code>string</code>类型依旧使用了标准类型，所以会发生内存分配：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>Buffer<span class="token punctuation">)</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token comment">// Special case, useful in debugging.</span>
        <span class="token keyword">return</span> <span class="token string">&quot;&lt;nil&gt;&quot;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">string</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>buf<span class="token punctuation">[</span>b<span class="token punctuation">.</span>off<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>strings.join</li></ol><p><code>strings.join</code>也是基于<code>strings.builder</code>来实现的,并且可以自定义分隔符，代码如下：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">Join</span><span class="token punctuation">(</span>elems <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> sep <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token function">len</span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> elems<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    n <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>sep<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">len</span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
        n <span class="token operator">+=</span> <span class="token function">len</span><span class="token punctuation">(</span>elems<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">var</span> b Builder
    b<span class="token punctuation">.</span><span class="token function">Grow</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    b<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>elems<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> s <span class="token operator">:=</span> <span class="token keyword">range</span> elems<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
        b<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>sep<span class="token punctuation">)</span>
        b<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> b<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>唯一不同在于在<code>join</code>方法内调用了<code>b.Grow(n)</code>方法，这个是进行初步的容量分配，而前面计算的n的长度就是我们要拼接的slice的长度，因为我们传入切片长度固定，所以提前进行容量分配可以减少内存分配，很高效。</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">}</span>
	<span class="token comment">//方式1：</span>
	ret <span class="token operator">:=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
	<span class="token comment">//方式2：</span>
	ret <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token comment">//方式3：</span>
	<span class="token keyword">var</span> sb strings<span class="token punctuation">.</span>Builder
	sb<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	sb<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	sb<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	ret <span class="token operator">:=</span> sb<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//方式4：</span>
	buf <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span>Buffer<span class="token punctuation">)</span>
	buf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	buf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	buf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	ret <span class="token operator">:=</span> buf<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//方式5：</span>
	ret <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>总结：</p><p>strings.Join ≈ strings.Builder &gt; bytes.Buffer &gt; &quot;+&quot; &gt; fmt.Sprintf</p>`,138),z={href:"https://geektutu.com/post/hpg-string-concat.html",target:"_blank",rel:"noopener noreferrer"},j=p(`<h3 id="什么是-rune-类型" tabindex="-1"><a class="header-anchor" href="#什么是-rune-类型" aria-hidden="true">#</a> 什么是 rune 类型</h3><p>rune是int32的别名，用来区分字符值和整数值。比如utf-8汉字占3个字节，按照一般方法遍历汉字字符串得到的是乱码，这个时候要将字符串转换为rune:</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code>	sample <span class="token operator">:=</span> <span class="token string">&quot;我爱GO&quot;</span>
	runeSamp <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">rune</span><span class="token punctuation">(</span>sample<span class="token punctuation">)</span>
	runeSamp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">&#39;你&#39;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>runeSamp<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="如何判断-map-中是否包含某个-key" tabindex="-1"><a class="header-anchor" href="#如何判断-map-中是否包含某个-key" aria-hidden="true">#</a> 如何判断 map 中是否包含某个 key ？</h3><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">var</span> sample <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">int</span>
<span class="token keyword">if</span> <span class="token boolean">_</span><span class="token punctuation">,</span> ok <span class="token operator">:=</span> sample<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>ok<span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="go-支持默认参数或可选参数吗" tabindex="-1"><a class="header-anchor" href="#go-支持默认参数或可选参数吗" aria-hidden="true">#</a> Go 支持默认参数或可选参数吗？</h3><p>不支持。但是可以利用结构体参数，或者...传入参数切片。</p><h3 id="defer-的执行顺序" tabindex="-1"><a class="header-anchor" href="#defer-的执行顺序" aria-hidden="true">#</a> defer 的执行顺序</h3><p>defer执行顺序和调用顺序相反，类似于栈先进后出。</p><h3 id="如何交换-2-个变量的值" tabindex="-1"><a class="header-anchor" href="#如何交换-2-个变量的值" aria-hidden="true">#</a> 如何交换 2 个变量的值？</h3><p>对于变量而言<code>a,b = b,a</code>； 对于指针而言<code>*a,*b = *b, *a</code></p><h3 id="go-语言-tag-的用处" tabindex="-1"><a class="header-anchor" href="#go-语言-tag-的用处" aria-hidden="true">#</a> Go 语言 tag 的用处？</h3><p>tag可以为结构体成员提供属性。常见的：</p><ol><li>json序列化或反序列化时字段的名称</li><li>db: sqlx模块中对应的数据库字段名</li><li>form: gin框架中对应的前端的数据字段名</li><li>binding: 搭配 form 使用, 默认如果没查找到结构体中的某个字段则不报错值为空, binding为 required 代表没找到返回错误给前端</li></ol><h3 id="如何判断-2-个字符串切片-slice-是相等的" tabindex="-1"><a class="header-anchor" href="#如何判断-2-个字符串切片-slice-是相等的" aria-hidden="true">#</a> 如何判断 2 个字符串切片（slice) 是相等的？</h3><p>利用反射：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> Author <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Name         <span class="token builtin">int</span>      <span class="token string">\`json:Name\`</span>
	Publications <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token string">\`json:Publication,omitempty\`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	t <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">TypeOf</span><span class="token punctuation">(</span>Author<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> t<span class="token punctuation">.</span><span class="token function">NumField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		name <span class="token operator">:=</span> t<span class="token punctuation">.</span><span class="token function">Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Name
		s<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> t<span class="token punctuation">.</span><span class="token function">FieldByName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>Tag<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="字符串打印时-v-和-v-的区别" tabindex="-1"><a class="header-anchor" href="#字符串打印时-v-和-v-的区别" aria-hidden="true">#</a> 字符串打印时，<code>%v</code> 和 <code>%+v</code> 的区别</h3><p><code>%v</code>输出结构体各成员的值；</p><p><code>%+v</code>输出结构体各成员的名称和值；</p><p><code>%#v</code>输出结构体名称和结构体各成员的名称和值</p><h3 id="go-语言中如何表示枚举值-enums" tabindex="-1"><a class="header-anchor" href="#go-语言中如何表示枚举值-enums" aria-hidden="true">#</a> Go 语言中如何表示枚举值(enums)？</h3><p>在常量中用iota可以表示枚举。iota从0开始。</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">const</span> <span class="token punctuation">(</span>
	B <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">*</span> <span class="token boolean">iota</span><span class="token punctuation">)</span>
	KiB 
	MiB
	GiB
	TiB
	PiB
	EiB
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="空-struct-的用途" tabindex="-1"><a class="header-anchor" href="#空-struct-的用途" aria-hidden="true">#</a> 空 struct{} 的用途</h3><ol><li>用map模拟一个set，那么就要把值置为struct{}，struct{}本身不占任何空间，可以避免任何多余的内存分配。</li><li>有时候给通道发送一个空结构体,channel&lt;-struct{}{}，也是节省了空间。</li><li>仅有方法的结构体</li></ol><h3 id="go里面的int和int32是同一个概念吗" tabindex="-1"><a class="header-anchor" href="#go里面的int和int32是同一个概念吗" aria-hidden="true">#</a> go里面的int和int32是同一个概念吗？</h3><p>不是一个概念！千万不能混淆。go语言中的int的大小是和操作系统位数相关的，如果是32位操作系统，int类型的大小就是4字节。如果是64位操作系统，int类型的大小就是8个字节。除此之外uint也与操作系统有关。</p><p>int8占1个字节，int16占2个字节，int32占4个字节，int64占8个字节。</p><h2 id="java过渡go的第一个项目-todolist" tabindex="-1"><a class="header-anchor" href="#java过渡go的第一个项目-todolist" aria-hidden="true">#</a> Java过渡Go的第一个项目：TodoList</h2><p>这个章节主要是学习Gin的项目架构搭建，如果以后要搭建web项目直接起一个脚手架项目很快就能搭建起来，如果项目架构都不熟悉，那么怎么使用脚手架呢？</p><h3 id="前言-1" tabindex="-1"><a class="header-anchor" href="#前言-1" aria-hidden="true">#</a> 前言</h3><p>感谢以下仓库对我学习的帮助：</p>`,33),Q={href:"https://github.com/swaggo/swag",target:"_blank",rel:"noopener noreferrer"},G={href:"https://github.com/CocaineCong/TodoList",target:"_blank",rel:"noopener noreferrer"},U={href:"https://github.com/gourouting/singo",target:"_blank",rel:"noopener noreferrer"},F=p('<blockquote><p>注：备忘录的架构是在Singo的基础上搭建的。</p></blockquote><h3 id="搭建外设" tabindex="-1"><a class="header-anchor" href="#搭建外设" aria-hidden="true">#</a> 搭建外设</h3><p>首先搭建脚手架，按照Singo的结构先学习Golang在Gin上的基本架构：</p><figure><img src="'+h+`" alt="image-20220609131536632" tabindex="0" loading="lazy"><figcaption>image-20220609131536632</figcaption></figure><p>把文件搭建起来后可以开始先给<code>main.go</code>，可以看到TodoList仓库中主要分三步走：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// http://localhost:3000/swagger/index.html</span>
	<span class="token comment">//从配置文件读入配置</span>
	conf<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//转载路由 swag init -g common.go</span>
	r <span class="token operator">:=</span> routes<span class="token punctuation">.</span><span class="token function">NewRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>conf<span class="token punctuation">.</span>HttpPort<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>那么首先把init先写上，说明我们第一步要做的就是初始化配置（本次教程放弃了读取ini，改用yaml文件）：</p><ol><li>创建YAML配置文件（放弃redis，根本用不到）</li></ol><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">service</span><span class="token punctuation">:</span>
  <span class="token key atrule">mode</span><span class="token punctuation">:</span> debug
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token punctuation">:</span><span class="token number">8080</span>

<span class="token comment">#redis:</span>
<span class="token comment">#  addr: 127.0.0.1:6379</span>

<span class="token key atrule">mysql</span><span class="token punctuation">:</span>
  <span class="token key atrule">host</span><span class="token punctuation">:</span> 用户名<span class="token punctuation">:</span>密码@tcp(地址<span class="token punctuation">:</span>端口号)/数据库<span class="token punctuation">?</span>charset=utf8<span class="token important">&amp;parseTime=True&amp;loc=Local</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>然后再conf文件下创建一个<code>init.go</code>，读取yaml，然后分别丢给数据库（mysql），Gin（service）</li></ol><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;TodoList/model&quot;</span>
	<span class="token string">&quot;TodoList/util&quot;</span>
	<span class="token string">&quot;gopkg.in/yaml.v3&quot;</span>
	<span class="token string">&quot;io/ioutil&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Config <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Service <span class="token operator">*</span>Service <span class="token string">\`yaml:&quot;service&quot;\`</span>
	DB      <span class="token operator">*</span>DB      <span class="token string">\`yaml:&quot;mysql&quot;\`</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Service <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	AppMode  <span class="token builtin">string</span> <span class="token string">\`yaml:&quot;mode&quot;\`</span>
	HttpPort <span class="token builtin">string</span> <span class="token string">\`yaml:&quot;port&quot;\`</span>
	<span class="token comment">//RedisAddr string \`yaml:&quot;redis.addr&quot;\`</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> DB <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	DbHost <span class="token builtin">string</span> <span class="token string">\`yaml:&quot;host&quot;\`</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> Port <span class="token builtin">string</span>

<span class="token comment">// Init 初始化配置项</span>
<span class="token keyword">func</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token keyword">var</span> ginProperties Config

	file<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">&quot;./conf.yaml&quot;</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;配置文件读取错误，请检查文件路径:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> <span class="token function">LoadLocales</span><span class="token punctuation">(</span><span class="token string">&quot;conf/locales/zh-cn.yaml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;i18n配置文件读取错误，请检查文件路径:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span> <span class="token comment">//日志内容</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> err <span class="token operator">=</span> yaml<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ginProperties<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;YAML文件解析失败&quot;</span><span class="token punctuation">)</span> <span class="token comment">//日志内容</span>
	<span class="token punctuation">}</span>

	model<span class="token punctuation">.</span><span class="token function">Database</span><span class="token punctuation">(</span>ginProperties<span class="token punctuation">.</span>DB<span class="token punctuation">.</span>DbHost<span class="token punctuation">)</span>
	Port <span class="token operator">=</span> ginProperties<span class="token punctuation">.</span>Service<span class="token punctuation">.</span>HttpPort
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>然后把Singo的日志文件给复制过来，放到util文件夹下（忽略jwt，这是后面才会用到）：</li></ol><figure><img src="`+q+'" alt="image-20220609132254221" tabindex="0" loading="lazy"><figcaption>image-20220609132254221</figcaption></figure><ol start="4"><li>还可以复制的有conf下的i18n文件，locales和i18n.go都可以复制到conf文件下：</li></ol><figure><img src="'+y+`" alt="image-20220609133024879" tabindex="0" loading="lazy"><figcaption>image-20220609133024879</figcaption></figure><h3 id="建立数据库" tabindex="-1"><a class="header-anchor" href="#建立数据库" aria-hidden="true">#</a> 建立数据库</h3><ol><li>在搭建外设的章节可以顺着思路下来，已经把配置文件的sql连接地址转交给了gorm（model/init.go），这里singo也把连接数据库封装好了，直接拿过来用：</li></ol><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">// DB 数据库链接单例</span>
<span class="token keyword">var</span> DB <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB

<span class="token comment">// Database 在中间件中初始化mysql链接</span>
<span class="token keyword">func</span> <span class="token function">Database</span><span class="token punctuation">(</span>connString <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token comment">// 初始化GORM日志配置</span>
	newLogger <span class="token operator">:=</span> logger<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>
		log<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stdout<span class="token punctuation">,</span> <span class="token string">&quot;\\r\\n&quot;</span><span class="token punctuation">,</span> log<span class="token punctuation">.</span>LstdFlags<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// io writer</span>
		logger<span class="token punctuation">.</span>Config<span class="token punctuation">{</span>
			SlowThreshold<span class="token punctuation">:</span>             time<span class="token punctuation">.</span>Second<span class="token punctuation">,</span> <span class="token comment">// Slow SQL threshold</span>
			LogLevel<span class="token punctuation">:</span>                  logger<span class="token punctuation">.</span>Info<span class="token punctuation">,</span> <span class="token comment">// Log level(这里记得根据需求改一下)</span>
			IgnoreRecordNotFoundError<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token comment">// Ignore ErrRecordNotFound error for logger</span>
			Colorful<span class="token punctuation">:</span>                  <span class="token boolean">false</span><span class="token punctuation">,</span>       <span class="token comment">// Disable color</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">)</span>

	db<span class="token punctuation">,</span> err <span class="token operator">:=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>mysql<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>connString<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>gorm<span class="token punctuation">.</span>Config<span class="token punctuation">{</span>
		Logger<span class="token punctuation">:</span> newLogger<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">// Error</span>
	<span class="token keyword">if</span> connString <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token operator">||</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;mysql lost: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	sqlDB<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">DB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;mysql lost: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//设置连接池</span>
	<span class="token comment">//空闲</span>
	sqlDB<span class="token punctuation">.</span><span class="token function">SetMaxIdleConns</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
	<span class="token comment">//打开</span>
	sqlDB<span class="token punctuation">.</span><span class="token function">SetMaxOpenConns</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
	DB <span class="token operator">=</span> db

	<span class="token function">migration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,18),J={start:"2"},H={href:"https://gorm.io/zh_CN/docs/migration.html",target:"_blank",rel:"noopener noreferrer"},O=p(`<blockquote><p>这边目前只起搭建项目目的，所以只建了一个user，后续的顺序是：创建一个user.go -》 migration.go 运行</p></blockquote><p>user.go</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gorm<span class="token punctuation">.</span>Model
	UserName       <span class="token builtin">string</span> <span class="token string">\`gorm:&quot;unique&quot;\`</span>
	PasswordDigest <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token punctuation">(</span>
	<span class="token comment">// PassWordCost 密码加密难度</span>
	PassWordCost <span class="token operator">=</span> <span class="token number">12</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>user <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">SetPassword</span><span class="token punctuation">(</span>password <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
	bytes<span class="token punctuation">,</span> err <span class="token operator">:=</span> bcrypt<span class="token punctuation">.</span><span class="token function">GenerateFromPassword</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">,</span> PassWordCost<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> err
	<span class="token punctuation">}</span>
	user<span class="token punctuation">.</span>PasswordDigest <span class="token operator">=</span> <span class="token function">string</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>user <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">CheckPassword</span><span class="token punctuation">(</span>password <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
	err <span class="token operator">:=</span> bcrypt<span class="token punctuation">.</span><span class="token function">CompareHashAndPassword</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>PasswordDigest<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> err <span class="token operator">==</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>migration.go</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">//执行数据迁移</span>
<span class="token keyword">func</span> <span class="token function">migration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 自动迁移模式</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> DB<span class="token punctuation">.</span><span class="token function">AutoMigrate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此时运行main函数就可以看到底层数据库已经创建了user的数据表</p><figure><img src="`+w+`" alt="image-20220609133451231" tabindex="0" loading="lazy"><figcaption>image-20220609133451231</figcaption></figure><p>此时的<code>user.go</code>也就是Java中的<code>DO</code>对象</p><h3 id="搭建vo对象" tabindex="-1"><a class="header-anchor" href="#搭建vo对象" aria-hidden="true">#</a> 搭建VO对象</h3><p>这时我们只要创建两个文件即可：</p><ul><li>common.go 专门返回给前端的response二次封装</li><li>user.go 这里是返回给前端哪些需要的用户数据</li></ul><p>common.go，直接复制脚手架的文件，然后再加点自己的状态码，返回类型就有以下内容：</p><p>下面的内容主要都是包含状态码和返回内容（Java中对json的二次封装，比如返回要返回状态码200还是500，返回什么内容）</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">// Response 基础序列化器</span>
<span class="token keyword">type</span> Response <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Code  <span class="token builtin">int</span>         <span class="token string">\`json:&quot;code&quot;\`</span>
	Data  <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token string">\`json:&quot;data,omitempty&quot;\`</span>
	Msg   <span class="token builtin">string</span>      <span class="token string">\`json:&quot;msg&quot;\`</span>
	Error <span class="token builtin">string</span>      <span class="token string">\`json:&quot;error,omitempty&quot;\`</span>
<span class="token punctuation">}</span>

<span class="token comment">// TrackedErrorResponse 有追踪信息的错误响应</span>
<span class="token keyword">type</span> TrackedErrorResponse <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Response
	TrackID <span class="token builtin">string</span> <span class="token string">\`json:&quot;track_id&quot;\`</span>
<span class="token punctuation">}</span>

<span class="token comment">//TokenData 带有token的Data结构</span>
<span class="token keyword">type</span> TokenData <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	User  <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token string">\`json:&quot;user&quot;\`</span>
	Token <span class="token builtin">string</span>      <span class="token string">\`json:&quot;token&quot;\`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> ResponseUser <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Status <span class="token builtin">int</span>    <span class="token string">\`json:&quot;status&quot; example:&quot;200&quot;\`</span>
	Data   User   <span class="token string">\`json:&quot;data&quot;\`</span>
	Msg    <span class="token builtin">string</span> <span class="token string">\`json:&quot;msg&quot; example:&quot;ok&quot;\`</span>
	Error  <span class="token builtin">string</span> <span class="token string">\`json:&quot;error&quot; example:&quot;&quot;\`</span>
<span class="token punctuation">}</span>

<span class="token comment">// 三位数错误编码为复用http原本含义</span>
<span class="token comment">// 五位数错误编码为应用自定义错误</span>
<span class="token comment">// 五开头的五位数错误编码为服务器端错误，比如数据库操作失败</span>
<span class="token comment">// 四开头的五位数错误编码为客户端错误，有时候是客户端代码写错了，有时候是用户操作错误</span>
<span class="token keyword">const</span> <span class="token punctuation">(</span>
	<span class="token comment">// CodeCheckLogin 未登录</span>
	CodeCheckLogin <span class="token operator">=</span> <span class="token number">401</span>
	<span class="token comment">// CodeNoRightErr 未授权访问</span>
	CodeNoRightErr <span class="token operator">=</span> <span class="token number">403</span>
	<span class="token comment">// CodeDBError 数据库操作失败</span>
	CodeDBError <span class="token operator">=</span> <span class="token number">50001</span>
	<span class="token comment">// CodeEncryptError 加密失败</span>
	CodeEncryptError <span class="token operator">=</span> <span class="token number">50002</span>
	<span class="token comment">//CodeParamErr 各种奇奇怪怪的参数错误</span>
	CodeParamErr               <span class="token operator">=</span> <span class="token number">40001</span>
	ErrorExistUser             <span class="token operator">=</span> <span class="token number">10002</span> <span class="token comment">//成员错误</span>
	ErrorNotExistUser          <span class="token operator">=</span> <span class="token number">10003</span>
	ErrorFailEncryption        <span class="token operator">=</span> <span class="token number">10006</span>
	ErrorNotCompare            <span class="token operator">=</span> <span class="token number">10007</span>
	ErrorAuthCheckTokenFail    <span class="token operator">=</span> <span class="token number">30001</span> <span class="token comment">//token 错误</span>
	ErrorAuthCheckTokenTimeout <span class="token operator">=</span> <span class="token number">30002</span> <span class="token comment">//token 过期</span>
	ErrorAuthToken             <span class="token operator">=</span> <span class="token number">30003</span>
	ErrorAuth                  <span class="token operator">=</span> <span class="token number">30004</span>
	ErrorDatabase              <span class="token operator">=</span> <span class="token number">40001</span>
<span class="token punctuation">)</span>

<span class="token comment">// CheckLogin 检查登录</span>
<span class="token keyword">func</span> <span class="token function">CheckLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Response <span class="token punctuation">{</span>
	<span class="token keyword">return</span> Response<span class="token punctuation">{</span>
		Code<span class="token punctuation">:</span> CodeCheckLogin<span class="token punctuation">,</span>
		Msg<span class="token punctuation">:</span>  <span class="token string">&quot;未登录&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Err 通用错误处理</span>
<span class="token keyword">func</span> <span class="token function">Err</span><span class="token punctuation">(</span>errCode <span class="token builtin">int</span><span class="token punctuation">,</span> msg <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> Response <span class="token punctuation">{</span>
	res <span class="token operator">:=</span> Response<span class="token punctuation">{</span>
		Code<span class="token punctuation">:</span> errCode<span class="token punctuation">,</span>
		Msg<span class="token punctuation">:</span>  msg<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 生产环境隐藏底层报错</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> gin<span class="token punctuation">.</span><span class="token function">Mode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> gin<span class="token punctuation">.</span>ReleaseMode <span class="token punctuation">{</span>
		res<span class="token punctuation">.</span>Error <span class="token operator">=</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> res
<span class="token punctuation">}</span>

<span class="token comment">// DBErr 数据库操作失败</span>
<span class="token keyword">func</span> <span class="token function">DBErr</span><span class="token punctuation">(</span>msg <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> Response <span class="token punctuation">{</span>
	<span class="token keyword">if</span> msg <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
		msg <span class="token operator">=</span> <span class="token string">&quot;数据库操作失败&quot;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token function">Err</span><span class="token punctuation">(</span>CodeDBError<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// ParamErr 各种参数错误</span>
<span class="token keyword">func</span> <span class="token function">ParamErr</span><span class="token punctuation">(</span>msg <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> Response <span class="token punctuation">{</span>
	<span class="token keyword">if</span> msg <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
		msg <span class="token operator">=</span> <span class="token string">&quot;参数错误&quot;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token function">Err</span><span class="token punctuation">(</span>CodeParamErr<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>user.go</p><p>主要是封装返回给前端的字段，一开始看也很懵，为什么这个字段感觉和model里的User一样还要写一遍？而且下面的BuildUser是个什么鬼？</p><ul><li>这里解答：BuildUser是在等下的service层会用到，是用来给jwt的</li></ul><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	ID       <span class="token builtin">uint</span>   <span class="token string">\`json:&quot;id&quot; form:&quot;id&quot; example:&quot;1&quot;\`</span>                    <span class="token comment">// 用户ID</span>
	UserName <span class="token builtin">string</span> <span class="token string">\`json:&quot;user_name&quot; form:&quot;user_name&quot; example:&quot;FanOne&quot;\`</span> <span class="token comment">// 用户名</span>
	CreateAt <span class="token builtin">int64</span>  <span class="token string">\`json:&quot;create_at&quot; form:&quot;create_at&quot;\`</span>                  <span class="token comment">// 创建</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">BuildUser</span><span class="token punctuation">(</span>user model<span class="token punctuation">.</span>User<span class="token punctuation">)</span> User <span class="token punctuation">{</span>
	<span class="token keyword">return</span> User<span class="token punctuation">{</span>
		ID<span class="token punctuation">:</span>       user<span class="token punctuation">.</span>ID<span class="token punctuation">,</span>
		UserName<span class="token punctuation">:</span> user<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span>
		CreateAt<span class="token punctuation">:</span> user<span class="token punctuation">.</span>CreatedAt<span class="token punctuation">.</span><span class="token function">Unix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="搭建service层" tabindex="-1"><a class="header-anchor" href="#搭建service层" aria-hidden="true">#</a> 搭建Service层</h3><p>有了上述的基础，就可以搭建service层了，在TodoList项目中的日志框架用了第三方的框架，本次教程则采用原生在util文件下封装的框架作为日志框架。</p><p>下面的这段代码实在理解不了可以直接照着抄一下：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> UserService <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	UserName <span class="token builtin">string</span> <span class="token string">\`form:&quot;user_name&quot; json:&quot;user_name&quot; binding:&quot;required,min=3,max=15&quot; example:&quot;FanOne&quot;\`</span>
	Password <span class="token builtin">string</span> <span class="token string">\`form:&quot;password&quot; json:&quot;password&quot; binding:&quot;required,min=5,max=16&quot; example:&quot;FanOne666&quot;\`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>service <span class="token operator">*</span>UserService<span class="token punctuation">)</span> <span class="token function">Register</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>serializer<span class="token punctuation">.</span>Response <span class="token punctuation">{</span>
	<span class="token keyword">var</span> user model<span class="token punctuation">.</span>User
	<span class="token keyword">var</span> count <span class="token builtin">int64</span>
	model<span class="token punctuation">.</span>DB<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>model<span class="token punctuation">.</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;user_name=?&quot;</span><span class="token punctuation">,</span> service<span class="token punctuation">.</span>UserName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>count<span class="token punctuation">)</span>
	<span class="token keyword">if</span> count <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
		code <span class="token operator">:=</span> serializer<span class="token punctuation">.</span>ErrorExistUser
		<span class="token keyword">return</span> <span class="token operator">&amp;</span>serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>  <span class="token string">&quot;成员错误&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	user<span class="token punctuation">.</span>UserName <span class="token operator">=</span> service<span class="token punctuation">.</span>UserName
	<span class="token comment">//加密密码</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> user<span class="token punctuation">.</span><span class="token function">SetPassword</span><span class="token punctuation">(</span>service<span class="token punctuation">.</span>Password<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		code <span class="token operator">:=</span> serializer<span class="token punctuation">.</span>ErrorFailEncryption
		<span class="token keyword">return</span> <span class="token operator">&amp;</span>serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>  <span class="token string">&quot;加密失败&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//创建用户</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> model<span class="token punctuation">.</span>DB<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span>Error<span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		code <span class="token operator">:=</span> serializer<span class="token punctuation">.</span>ErrorDatabase
		<span class="token keyword">return</span> <span class="token operator">&amp;</span>serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>  <span class="token string">&quot;创建用户失败&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
		Code<span class="token punctuation">:</span> http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span>
		Msg<span class="token punctuation">:</span>  <span class="token string">&quot;成功创建&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>service <span class="token operator">*</span>UserService<span class="token punctuation">)</span> <span class="token function">Login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> serializer<span class="token punctuation">.</span>Response <span class="token punctuation">{</span>
	<span class="token keyword">var</span> user model<span class="token punctuation">.</span>User
	code <span class="token operator">:=</span> http<span class="token punctuation">.</span>StatusOK

	<span class="token keyword">if</span> err <span class="token operator">:=</span> model<span class="token punctuation">.</span>DB<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;user_name=?&quot;</span><span class="token punctuation">,</span> service<span class="token punctuation">.</span>UserName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span>Error<span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token comment">// 查询不到，返回错误</span>
		<span class="token keyword">if</span> errors<span class="token punctuation">.</span><span class="token function">Is</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> gorm<span class="token punctuation">.</span>ErrRecordNotFound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			code <span class="token operator">=</span> serializer<span class="token punctuation">.</span>ErrorExistUser
			<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
				Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
				Msg<span class="token punctuation">:</span>  <span class="token string">&quot;用户不存在！&quot;</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> serializer<span class="token punctuation">.</span><span class="token function">DBErr</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> user<span class="token punctuation">.</span><span class="token function">CheckPassword</span><span class="token punctuation">(</span>service<span class="token punctuation">.</span>Password<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token punctuation">{</span>
		code <span class="token operator">:=</span> serializer<span class="token punctuation">.</span>ErrorNotCompare
		<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>  <span class="token string">&quot;密码错误&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	token<span class="token punctuation">,</span> err <span class="token operator">:=</span> util<span class="token punctuation">.</span><span class="token function">GenerateToken</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> service<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		code <span class="token operator">=</span> serializer<span class="token punctuation">.</span>ErrorAuthToken
		<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>  <span class="token string">&quot;Token授权失败&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
		Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
		Data<span class="token punctuation">:</span> serializer<span class="token punctuation">.</span>TokenData<span class="token punctuation">{</span>User<span class="token punctuation">:</span> serializer<span class="token punctuation">.</span><span class="token function">BuildUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">,</span> Token<span class="token punctuation">:</span> token<span class="token punctuation">}</span><span class="token punctuation">,</span>
		Msg<span class="token punctuation">:</span>  <span class="token string">&quot;登录成功！&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>唯一要注意的就是，在登录用户的模块中，需要使用到JWT框架，如下所示：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code>token<span class="token punctuation">,</span> err <span class="token operator">:=</span> util<span class="token punctuation">.</span><span class="token function">GenerateToken</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> service<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		code <span class="token operator">=</span> serializer<span class="token punctuation">.</span>ErrorAuthToken
		<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>  <span class="token string">&quot;Token授权失败&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,24),W={href:"https://github.com/golang-jwt/jwt%EF%BC%8C%E7%94%A8%E6%B3%95%E4%B9%9F%E7%A8%8D%E6%9C%89%E4%B8%8D%E5%90%8C%E3%80%82",target:"_blank",rel:"noopener noreferrer"},V=p(`<blockquote><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>go get -u github.com/golang-jwt/jwt/v4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></blockquote><p>下面这段代码是对TodoList util 中的<code>jwt.go</code>进行一些修改：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">var</span> jwtSecret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">Getenv</span><span class="token punctuation">(</span><span class="token string">&quot;JWT_SECRET&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">type</span> Claims <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Id        <span class="token builtin">uint</span>   <span class="token string">\`json:&quot;id&quot;\`</span>
	Username  <span class="token builtin">string</span> <span class="token string">\`json:&quot;username&quot;\`</span>
	Authority <span class="token builtin">int</span>    <span class="token string">\`json:&quot;authority&quot;\`</span>
	jwt<span class="token punctuation">.</span>RegisteredClaims
<span class="token punctuation">}</span>

<span class="token comment">//GenerateToken 签发用户Token</span>
<span class="token keyword">func</span> <span class="token function">GenerateToken</span><span class="token punctuation">(</span>id <span class="token builtin">uint</span><span class="token punctuation">,</span> username <span class="token builtin">string</span><span class="token punctuation">,</span> authority <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	nowTime <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	expireTime <span class="token operator">:=</span> nowTime<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Hour<span class="token punctuation">)</span>
	claims <span class="token operator">:=</span> Claims<span class="token punctuation">{</span>
		Id<span class="token punctuation">:</span>        id<span class="token punctuation">,</span>
		Username<span class="token punctuation">:</span>  username<span class="token punctuation">,</span>
		Authority<span class="token punctuation">:</span> authority<span class="token punctuation">,</span>
		RegisteredClaims<span class="token punctuation">:</span> jwt<span class="token punctuation">.</span>RegisteredClaims<span class="token punctuation">{</span>
			ExpiresAt<span class="token punctuation">:</span> jwt<span class="token punctuation">.</span><span class="token function">NewNumericDate</span><span class="token punctuation">(</span>expireTime<span class="token punctuation">)</span><span class="token punctuation">,</span>
			Issuer<span class="token punctuation">:</span>    <span class="token string">&quot;to-do-list&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	tokenClaims <span class="token operator">:=</span> jwt<span class="token punctuation">.</span><span class="token function">NewWithClaims</span><span class="token punctuation">(</span>jwt<span class="token punctuation">.</span>SigningMethodHS256<span class="token punctuation">,</span> claims<span class="token punctuation">)</span>
	token<span class="token punctuation">,</span> err <span class="token operator">:=</span> tokenClaims<span class="token punctuation">.</span><span class="token function">SignedString</span><span class="token punctuation">(</span>jwtSecret<span class="token punctuation">)</span>
	<span class="token keyword">return</span> token<span class="token punctuation">,</span> err
<span class="token punctuation">}</span>

<span class="token comment">//ParseToken 验证用户token</span>
<span class="token keyword">func</span> <span class="token function">ParseToken</span><span class="token punctuation">(</span>token <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>Claims<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	tokenClaims<span class="token punctuation">,</span> err <span class="token operator">:=</span> jwt<span class="token punctuation">.</span><span class="token function">ParseWithClaims</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Claims<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>token <span class="token operator">*</span>jwt<span class="token punctuation">.</span>Token<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> jwtSecret<span class="token punctuation">,</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> tokenClaims <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> claims<span class="token punctuation">,</span> ok <span class="token operator">:=</span> tokenClaims<span class="token punctuation">.</span>Claims<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>Claims<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token operator">&amp;&amp;</span> tokenClaims<span class="token punctuation">.</span>Valid <span class="token punctuation">{</span>
			<span class="token keyword">return</span> claims<span class="token punctuation">,</span> <span class="token boolean">nil</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>封装了之后，在登录用户模块就可以使用JWT了。</p><p>登录模块的最后可以看到：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
		Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
		Data<span class="token punctuation">:</span> serializer<span class="token punctuation">.</span>TokenData<span class="token punctuation">{</span>User<span class="token punctuation">:</span> serializer<span class="token punctuation">.</span><span class="token function">BuildUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">,</span> Token<span class="token punctuation">:</span> token<span class="token punctuation">}</span><span class="token punctuation">,</span>
		Msg<span class="token punctuation">:</span>  <span class="token string">&quot;登录成功！&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>里面就用到：</p><blockquote><p>serializer.BuildUser(user)</p></blockquote><p>这就是刚刚在封装的BuildUser</p><h3 id="controller层" tabindex="-1"><a class="header-anchor" href="#controller层" aria-hidden="true">#</a> Controller层</h3><p>最后，你可以直接复制Todo List项目中的api下的user.go，因为你已经从实体类层一直搭建到这里，肯定知道里面的原理，当然，你也可以直接复制下面我写的代码：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">var</span> userRegisterService service<span class="token punctuation">.</span>UserService

<span class="token keyword">func</span> <span class="token function">UserRegister</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">ShouldBind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>userRegisterService<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		res <span class="token operator">:=</span> userRegisterService<span class="token punctuation">.</span><span class="token function">Register</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token function">ErrorResponse</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">UserLogin</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> userLoginService service<span class="token punctuation">.</span>UserService
	<span class="token keyword">if</span> err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">ShouldBind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>userLoginService<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		res <span class="token operator">:=</span> userLoginService<span class="token punctuation">.</span><span class="token function">Login</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token function">ErrorResponse</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>注：如果你是复制TodoList项目中的代码话，请忽略注释里面的内容，因为那个是swagger必须要写的</p></blockquote><p>同时，api/common还有一个文件是<code>common.go</code>，这个在本次项目中是封装返回错误信息的controller，直接复制也可以</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">//返回错误信息 ErrorResponse</span>
<span class="token keyword">func</span> <span class="token function">ErrorResponse</span><span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span> serializer<span class="token punctuation">.</span>Response <span class="token punctuation">{</span>
	<span class="token keyword">if</span> ve<span class="token punctuation">,</span> ok <span class="token operator">:=</span> err<span class="token punctuation">.</span><span class="token punctuation">(</span>validator<span class="token punctuation">.</span>ValidationErrors<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> e <span class="token operator">:=</span> <span class="token keyword">range</span> ve <span class="token punctuation">{</span>
			field <span class="token operator">:=</span> conf<span class="token punctuation">.</span><span class="token function">T</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Field.%s&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>Field<span class="token punctuation">)</span><span class="token punctuation">)</span>
			tag <span class="token operator">:=</span> conf<span class="token punctuation">.</span><span class="token function">T</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Tag.Valid.%s&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>Tag<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
				Code<span class="token punctuation">:</span>  <span class="token number">40001</span><span class="token punctuation">,</span>
				Msg<span class="token punctuation">:</span>   fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%s%s&quot;</span><span class="token punctuation">,</span> field<span class="token punctuation">,</span> tag<span class="token punctuation">)</span><span class="token punctuation">,</span>
				Error<span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprint</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token boolean">_</span><span class="token punctuation">,</span> ok <span class="token operator">:=</span> err<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>json<span class="token punctuation">.</span>UnmarshalTypeError<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
		<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span>  <span class="token number">40001</span><span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>   <span class="token string">&quot;JSON类型不匹配&quot;</span><span class="token punctuation">,</span>
			Error<span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprint</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
		Code<span class="token punctuation">:</span>  <span class="token number">40001</span><span class="token punctuation">,</span>
		Msg<span class="token punctuation">:</span>   <span class="token string">&quot;参数错误&quot;</span><span class="token punctuation">,</span>
		Error<span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprint</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="搭建路由" tabindex="-1"><a class="header-anchor" href="#搭建路由" aria-hidden="true">#</a> 搭建路由</h3><p>当你搭建完上述的项目，肯定还启动不起来，gin不知道你访问的地址是个什么东西，所以用gin.engine搭建路由：</p><p>这里先把swagger的写上去，等下要用到</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">NewRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>gin<span class="token punctuation">.</span>Engine <span class="token punctuation">{</span>
	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/swagger/*any&quot;</span><span class="token punctuation">,</span> ginSwagger<span class="token punctuation">.</span><span class="token function">WrapHandler</span><span class="token punctuation">(</span>swaggerFiles<span class="token punctuation">.</span>Handler<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 开启swag</span>

	<span class="token comment">// 路由</span>
	v1 <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">&quot;/api/v1&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		v1<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;ping&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token comment">// 用户操作</span>
		v1<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">&quot;user/register&quot;</span><span class="token punctuation">,</span> api<span class="token punctuation">.</span>UserRegister<span class="token punctuation">)</span>
		v1<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">&quot;user/login&quot;</span><span class="token punctuation">,</span> api<span class="token punctuation">.</span>UserLogin<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> r
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="临时测试" tabindex="-1"><a class="header-anchor" href="#临时测试" aria-hidden="true">#</a> 临时测试</h3><p>当搭建好路由以后，就可以在main函数上告诉gin你的url，你就可以访问到地址了</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	conf<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	r <span class="token operator">:=</span> routes<span class="token punctuation">.</span><span class="token function">NewRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>conf<span class="token punctuation">.</span>Port<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="搭建swagger进行测试" tabindex="-1"><a class="header-anchor" href="#搭建swagger进行测试" aria-hidden="true">#</a> 搭建swagger进行测试</h3>`,23),M={href:"https://github.com/swaggo/swag/blob/master/README_zh-CN.md%EF%BC%8C%E8%BF%9B%E8%A1%8C%E6%93%8D%E4%BD%9C%E3%80%82",target:"_blank",rel:"noopener noreferrer"},Y=p(`<p>当然有几个坑要注意：</p><ol><li>在main函数中你可能会写到：</li></ol><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">// programatically set swagger info</span>
docs<span class="token punctuation">.</span>SwaggerInfo<span class="token punctuation">.</span>Title <span class="token operator">=</span> <span class="token string">&quot;Todo List&quot;</span>
docs<span class="token punctuation">.</span>SwaggerInfo<span class="token punctuation">.</span>Description <span class="token operator">=</span> <span class="token string">&quot;This is a simple ToDoList App.&quot;</span>
docs<span class="token punctuation">.</span>SwaggerInfo<span class="token punctuation">.</span>Version <span class="token operator">=</span> <span class="token string">&quot;1.0&quot;</span>
docs<span class="token punctuation">.</span>SwaggerInfo<span class="token punctuation">.</span>Host <span class="token operator">=</span> <span class="token string">&quot;localhost:8080&quot;</span>
docs<span class="token punctuation">.</span>SwaggerInfo<span class="token punctuation">.</span>BasePath <span class="token operator">=</span> <span class="token string">&quot;/api/v1&quot;</span>
docs<span class="token punctuation">.</span>SwaggerInfo<span class="token punctuation">.</span>Schemes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;https&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>请组合以把导入的docs改一下，比如我初始化go项目的时候是：go mod init TodoList，那么我这里导入的docs</p><blockquote><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">&quot;TodoList/conf&quot;</span>
   <span class="token string">&quot;TodoList/docs&quot;</span>
   <span class="token string">&quot;TodoList/routes&quot;</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><ol start="2"><li>在controller层写go doc的时候是函数的名字！</li></ol><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">// UserRegister godoc</span>
<span class="token comment">// @Summary      用户注册</span>
<span class="token comment">// @Description  用户注册</span>
<span class="token comment">// @Tags         USER</span>
<span class="token comment">// @Accept       json</span>
<span class="token comment">// @Produce      json</span>
<span class="token comment">// @Param        data  body      service.UserService      true  &quot;用户名, 密码&quot;</span>
<span class="token comment">// @Success      200  {object}  serializer.ResponseUser  &quot;{&quot;status&quot;:200,&quot;data&quot;:{},&quot;msg&quot;:&quot;ok&quot;}&quot;</span>
<span class="token comment">// @Failure      500  {object}  serializer.ResponseUser  &quot;{&quot;status&quot;:500,&quot;data&quot;:{},&quot;Msg&quot;:{},&quot;Error&quot;:&quot;error&quot;}&quot;</span>
<span class="token comment">// @Router       /user/register [post]</span>
<span class="token keyword">func</span> <span class="token function">UserRegister</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后后续测试就可以看到成功的标志，也可以继续学习完TodoList这个项目了：</p><figure><img src="`+A+'" alt="image-20220609140443914" tabindex="0" loading="lazy"><figcaption>image-20220609140443914</figcaption></figure><h3 id="后记" tabindex="-1"><a class="header-anchor" href="#后记" aria-hidden="true">#</a> 后记</h3><p>一开始做这个项目的时候十分艰难，Java架构思想根深蒂固（一开始看到那个logger整个人都不好，又不会用依赖注入，又想用zap替代，最后搞来搞去还是回归到了原生logger），看到Gin这个架构满身的细胞都在抗拒，后面又做了几天又感觉自己又行了，整个过程像在做过山车一样！</p><h2 id="外传-项目实践-单例爬虫、协程并发爬虫" tabindex="-1"><a class="header-anchor" href="#外传-项目实践-单例爬虫、协程并发爬虫" aria-hidden="true">#</a> 外传：项目实践：单例爬虫、协程并发爬虫</h2><h3 id="使用说明" tabindex="-1"><a class="header-anchor" href="#使用说明" aria-hidden="true">#</a> 使用说明</h3><p>文件名称：Spiders</p><p>初始化mod</p><blockquote><p>go mod init xxx</p></blockquote><p>安装goquery库（仅微博使用）</p><h3 id="新浪微博" tabindex="-1"><a class="header-anchor" href="#新浪微博" aria-hidden="true">#</a> 新浪微博</h3><p>单例爬虫（需要cookie）</p><h3 id="美之图" tabindex="-1"><a class="header-anchor" href="#美之图" aria-hidden="true">#</a> 美之图</h3><p>高并发协程爬虫</p><h2 id="问题汇总" tabindex="-1"><a class="header-anchor" href="#问题汇总" aria-hidden="true">#</a> 问题汇总</h2>',22),Z={href:"https://blog.csdn.net/qq_26041727/article/details/121728316?spm=1001.2014.3001.5501",target:"_blank",rel:"noopener noreferrer"};function K(X,_){const a=i("ExternalLinkIcon");return o(),c("div",null,[E,n("p",null,[n("a",S,[s("《The Way to Go》中文译本"),t(a)])]),n("p",null,[n("a",C,[s("Go 语言简明教程"),t(a)])]),n("p",null,[n("a",L,[s("Go: The Complete Developer's Guide"),t(a)])]),n("p",null,[s("注：（"),n("a",N,[s("Go: The Complete Developer's Guide"),t(a)]),s("）欢迎去购买支持此课程，非常的棒！")]),D,B,n("p",null,[s("还有部分问题来自极客兔兔，回答是官方FAQ（"),n("a",R,[s("https://go.dev/doc/faq）"),t(a)])]),T,n("p",null,[n("a",I,[s("https://pkg.go.dev/std"),t(a)])]),P,n("blockquote",null,[n("p",null,[s("参考资料："),n("a",z,[s("字符串拼接性能及原理 | Go 语言高性能编程 | 极客兔兔"),t(a)])])]),j,n("ul",null,[n("li",null,[n("a",Q,[s("Automatically generate RESTful API documentation with Swagger 2.0 for Go. "),t(a)])]),n("li",null,[n("a",G,[s("Gin+Gorm+Redis+Swagger 基于 RESTful API 规范搭建备忘录"),t(a)])]),n("li",null,[n("a",U,[s("Gin+Gorm开发Golang API快速开发脚手架 "),t(a)])])]),F,n("ol",J,[n("li",null,[s("但是此时的运行不起来的，要完成migration，这属于GORM的范畴了，具体学习可以到："),n("a",H,[s("https://gorm.io/zh_CN/docs/migration.html"),t(a)])])]),O,n("p",null,[s("go-jwt好像换维护者了，地址："),n("a",W,[s("https://github.com/golang-jwt/jwt，用法也稍有不同。"),t(a)])]),V,n("p",null,[s("完全可以按照："),n("a",M,[s("https://github.com/swaggo/swag/blob/master/README_zh-CN.md，进行操作。"),t(a)])]),Y,n("p",null,[n("a",Z,[s("go语言/golang protobuf windows解决方案"),t(a)])])])}const nn=e(x,[["render",K],["__file","learnInProblem.html.vue"]]);export{nn as default};
