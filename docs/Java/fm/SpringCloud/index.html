<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Java/fm/SpringCloud">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<title data-rh="true">SpringCloud | Computer Science Learn Notes</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/docs/Java/fm/SpringCloud"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SpringCloud | Computer Science Learn Notes"><meta data-rh="true" name="description" content="观看地址：https://www.bilibili.com/video/BV18E411x7eT"><meta data-rh="true" property="og:description" content="观看地址：https://www.bilibili.com/video/BV18E411x7eT"><link data-rh="true" rel="icon" href="/Computer-Science-Learn-Notes/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/docs/Java/fm/SpringCloud"><link data-rh="true" rel="alternate" href="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/docs/Java/fm/SpringCloud" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/docs/Java/fm/SpringCloud" hreflang="x-default"><link rel="stylesheet" href="/Computer-Science-Learn-Notes/assets/css/styles.e2ac7477.css">
<link rel="preload" href="/Computer-Science-Learn-Notes/assets/js/runtime~main.af325474.js" as="script">
<link rel="preload" href="/Computer-Science-Learn-Notes/assets/js/main.7db0b496.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Computer-Science-Learn-Notes/"><div class="navbar__logo"><img src="/Computer-Science-Learn-Notes/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/Computer-Science-Learn-Notes/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Computer Science Learn Notes</b></a><a class="navbar__item navbar__link" href="/Computer-Science-Learn-Notes/docs/intro">主页</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/Computer-Science-Learn-Notes/docs/golang/learnInProblem">目录</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Computer-Science-Learn-Notes/docs/golang/learnInProblem">Go语言</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Computer-Science-Learn-Notes/docs/frontend/react/">前端</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Computer-Science-Learn-Notes/docs/fundamental/datastruct">基础知识</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/basic/">Java基础</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/basic/">基础知识</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/concurrent/">并发编程</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/简介">虚拟机</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/Spring">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/SpringMVC">SpringMVC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/Mybatis">Mybatis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/SpringBoot">SpringBoot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/SpringDataJpa">SpringDataJpa</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/SpringSecurity">SpringSecurity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/SpringCloud">SpringCloud</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/docker/main">Docker</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/eightpart/main">Java面试</a></div></li></ul></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/Computer-Science-Learn-Notes/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">目录</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Java基础</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">SpringCloud</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>前言</h1><p>观看地址：<a href="https://www.bilibili.com/video/BV18E411x7eT" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/video/BV18E411x7eT</a></p><p>什么是微服务架构：</p><p><img loading="lazy" alt="1597213385700" src="/Computer-Science-Learn-Notes/assets/images/1597213385700-3376ca924401d6402f34b45e70120804.png" width="1254" height="583" class="img_ev3q"></p><p>SpringCloud 是微服务一站式服务解决方案，微服务全家桶。它是微服务开发的主流技术栈。它采用了名称，而非数字版本号。</p><p>springCloud 和 springCloud Alibaba 目前是最主流的微服务框架组合。</p><p>版本选择：</p><blockquote><p>选用 springboot 和 springCloud 版本有约束，不按照它的约束会有冲突。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cloud简介">Cloud简介<a class="hash-link" href="#cloud简介" title="标题的直接链接">​</a></h2><p><img loading="lazy" alt="1597213783265" src="/Computer-Science-Learn-Notes/assets/images/1597213783265-8762126ed424429cc2bd64898b7adb46.png" width="1485" height="462" class="img_ev3q"></p><p>参考资料，尽量去官网</p><p><img loading="lazy" alt="1597213855903" src="/Computer-Science-Learn-Notes/assets/images/1597213855903-404e3f4957c7d5c231db6e8eb4a7df6f.png" width="1300" height="87" class="img_ev3q"></p><blockquote><p><a href="https://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/" target="_blank" rel="noopener noreferrer">https://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/</a></p></blockquote><h1>工程建造</h1><p>写一个下图的Hello World</p><p><img loading="lazy" alt="1597225177689" src="/Computer-Science-Learn-Notes/assets/images/1597225177689-b0e0adc102d239ac9838e43829645fc8.png" width="1103" height="571" class="img_ev3q"></p><p>构建父工程，后面的项目模块都在此工程中：</p><p><img loading="lazy" alt="1597214225785" src="/Computer-Science-Learn-Notes/assets/images/1597214225785-7f82b9933e527f93cf63cdd46a8468f4.png" width="1158" height="713" class="img_ev3q"></p><p>设置编码：Settings -&gt; File Encodings</p><p>注解激活：<img loading="lazy" alt="1597214602636" src="/Computer-Science-Learn-Notes/assets/images/1597214602636-2ddb078a65080708a95e86e09774e9f0.png" width="1283" height="890" class="img_ev3q"></p><p>Java版本确定：</p><p><img loading="lazy" alt="1597214699619" src="/Computer-Science-Learn-Notes/assets/images/1597214699619-1773ed67e054d25d95ceca77638620a6.png" width="1442" height="860" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="父工程pom配置">父工程pom配置<a class="hash-link" href="#父工程pom配置" title="标题的直接链接">​</a></h2><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">project</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xmlns:</span><span class="token tag attr-name" style="color:#00a4db">xsi</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://www.w3.org/2001/XMLSchema-instance</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">  </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xsi:</span><span class="token tag attr-name" style="color:#00a4db">schemaLocation</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">4.0.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud2020</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.0-SNAPSHOT</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 第一步 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">packaging</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">packaging</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 统一管理 jar 包版本 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">properties</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">project.build.sourceEncoding</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">UTF-8</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">project.build.sourceEncoding</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">maven.compiler.source</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.8</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">maven.compiler.source</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">maven.compiler.target</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.8</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">maven.compiler.target</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">junit.version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">4.12</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">junit.version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">log4j.version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.2.17</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">log4j.version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">lombok.version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.16.18</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">lombok.version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">mysql.version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">5.1.47</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">mysql.version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">druid.version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.1.16</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">druid.version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">mybatis.spring.boot.version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.3.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">mybatis.spring.boot.version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">properties</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 子块基础之后，提供作用：锁定版本 + 子module不用写 groupId 和 version --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencyManagement</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.maven.plugins</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">maven-project-info-reports-plugin</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">3.0.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 下面三个基本是微服务架构的标配 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--spring boot 2.2.2--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-dependencies</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">2.2.2.RELEASE</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">type</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">type</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--spring cloud Hoxton.SR1--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-dependencies</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Hoxton.SR1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">type</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">type</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--spring cloud 阿里巴巴--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-alibaba-dependencies</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">2.1.0.RELEASE</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">type</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">pom</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">type</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">import</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--mysql--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mysql</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mysql-connector-java</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${mysql.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- druid--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">druid</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${druid.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${mybatis.spring.boot.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--junit--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">junit</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">junit</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${junit.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--log4j--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">log4j</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">log4j</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${log4j.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencyManagement</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">build</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">plugins</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">plugin</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-maven-plugin</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">configuration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">fork</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">fork</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">addResources</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">addResources</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">configuration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">plugin</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">plugins</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">build</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">project</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>上面配置的解释：</p><blockquote><p>首先要加 <code>&lt;packaging&gt;pom&lt;/packaging&gt;</code> 这个。</p><p>聚合版本依赖，dependencyManagement 只声明依赖，并不实现引入，所以子项目还需要写要引入的依赖。</p><p><img loading="lazy" alt="1597215801116" src="/Computer-Science-Learn-Notes/assets/images/1597215801116-5075a273ae3b04b028be58d6de5ea897.png" width="1239" height="179" class="img_ev3q"></p></blockquote><p><img loading="lazy" alt="1597215611540" src="/Computer-Science-Learn-Notes/assets/images/1597215611540-af6f1c2b30f3ac7f489a6e6b4e655c8a.png" width="1195" height="318" class="img_ev3q"></p><p><img loading="lazy" alt="1597215639355" src="/Computer-Science-Learn-Notes/assets/images/1597215639355-055eea190ac1fdf777a5b11636202c66.png" width="932" height="466" class="img_ev3q"></p><p><img loading="lazy" alt="1597215666979" src="/Computer-Science-Learn-Notes/assets/images/1597215666979-f0e77b1ebe082f80c37271f012cd4c3e.png" width="1544" height="350" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="第一个微服务架构">第一个微服务架构<a class="hash-link" href="#第一个微服务架构" title="标题的直接链接">​</a></h2><blockquote><ol><li>建模块 module</li><li>改 pom</li><li>写yml</li><li>主启动</li><li>业务类</li></ol></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="提供者">提供者<a class="hash-link" href="#提供者" title="标题的直接链接">​</a></h3><p>cloud-provider-payment8001 子工程的pom文件：</p><blockquote><p>这里面的 lombok 这个包，引入以后，实体类不用再写set 和 get</p><p>可以如下写实体类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.AllArgsConstructor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.Data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.NoArgsConstructor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@AllArgsConstructor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@NoArgsConstructor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Payment implements Serializable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private Integer id;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private String serial;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">project</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xmlns:</span><span class="token tag attr-name" style="color:#00a4db">xsi</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://www.w3.org/2001/XMLSchema-instance</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xsi:</span><span class="token tag attr-name" style="color:#00a4db">schemaLocation</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">parent</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud2020</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.0-SNAPSHOT</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">parent</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">4.0.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-provider-payment8001</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--eureka-client--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-eureka-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.atguigu.springcloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">druid-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.1.10</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--mysql-connector-java--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mysql</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mysql-connector-java</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--jdbc--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-jdbc</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">project</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>cloud-provider-payment8001 子工程的yml文件：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cloud</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">provider</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">payment8001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">datasource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> com.alibaba.druid.pool.DruidDataSource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">driver-class-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> org.gjt.mm.mysql.Driver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> jdbc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">mysql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//localhost</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">3306/cloud2020</span><span class="token punctuation" style="color:#393A34">?</span><span class="token plain">useUnicode=true</span><span class="token important">&amp;characterEncoding=utf-8&amp;useSSL=false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">username</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">password</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">mybatis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">mapper-locations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> classpath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">mapper/</span><span class="token important">*.xml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type-aliases-package</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> com.dkf.springcloud.entities  </span><span class="token comment" style="color:#999988;font-style:italic"># 所有Entity 别名类所在包</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>cloud-provider-payment8001 子工程的主启动类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.springcloud;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.boot.SpringApplication;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootApplication</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class PaymentMain8001 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SpringApplication.run(PaymentMain8001.class, args);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>下面的常规操作：</p><p><img loading="lazy" alt="1597217986370" src="/Computer-Science-Learn-Notes/assets/images/1597217986370-450e563016a75a781774f68fc715b4fe.png" width="472" height="422" class="img_ev3q"></p><p>mybatis的mapper文件和service层代码不写了，下面记录一个特殊的Entity类，和Controller</p><p>CommonResult:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.springcloud.entities;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.AllArgsConstructor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.Data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.NoArgsConstructor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 如果前后端分离，这个是提供给前端信息和数据的类</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param &lt;T&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@AllArgsConstructor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@NoArgsConstructor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CommonResult&lt;T&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Integer code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String messgae;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private T data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 查询为空的时候使用的构造器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param messgae</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public CommonResult(Integer code, String messgae){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this(code, messgae, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Controller：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.springcloud.controller;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import com.dkf.springcloud.entities.CommonResult;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import com.dkf.springcloud.entities.Payment;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import com.dkf.springcloud.service.PaymentService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.stereotype.Controller;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.GetMapping;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.PathVariable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.PostMapping;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.RestController;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.annotation.Resource;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@RestController   //必须是这个注解，因为是模拟前后端分离的restful风格的请求，要求每个方法返回 json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class PaymentController {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Resource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private PaymentService paymentService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @PostMapping(value = &quot;/payment/create&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //      注意这里的 @RequestBody  是必须要写的，虽然 MVC可以自动封装参数成为对象，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //      但是当消费者项目调用，它传参是 payment 整个实例对象传过来的， 即Json数据，因此需要写这个注解</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public CommonResult create(@RequestBody Payment payment){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int result = paymentService.create(payment);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info(&quot;****插入结果：&quot; + result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(result &gt; 0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return new CommonResult(200, &quot;插入数据库成功&quot;, result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new CommonResult(444, &quot;插入数据库失败&quot;, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @GetMapping(value = &quot;/payment/{id}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public CommonResult getPaymentById(@PathVariable(&quot;id&quot;)Long id){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Payment result = paymentService.getPaymentById(id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info(&quot;****查询结果：&quot; + result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(result != null){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return new CommonResult(200, &quot;查询成功&quot;, result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new CommonResult(444, &quot;没有对应id的记录&quot;, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>不但编译有个别地方会报错，启动也会报错，但是测试两个接口都是没问题的，推测启动报错是因为引入了下面才会引入的jar包，目前不影响。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="热部署配置">热部署配置<a class="hash-link" href="#热部署配置" title="标题的直接链接">​</a></h3><ol><li>具体模块里添加Jar包到工程中，上面的pom文件已经添加上了</li></ol><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>添加plus到父工程的pom文件中：上i按也已经添加好了</li></ol><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">build</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">plugins</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">plugin</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-maven-plugin</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">configuration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">fork</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">fork</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">addResources</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">addResources</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">configuration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">plugin</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">plugins</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">build</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li><p><img loading="lazy" alt="1597222225568" src="/Computer-Science-Learn-Notes/assets/images/1597222225568-f3958d7878055f7fdbafb56cd4e84415.png" width="862" height="594" class="img_ev3q"></p></li><li><p>shift + ctrl + alt + / 四个按键一块按，选择Reg项：</p></li></ol><p><img loading="lazy" alt="1597222341651" src="/Computer-Science-Learn-Notes/assets/images/1597222341651-bd2216e106b864f3ea147d4d451628a4.png" width="662" height="459" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="消费者">消费者<a class="hash-link" href="#消费者" title="标题的直接链接">​</a></h3><blockquote><p>消费者现在只模拟调用提供者的Controller方法，没有持久层配置，只有Controller和实体类</p><p>当然也要配置主启动类和启动端口</p></blockquote><p>pom文件：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">project</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xmlns:</span><span class="token tag attr-name" style="color:#00a4db">xsi</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://www.w3.org/2001/XMLSchema-instance</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xsi:</span><span class="token tag attr-name" style="color:#00a4db">schemaLocation</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">parent</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud2020</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.0-SNAPSHOT</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">parent</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">4.0.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-customer-order80</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-eureka-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--&lt;dependency&gt;&amp;lt;!&amp;ndash; 引入自己定义的api通用包，可以使用Payment支付Entity &amp;ndash;&amp;gt;--&gt;</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--&lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;--&gt;</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--&lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;--&gt;</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--&lt;version&gt;${project.version}&lt;/version&gt;--&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--&lt;/dependency&gt;--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">project</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>把CommonResult 和 Payment 两个 实体类也创建出来</p><p><img loading="lazy" alt="1597224961560" src="/Computer-Science-Learn-Notes/assets/images/1597224961560-0a20f52f1ddbf41099dd0f26ec99946f.png" width="436" height="462" class="img_ev3q"></p><p>ApplicationContextConfig 内容：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.springcloud.config;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.web.client.RestTemplate;@Configurationpublic class ApplicationContextConfig {    @Bean    public RestTemplate getRestTemplate(){        return new RestTemplate();    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Controller ：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.springcloud.controller;import com.dkf.springcloud.entities.CommonResult;import com.dkf.springcloud.entities.Payment;import lombok.extern.slf4j.Slf4j;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PathVariable;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RestController;import org.springframework.web.client.RestTemplate;import javax.annotation.Resource;@RestController@Slf4jpublic class OrderController {    //远程调用的 地址    public static final String PAYMENY_URL = &quot;http://localhost:8001&quot;;    @Resource    private RestTemplate restTemplate;    @PostMapping(&quot;customer/payment/create&quot;)    public CommonResult&lt;Payment&gt; create (Payment payment){        /**        param1 请求地址，param2 请求参数， param3 返回类型        */        return restTemplate.postForObject(PAYMENY_URL + &quot;/payment/create&quot;, payment, CommonResult.class);    }    @GetMapping(&quot;customer/payment/{id}&quot;)    public CommonResult&lt;Payment&gt; getPaymentById(@PathVariable(&quot;id&quot;)Long id){        return restTemplate.getForObject(PAYMENY_URL + &quot;/payment/&quot; + id, CommonResult.class);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果 runDashboard 控制台没有出来，右上角搜索 即可</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="工程重构">工程重构<a class="hash-link" href="#工程重构" title="标题的直接链接">​</a></h3><blockquote><p>上面 两个子项目，有多次重复的 导入 jar，和重复的 Entity 实体类。可以把 多余的部分，加入到一个独立的模块中，将这个模块打包，并提供给需要使用的 module</p></blockquote><ol><li>新建一个 cloud-dkf-commons 子模块</li><li>将 entities 包里面的实体类放到这个子模块中，也将 pom 文件中，重复导入的 jar包放到这个新建的 模块的 pom 文件中。如下：</li></ol><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">project</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xmlns:</span><span class="token tag attr-name" style="color:#00a4db">xsi</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://www.w3.org/2001/XMLSchema-instance</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xsi:</span><span class="token tag attr-name" style="color:#00a4db">schemaLocation</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">parent</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud2020</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.0-SNAPSHOT</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">parent</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">4.0.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 这个是新添加的，之前没用到，后面会用到 --&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cn.hutool</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">hutool-all</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">5.1.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--         关于这个hutool 是个功能强大的工具包，官网：https://hutool.cn/ --&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">project</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>将此项目打包 install 到 maven仓库。</p><ol start="3"><li>将 提供者 和 消费者 两个项目中的 entities 包删除，并删除掉加入到 cloud-api-commons 模块的 依赖配置。</li><li>将 打包到 maven 仓库的 cloud-api-commons 模块，引入到 提供者 和 消费者的 pom 文件中，如下所示</li></ol><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>完成！</p><h1>服务注册中心</h1><blockquote><p>如果是上面只有两个微服务，通过 RestTemplate ，是可以相互调用的，但是当微服务项目的数量增大，就需要服务注册中心。目前没有学习服务调用相关技术，使用 SpringCloud 自带的 RestTemplate 来实现RPC</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="eureka">Eureka<a class="hash-link" href="#eureka" title="标题的直接链接">​</a></h2><blockquote><p>官方停更不停用，以后可能用的越来越少。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="概念和理论">概念和理论<a class="hash-link" href="#概念和理论" title="标题的直接链接">​</a></h3><blockquote><p>它是用来服务治理，以及服务注册和发现，服务注册如下图：</p></blockquote><p><img loading="lazy" alt="1597291856582" src="/Computer-Science-Learn-Notes/assets/images/1597291856582-39f4a72f87e418130f7d6fa085a0d50c.png" width="1511" height="529" class="img_ev3q"></p><p><img loading="lazy" alt="1597291942982" src="/Computer-Science-Learn-Notes/assets/images/1597291942982-c007ba1e7c9c39c5ded4ee1458dbb604.png" width="1541" height="171" class="img_ev3q"></p><p><img loading="lazy" alt="1597291981643" src="/Computer-Science-Learn-Notes/assets/images/1597291981643-4cf13e14c39e361bbfd066010a61fc36.png" width="1538" height="433" class="img_ev3q"></p><p>版本说明：</p><p><img loading="lazy" alt="1597292154107" src="/Computer-Science-Learn-Notes/assets/images/1597292154107-7dada54ec7edc307bf043b6c70b7c667.png" width="866" height="530" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="server模块">Server模块<a class="hash-link" href="#server模块" title="标题的直接链接">​</a></h3><blockquote><p>server 模块使用 7001端口，下面是pom文件需要的依赖：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-eureka-server7001</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-eureka-server</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><blockquote><p>下面配置 yml 文件：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server:port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">7001eureka:instance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">hostname</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> localhost  </span><span class="token comment" style="color:#999988;font-style:italic"># eureka 服务器的实例名称client: # false 代表不向服务注册中心注册自己，因为它本身就是服务中心 register-with-eureka: false # false 代表自己就是服务注册中心，自己的作用就是维护服务实例，并不需要去检索服务 fetch-registry: false service-url:   # 设置与 Eureka Server 交互的地址，查询服务 和 注册服务都依赖这个地址   defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>最后写主启动类，如果启动报错，说没有配置 DataSource ，就在 主启动类的注解加上 这样的配置：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// exclude ：启动时不启用 DataSource的自动配置检查@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)@EnableEurekaServer   // 表示它是服务注册中心public class EurekaServerMain7001 { public static void main(String[] args){     SpringApplication.run(EurekaServerMain7001.class, args); }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><p>启动测试，访问 7001 端口</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="提供者-1">提供者<a class="hash-link" href="#提供者-1" title="标题的直接链接">​</a></h3><blockquote><p>这里的提供者，还是使用 上面的 cloud-provider-payment8001 模块，做如下修改：</p></blockquote><ol><li>在 pom 文件的基础上引入 eureka 的client包，pom 的全部依赖如下所示：</li></ol><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-provider-payment8001</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--eureka-client--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-eureka-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">druid-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.1.10</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--mysql-connector-java--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mysql</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mysql-connector-java</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--jdbc--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-jdbc</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>主启动类 加上注解 ： @EnableEurekaClient</li><li>yml 文件添加关于 Eureka 的配置：</li></ol><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">eureka</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">client</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 注册进 Eureka 的服务中心    register-with-eureka: true    # 检索 服务中心 的其它服务    fetch-registry: true    service-url:      # 设置与 Eureka Server 交互的地址      defaultZone: http://localhost:7001/eureka/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>应用名称：</p><p><img loading="lazy" alt="1597294710656" src="/Computer-Science-Learn-Notes/assets/images/1597294710656-a13ba4f73f3b7b4b225a840a0752179c.png" width="1151" height="549" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="消费者-1">消费者<a class="hash-link" href="#消费者-1" title="标题的直接链接">​</a></h3><blockquote><p>这里的消费者 也是上面 的 cloud-customer-order80 模块</p></blockquote><ol><li>修改 pom 文件，加入Eureka 的有关依赖， 全部 pom 依赖如下：</li></ol><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-customer-order80</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-eureka-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>主启动类 加上注解 ： @EnableEurekaClient</li><li>yml 文件必须添加的内容：</li></ol><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">eureka</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">client</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">register-with-eureka</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">true    fetch-registry</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">true    service-url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">defaultZone</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">http://localhost:7001/eureka/spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cloud</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">order</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="eureka-集群">Eureka 集群<a class="hash-link" href="#eureka-集群" title="标题的直接链接">​</a></h3><blockquote><p>Eureka 集群的原理，就是 相互注册，互相守望</p><p>模拟多个 Eureka Server 在不同机器上 ： 进入C:\Windows\System32\drivers\etc\hosts  添加如下：</p><p>127.0.0.1 eureka7001.com</p><p>127.0.0.1 eureka 7002.com</p></blockquote><p>现在创建 cloud-eureka-server7002 ，也就是第二个 Eureka 服务注册中心，pom 文件和 主启动类，与第一个Server一致。</p><p>现在修改这两个 Server 的 yml 配置：</p><p>7001 端口的Server yml文件：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">7001eureka</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">instance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">hostname</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eureka7001.com  </span><span class="token comment" style="color:#999988;font-style:italic"># eureka 服务器的实例地址  client:    register-with-eureka: false    fetch-registry: false    service-url:    ## 一定要注意这里的地址，这是搭建集群的关键      defaultZone: http://eureka7002.com:7002/eureka/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>7002 端口的Server yml文件：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">7002eureka</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">instance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">hostname</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eureka7002.com  </span><span class="token comment" style="color:#999988;font-style:italic"># eureka 服务器的实例地址  client:    register-with-eureka: false    fetch-registry: false    service-url:    ## 一定要注意这里的地址 这是搭建集群的关键      defaultZone: http://eureka7001.com:7001/eureka/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>eureka.instance.hostname 才是启动以后 本 Server 的注册地址，而 service-url  是 map 类型，只要保证 key:value 格式就行，它代表 本Server 指向了那些 其它Server 。利用这个，就可以实现Eureka Server 相互之间的注册，从而实现集群的搭建。</p></blockquote><p>将 提供者 和 消费者 注册进两个Eureka Server 中，下面是 消费者和提供者的 yml 文件关于Eureka的配置：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">eureka</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">client</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">register-with-eureka</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">true    fetch-registry</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">true    service-url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">defaultZone</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//eureka7001.com</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">7001/eureka/</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//eureka7002.com</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">7002/eureka/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>从这里可以看出，也可以使用列表形式进行Server之间的关联注册。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="提供者集群">提供者集群<a class="hash-link" href="#提供者集群" title="标题的直接链接">​</a></h3><blockquote><p>为提供者，即 cloud-provider-payment8001 模块创建集群，新建模块为 cloud-provider-payment8002</p><p>最终实现：</p><p><img loading="lazy" alt="1597301105015" src="/Computer-Science-Learn-Notes/assets/images/1597301105015-5625f30af4a841cab3573e0b35157b26.png" width="839" height="564" class="img_ev3q"></p><p>注意在 Controller 返回不同的消息，从而区分者两个提供者的工作状态。</p></blockquote><p>其余配置都一致，需要配置集群的配置如下：</p><p>配置区别：只要保证消费者项目对服务注册中心提供的名称一致，即完成集群。</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8001</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 端口号不一样spring:  application:    name: cloud-provider-service  # 这次重点是这里，两个要写的一样，这是这个集群的关键  datasource:    type: com.alibaba.druid.pool.DruidDataSource    driver-class-name: org.gjt.mm.mysql.Driver    url: jdbc:mysql://localhost:3306/cloud2020?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false    username: root    password: 123456mybatis:  mapper-locations: classpath:mapper/*.xml  type-aliases-package: com.dkf.springcloud.entities  eureka:  client:    register-with-eureka: true    fetch-registry: true    service-url:      defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>消费者的配置</p><blockquote><p>就是消费者如何访问 由这两个提供者组成的集群？</p></blockquote><p>Eureka Server 上的提供者的服务名称如下：</p><p><img loading="lazy" alt="1597299306196" src="/Computer-Science-Learn-Notes/assets/images/1597299306196-b602c8bab695378bba8a106b6113f47c.png" width="642" height="252" class="img_ev3q"></p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@RestController@Slf4jpublic class OrderController {                             // 重点是这里，改成 提供者在Eureka 上的名称，而且无需写端口号        public static final String PAYMENY_URL = &quot;http://CLOUD-PROVIDER-SERVICE&quot;;    @Resource    private RestTemplate restTemplate;    @PostMapping(&quot;customer/payment/create&quot;)    public CommonResult&lt;Payment&gt; create (Payment payment){        return restTemplate.postForObject(PAYMENY_URL + &quot;/payment/create&quot;, payment, CommonResult.class);    }    @GetMapping(&quot;customer/payment/{id}&quot;)    public CommonResult&lt;Payment&gt; getPaymentById(@PathVariable(&quot;id&quot;)Long id){        return restTemplate.getForObject(PAYMENY_URL + &quot;/payment/&quot; + id, CommonResult.class);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>还有，消费者里面对RestTemplate配置的config文件，需要更改成如下：（就是加一个注解 @LoadBalanced）</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.springcloud.config;import org.springframework.cloud.client.loadbalancer.LoadBalanced;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.web.client.RestTemplate;@Configurationpublic class ApplicationContextConfig {    @Bean    @LoadBalanced  //这个注解，就赋予了RestTemplate 负载均衡的能力    public RestTemplate getRestTemplate(){        return new RestTemplate();    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>测试，完成！</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="actuator信息配置">actuator信息配置<a class="hash-link" href="#actuator信息配置" title="标题的直接链接">​</a></h3><p>修改 在Eureka 注册中心显示的 主机名：</p><p><img loading="lazy" alt="1597301247809" src="/Computer-Science-Learn-Notes/assets/images/1597301247809-1cec9b2bf5802ffc4e2d9b758040ae3b.png" width="881" height="370" class="img_ev3q"></p><p><img loading="lazy" alt="1597301299700" src="/Computer-Science-Learn-Notes/assets/images/1597301299700-76b423ed0f971766810e8ff8de5af8bb.png" width="1385" height="179" class="img_ev3q"></p><p>显示微服务所在 的主机地址：</p><p><img loading="lazy" alt="1597301356051" src="/Computer-Science-Learn-Notes/assets/images/1597301356051-2a5d1b4c00a2a938f89f4aa84629b149.png" width="772" height="396" class="img_ev3q"></p><p><img loading="lazy" alt="1597301396971" src="/Computer-Science-Learn-Notes/assets/images/1597301396971-9a7812bd384377834eb7ba369f82c844.png" width="1230" height="529" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="服务发现discovery">服务发现Discovery<a class="hash-link" href="#服务发现discovery" title="标题的直接链接">​</a></h3><blockquote><p>对于注册进eureka里面的微服务，可以通过服务发现来获得该服务的信息</p></blockquote><ol><li>在主启动类上添加注解：@EnableDiscoveryClient</li><li>在 Controller 里面打印信息：</li></ol><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Resource    private DiscoveryClient discoveryClient;    @GetMapping(&quot;/customer/discovery&quot;)    public Object discovery(){        List&lt;String&gt; services = discoveryClient.getServices();        for(String service: services){            log.info(&quot;*****service: &quot; + service);        }        List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(&quot;CLOUD-ORDER-SERVICE&quot;);        for(ServiceInstance serviceInstance:instances){            log.info(serviceInstance.getServiceId() + &quot;\t&quot; + serviceInstance.getHost()                    + &quot;\t&quot; + serviceInstance.getPort() + &quot;\t&quot; + serviceInstance.getUri());        }        return this.discoveryClient;    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="eureka-自我保护机制">Eureka 自我保护机制<a class="hash-link" href="#eureka-自我保护机制" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="1597302605610" src="/Computer-Science-Learn-Notes/assets/images/1597302605610-298161b1b3fd6c6084a2829d26cd29a8.png" width="993" height="105" class="img_ev3q"></p><p><img loading="lazy" alt="1597302314591" src="/Computer-Science-Learn-Notes/assets/images/1597302314591-e79f1847323d365a587866de2ed99e88.png" width="1483" height="438" class="img_ev3q"></p><p><img loading="lazy" alt="1597302449686" src="/Computer-Science-Learn-Notes/assets/images/1597302449686-f61ba1e8e0ba499acc8625b74c7d2fe1.png" width="1527" height="495" class="img_ev3q"></p><p>禁止自我保护:</p><blockquote><p>在 Eureka Server 的模块中的 yml 文件进行配置：</p></blockquote><p><img loading="lazy" alt="1597302719594" src="/Computer-Science-Learn-Notes/assets/images/1597302719594-68d3eabc8e6aa21ce60964d58699e45a.png" width="785" height="536" class="img_ev3q"></p><p>修改 Eureka Client 模块的 心跳间隔时间：</p><p><img loading="lazy" alt="1597302855396" src="/Computer-Science-Learn-Notes/assets/images/1597302855396-0f9e6b77435842d41bbeb150e9668bd8.png" width="1051" height="592" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="zookeeper">Zookeeper<a class="hash-link" href="#zookeeper" title="标题的直接链接">​</a></h2><blockquote><p>springCloud 整合 zookeeper</p></blockquote><p><img loading="lazy" alt="1597303059965" src="/Computer-Science-Learn-Notes/assets/images/1597303059965-0686684c740dfecf55058144389cc93c.png" width="779" height="157" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="提供者-2">提供者<a class="hash-link" href="#提供者-2" title="标题的直接链接">​</a></h3><blockquote><p>创建一个提供者，和之前的一样即可，使用 8004端口</p></blockquote><p>pom文件如下：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-provider-payment8004</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--springcloud 整合 zookeeper 组件--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-zookeeper-discovery</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">exclusions</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">exclusion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.zookeeper</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">zookeeper</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">exclusion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">exclusions</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.zookeeper</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">zookeeper</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">3.4.9</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">exclusions</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">exclusion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.slf4j</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">slf4j-log4j12</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">exclusion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">exclusions</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">druid-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.1.10</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--mysql-connector-java--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mysql</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mysql-connector-java</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--jdbc--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-jdbc</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.cloud.client.discovery.EnableDiscoveryClient;@SpringBootApplication@EnableDiscoveryClient  public class PaymentMain8004 {    public static void main(String[] args){        SpringApplication.run(PaymentMain8004.class, args);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Controller 打印信息：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@RestController@Slf4jpublic class PaymentController {    @Resource    private PaymentService paymentService;    @Value(&quot;${server.port}&quot;)    private String serverPort;    @RequestMapping(&quot;/payment/zk&quot;)    public String paymentzk(){        return &quot;springcloud with zookeeper :&quot; + serverPort + &quot;\t&quot; + UUID.randomUUID().toString();    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>***如果 zookeeper 的版本和导入的jar包版本不一致，启动就会报错，由jar包冲突的问题。</p><p>解决这种冲突，需要在 pom 文件中，排除掉引起冲突的jar包，添加和服务器zookeeper版本一致的 jar 包，</p><p>但是新导入的 zookeeper jar包 又有 slf4j 冲突问题，于是再次排除引起冲突的jar包</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!--springcloud 整合 zookeeper 组件--&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-zookeeper-discovery</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 排除与zookeeper版本不一致到导致 冲突的 jar包 --&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">exclusions</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">exclusion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.zookeeper</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">zookeeper</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">exclusion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">exclusions</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 添加对应版本的jar包 --&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.zookeeper</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">zookeeper</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">3.4.9</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 排除和 slf4j 冲突的 jar包 --&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">exclusions</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">exclusion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.slf4j</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">slf4j-log4j12</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">exclusion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">exclusions</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>yml文件：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">8004spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cloud-provider-service  cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">zookeeper</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">connect-string</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 192.168.40.100</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">2181</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>启动测试：</p><p><img loading="lazy" alt="1597306855233" src="data:image/png;base64,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" width="435" height="68" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="消费者-2">消费者<a class="hash-link" href="#消费者-2" title="标题的直接链接">​</a></h3><blockquote><p>创建测试zookeeper作为服务注册中心的 消费者 模块 cloud-customerzk-order80</p><p>主启动类、pom文件、yml文件和提供者的类似</p></blockquote><p>config类，注入 RestTemplate</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootConfigurationpublic class ApplicationContextConfig {    @Bean    @LoadBalanced    public RestTemplate getTemplate(){        return new RestTemplate();    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>controller层也是和之前类似：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@RestController@Slf4jpublic class CustomerZkController {    public static final String INVOKE_URL=&quot;http://cloud-provider-service&quot;;    @Resource    private RestTemplate restTemplate;    @RequestMapping(&quot;/customer/payment/zk&quot;)    public String paymentInfo(){        String result = restTemplate.getForObject(INVOKE_URL + &quot;/payment/zk&quot;,String.class);        return result;    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>关于 zookeeper 的集群搭建，目前使用较少，而且在 yml 文件中的配置也是类似，以列表形式写入 zookeeper 的多个地址即可，而且zookeeper 集群，在 hadoop的笔记中也有记录。总而言之，只要配合zookeeper集群，以及yml文件的配置就能完成集群搭建</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="consul">Consul<a class="hash-link" href="#consul" title="标题的直接链接">​</a></h2><blockquote><p>consul也是服务注册中心的一个实现，是由go语言写的。官网地址： <a href="https://www.consul.io/intro" target="_blank" rel="noopener noreferrer">https://www.consul.io/intro</a></p><p>中文地址： <a href="https://www.springcloud.cc/spring-cloud-consul.html" target="_blank" rel="noopener noreferrer">https://www.springcloud.cc/spring-cloud-consul.html</a></p><p>功能：<img loading="lazy" alt="1597380885054" src="/Computer-Science-Learn-Notes/assets/images/1597380885054-91693cdb21f91f0e1deba19bd4f2e888.png" width="1072" height="391" class="img_ev3q"></p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="安装并运行">安装并运行<a class="hash-link" href="#安装并运行" title="标题的直接链接">​</a></h3><blockquote><p> 下载地址：<a href="https://www.consul.io/downloads.html" target="_blank" rel="noopener noreferrer">https://www.consul.io/downloads.html</a></p><p> 打开下载的压缩包，只有一个exe文件，实际上是不用安装的，在exe文件所在目录打开dos窗口使用即可。</p><p> 使用开发模式启动：consul agent -dev</p><p> 访问8500端口，即可访问首页</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="提供者-3">提供者<a class="hash-link" href="#提供者-3" title="标题的直接链接">​</a></h3><blockquote><p>新建提供者模块：cloud-providerconsul-service8006</p></blockquote><p>pom 文件：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-providerconsul-service8006</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--springcloud consul server--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-consul-discovery</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springboot整合Web组件 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 日常通用jar包 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>yml 文件：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">8006spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">consul-provider-service  cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">consul</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">localhost      port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">8500      discovery</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 指定注册对外暴露的服务名称        service-name: ${spring.application.name}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootApplication@EnableDiscoveryClientpublic class ConsulProviderMain8006 {    public static void main(String[] args) {        SpringApplication.run(ConsulProviderMain8006.class,args);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>controller也是简单的写一下就行。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="消费者-3">消费者<a class="hash-link" href="#消费者-3" title="标题的直接链接">​</a></h3><blockquote><p>新建 一个 在82端口的 消费者模块。pom和yml和提供者的类似，主启动类不用说，记得注入RestTemplate</p></blockquote><p>controller层：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@RestControllerpublic class CustomerConsulController {    public static final String INVOKE_URL=&quot;http://consul-provider-service&quot;;    @Resource    private RestTemplate restTemplate;    @RequestMapping(&quot;/customer/payment/consul&quot;)    public String paymentInfo(){        String result = restTemplate.getForObject(INVOKE_URL + &quot;/payment/consul&quot;,String.class);        return result;    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a class="hash-link" href="#总结" title="标题的直接链接">​</a></h2><p><img loading="lazy" alt="1597384290665" src="/Computer-Science-Learn-Notes/assets/images/1597384290665-ed7d6645433ebf2c93e9cc546275b7bd.png" width="928" height="636" class="img_ev3q"></p><p><img loading="lazy" alt="1597384344513" src="/Computer-Science-Learn-Notes/assets/images/1597384344513-f14aad7249e1a9478c4d2b47e7de078a.png" width="1550" height="314" class="img_ev3q"></p><p><img loading="lazy" alt="1597384362750" src="/Computer-Science-Learn-Notes/assets/images/1597384362750-240d31d16e936d446194e6be861a40c8.png" width="826" height="611" class="img_ev3q"></p><p>AP:</p><p><img loading="lazy" alt="1597384508291" src="/Computer-Science-Learn-Notes/assets/images/1597384508291-f275ed76c5802c1011d6342fb21d58fa.png" width="814" height="669" class="img_ev3q"></p><p>CP：</p><p><img loading="lazy" alt="1597384554249" src="/Computer-Science-Learn-Notes/assets/images/1597384554249-f6e4553ecd9839a3d1043894fee8bd3d.png" width="801" height="665" class="img_ev3q"></p><h1>服务调用</h1><blockquote><p>都是使用在 client端，即有 ”消费者“ 需求的模块中。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ribbon">Ribbon<a class="hash-link" href="#ribbon" title="标题的直接链接">​</a></h2><blockquote><p>我们这里提前启动好之前在搭建的 eureka Server 集群（5个模块）</p><p><img loading="lazy" alt="1597384873709" src="/Computer-Science-Learn-Notes/assets/images/1597384873709-e04f58a5cbc5eab09f91096f4ab57e94.png" width="1506" height="321" class="img_ev3q"></p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="简介">简介<a class="hash-link" href="#简介" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="1597384916817" src="/Computer-Science-Learn-Notes/assets/images/1597384916817-a8bdec1c221624b8e8c154dcc4a18fb0.png" width="1548" height="204" class="img_ev3q"></p><p><img loading="lazy" alt="1597385089429" src="/Computer-Science-Learn-Notes/assets/images/1597385089429-bfc2f8c1e100f1e534cc2130c9355739.png" width="1537" height="394" class="img_ev3q"></p><p><img loading="lazy" alt="1597385250463" src="/Computer-Science-Learn-Notes/assets/images/1597385250463-6b5096e4dbe0c2fb85d1ee68cae74a4c.png" width="1073" height="615" class="img_ev3q"></p><p><img loading="lazy" alt="1597385267753" src="/Computer-Science-Learn-Notes/assets/images/1597385267753-68f1bd370918f43136349bfe5da0f1d7.png" width="930" height="207" class="img_ev3q"></p><p>上面在eureka时，确实实现了负载均衡机制，那是因为 eureka-client包里面自带着ribbon：</p><blockquote><p>一句话，Ribbon 就是 负载均衡 + RestTemplate 调用。实际上不止eureka的jar包有，zookeeper的jar包，还有consul的jar包都包含了他，就是上面使用的服务调用。</p></blockquote><p><img loading="lazy" alt="1597385486515" src="/Computer-Science-Learn-Notes/assets/images/1597385486515-38408eb1bee2a9b512c0606db2d82655.png" width="701" height="390" class="img_ev3q"></p><p>如果自己添加，在 模块的 pom 文件中引入：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-ribbon</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>对于RestTemplate 的一些说明：</p><blockquote><p>有两种请求方式：post和get ,还有两种返回类型：object 和 Entity</p></blockquote><p><img loading="lazy" alt="1597385762892" src="/Computer-Science-Learn-Notes/assets/images/1597385762892-cde70900373cc37e2b391039befb870b.png" width="1141" height="429" class="img_ev3q"></p><p>RestTemplate 的 ForEntity 相比 ForObject特殊的地方:</p><p><img loading="lazy" alt="1597385959115" src="/Computer-Science-Learn-Notes/assets/images/1597385959115-0de99a8168927a1b2c6e81b299fbaf01.png" width="1290" height="312" class="img_ev3q"></p><p><img loading="lazy" alt="1597385892918" src="/Computer-Science-Learn-Notes/assets/images/1597385892918-86406e8eba1d2fd059868a06a9d872e7.png" width="1357" height="79" class="img_ev3q"></p><p>就是 如果使用 ForObject 得到的就是提供者返回的对象，而如果要使用 ForEntity 得到时 ResponstEntity对象，使用getBody()才能得到提供者返回的数据。</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    //使用forEnriry示例：    @GetMapping(&quot;customer/payment/forEntity/{id}&quot;)    public CommonResult&lt;Payment&gt; getPaymentById2(@PathVariable(&quot;id&quot;)Long id){                ResponseEntity&lt;CommonResult&gt; entity = restTemplate.getForEntity(PAYMENY_URL + &quot;/payment/&quot; + id, CommonResult.class);                if(entity.getStatusCode().is2xxSuccessful()){            return entity.getBody();        }else{            return new CommonResult&lt;&gt;(444, &quot;操作失败&quot;);        }    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="负载均衡">负载均衡<a class="hash-link" href="#负载均衡" title="标题的直接链接">​</a></h3><p>Ribbon 负载均衡规则类型：</p><p><img loading="lazy" alt="1597386516205" src="/Computer-Science-Learn-Notes/assets/images/1597386516205-0e4ecf38920ec311b39fdd39c71d83fc.png" width="1500" height="406" class="img_ev3q"></p><p>配置负载均衡规则：</p><p><img loading="lazy" alt="1597386638507" src="/Computer-Science-Learn-Notes/assets/images/1597386638507-3c5f79c132e18eceaf79146278f99a29.png" width="1099" height="151" class="img_ev3q"></p><blockquote><p>注意上面说的，而Springboot主启动类上的 @SpringBootApplication 注解，相当于加了@ComponentScan注解，会自动扫描当前包及子包，所以注意不要放在SpringBoot主启动类的包内。</p></blockquote><p>创建包：</p><p><img loading="lazy" alt="1597386816245" src="data:image/png;base64,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" width="249" height="153" class="img_ev3q"></p><p>在这个包下新建 MySelfRule类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.myrule;import com.netflix.loadbalancer.IRule;import com.netflix.loadbalancer.RandomRule;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;@Configurationpublic class MySelfRule {    @Bean    public IRule myrule(){        return new RandomRule(); //负载均衡规则定义为随机    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后在主启动类上添加如下注解 @RibbonClient：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.springcloud;import com.dkf.myrule.MySelfRule;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.cloud.client.discovery.EnableDiscoveryClient;import org.springframework.cloud.netflix.eureka.EnableEurekaClient;import org.springframework.cloud.netflix.ribbon.RibbonClient;@SpringBootApplication@EnableEurekaClient@EnableDiscoveryClient     //指定该负载均衡规则对哪个提供者服务使用    加载自定义规则的配置类@RibbonClient(name=&quot;CLOUD-PROVIDER-SERVICE&quot;, configuration = MySelfRule.class)public class OrderMain80 {    public static void main(String[] args){        SpringApplication.run(OrderMain80.class, args);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="轮询算法原理">轮询算法原理<a class="hash-link" href="#轮询算法原理" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="1597387609476" src="/Computer-Science-Learn-Notes/assets/images/1597387609476-2268aff595601450ccf1a79069cb4f07.png" width="1412" height="537" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="openfeign">OpenFeign<a class="hash-link" href="#openfeign" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="概述">概述<a class="hash-link" href="#概述" title="标题的直接链接">​</a></h3><blockquote><p>这里和之前学的dubbo很像，例如消费者的controller 可以调用提供者的 service层方法，但是不一样，它貌似只能调用提供者的 controller，即写一个提供者项目的controller的接口，消费者来调用这个接口方法，就还是相当于是调用提供者的 controller ，和RestTemplate 没有本质区别</p></blockquote><p><img loading="lazy" alt="1597389321006" src="/Computer-Science-Learn-Notes/assets/images/1597389321006-91866dff4410cda090d8b78a0d1456c7.png" width="1530" height="424" class="img_ev3q"></p><p><img loading="lazy" alt="1597389522738" src="/Computer-Science-Learn-Notes/assets/images/1597389522738-7a9ff887ecbc17c3b273c193bef4d12a.png" width="1532" height="319" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用">使用<a class="hash-link" href="#使用" title="标题的直接链接">​</a></h3><blockquote><p>新建一个消费者募模块。feign自带负载均衡配置，所以不用手动配置</p></blockquote><p>pom ：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- Open Feign --&gt;</span><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-openfeign</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- eureka Client --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-eureka-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootApplication@EnableFeignClients   //关键注解public class CustomerFeignMain80 {    public static void main(String[] args) {        SpringApplication.run(CustomerFeignMain80.class, args);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>新建一个service</p><blockquote><p>这个service还是 customer 模块的接口，和提供者没有任何关系，不需要包类名一致。它使用起来就相当于是普通的service。</p><p>推测大致原理，对于这个service 接口，读取它某个方法的注解（GET或者POST注解不写报错），知道了请求方式和请求地址，而抽象方法，只是对于我们来讲，调用该方法时，可以进行传参等。</p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Component@FeignClient(value = &quot;CLOUD-PROVIDER-SERVICE&quot;)  //服务名称，要和eureka上面的一致才行public interface PaymentFeignService {    //这个就是provider 的controller层的方法定义。    @GetMapping(value = &quot;/payment/{id}&quot;)    public CommonResult getPaymentById(@PathVariable(&quot;id&quot;)Long id);}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Controller层：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//使用起来就相当于是普通的service。@RestControllerpublic class CustomerFeignController {    @Resource    private PaymentFeignService paymentFeignService;    @GetMapping(&quot;customer/feign/payment/{id}&quot;)    public CommonResult&lt;Payment&gt; getPaymentById(@PathVariable(&quot;id&quot;) Long id){        return paymentFeignService.getPaymentById(id);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="超时控制">超时控制<a class="hash-link" href="#超时控制" title="标题的直接链接">​</a></h3><blockquote><p>Openfeign默认超时等待为一秒，在消费者里面配置超时时间</p></blockquote><p><img loading="lazy" alt="1597467640971" src="/Computer-Science-Learn-Notes/assets/images/1597467640971-5a81dc926309cae9ef403b500723c632.png" width="1112" height="346" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="开启日志打印">开启日志打印<a class="hash-link" href="#开启日志打印" title="标题的直接链接">​</a></h3><p>首先写一个config配置类：</p><p><img loading="lazy" alt="1597468025532" src="/Computer-Science-Learn-Notes/assets/images/1597468025532-56747eaf96eb341d2b59e9d9d3ddb5e9.png" width="477" height="266" class="img_ev3q"></p><p>然后在yml文件中开启日志打印配置：</p><p><img loading="lazy" alt="1597468071030" src="/Computer-Science-Learn-Notes/assets/images/1597468071030-aa9a800016601ce8694cd77eb1df206c.png" width="792" height="129" class="img_ev3q"></p><h1>中级部分</h1><blockquote><p>主要是服务降级、服务熔断、服务限流的开发思想和框架实现</p></blockquote><h1>Hystrix 断路器</h1><blockquote><p>官方地址：<a href="https://github.com/Netflix/Hystrix/wiki/How-To-Use" target="_blank" rel="noopener noreferrer">https://github.com/Netflix/Hystrix/wiki/How-To-Use</a></p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="概述-1">概述<a class="hash-link" href="#概述-1" title="标题的直接链接">​</a></h2><p><img loading="lazy" alt="1597468299249" src="/Computer-Science-Learn-Notes/assets/images/1597468299249-75c00533080133a6f4d5531ea8dcb0fc.png" width="1561" height="295" class="img_ev3q"></p><p><img loading="lazy" alt="1597468336180" src="/Computer-Science-Learn-Notes/assets/images/1597468336180-bbbc3faf7f7a6246dacb492c64cfe36e.png" width="1550" height="230" class="img_ev3q"></p><p>服务降级：</p><blockquote><p>服务器忙碌或者网络拥堵时，不让客户端等待并立刻返回一个友好提示，fallback</p><p>发生的情况：<img loading="lazy" alt="1597468904865" src="/Computer-Science-Learn-Notes/assets/images/1597468904865-1566bb974b7cf2cd1983e244659f4724.png" width="656" height="286" class="img_ev3q"></p></blockquote><p>服务熔断：</p><blockquote><p><img loading="lazy" alt="1597552633205" src="/Computer-Science-Learn-Notes/assets/images/1597552633205-b799644427c8c6a05a7721357fb35bb1.png" width="1244" height="101" class="img_ev3q"></p></blockquote><p>服务限流：</p><blockquote><p><img loading="lazy" alt="1597468986791" src="/Computer-Science-Learn-Notes/assets/images/1597468986791-ee42b7e04cb69659106fa5a56e1e9ed0.png" width="1090" height="67" class="img_ev3q"></p></blockquote><blockquote><p>可见，上面的技术不论是消费者还是提供者，根据真实环境都是可以加入配置的。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="案例">案例<a class="hash-link" href="#案例" title="标题的直接链接">​</a></h2><blockquote><p>首先构建一个eureka作为服务中心的单机版微服务架构 ，这里使用之前eureka Server 7001模块，作为服务中心</p></blockquote><p>新建 提供者  cloud-provider-hystrix-payment8001 模块：</p><p>pom 文件：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- hystrix --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-hystrix</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--eureka-client--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-eureka-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>下面主启动类、service、和controller代码都很简单普通。</p><p>主启动类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)@EnableEurekaClientpublic class PaymentMain8001 {    public static void main(String[] args) {        SpringApplication.run(PaymentMain8001.class,args);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>service层：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Servicepublic class PaymentService {    /**     * 可以正常访问的方法     * @param id     * @return     */    public String paymentinfo_Ok(Integer id){        return &quot;线程池：&quot; + Thread.currentThread().getName() + &quot;--paymentInfo_OK，id:&quot; + id;    }    /**    超时访问的方法    */    public String paymentinfo_Timeout(Integer id){        int interTime = 3;        try{            TimeUnit.SECONDS.sleep(interTime);        }catch (Exception e){            e.printStackTrace();        }        return &quot;线程池：&quot; + Thread.currentThread().getName() + &quot;--paymentInfo_Timeout，id:&quot; + id + &quot;耗时&quot; + interTime + &quot;秒钟--&quot;;    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>controller层：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@RestController@Slf4jpublic class PaymentController {    @Resource    private PaymentService paymentService;    @Value(&quot;${server.port}&quot;)    private String serverPort;    @GetMapping(&quot;/payment/hystrix/{id}&quot;)    public String paymentInfo_OK(@PathVariable(&quot;id&quot;)Integer id){        log.info(&quot;paymentInfo_OKKKKOKKK&quot;);        return paymentService.paymentinfo_Ok(id);    }    @GetMapping(&quot;/payment/hystrix/timeout/{id}&quot;)    public String paymentInfo_Timeout(@PathVariable(&quot;id&quot;)Integer id){        log.info(&quot;paymentInfo_timeout&quot;);        return paymentService.paymentinfo_Timeout(id);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="模拟高并发">模拟高并发<a class="hash-link" href="#模拟高并发" title="标题的直接链接">​</a></h3><blockquote><p>这里使用一个新东西 JMeter 压力测试器</p><p>下载压缩包，解压，双击 /bin/ 下的 jmeter.bat 即可启动</p><p><img loading="lazy" alt="1597471683432" src="/Computer-Science-Learn-Notes/assets/images/1597471683432-74e50ca2826f2cef9b731cc0d7337910.png" width="823" height="475" class="img_ev3q"></p><p><img loading="lazy" alt="1597471750363" src="/Computer-Science-Learn-Notes/assets/images/1597471750363-ed250ca6ca51b4c763565a5dccdb5f95.png" width="483" height="612" class="img_ev3q"></p><p>ctrl + S 保存。</p><p><img loading="lazy" alt="1597472029967" src="/Computer-Science-Learn-Notes/assets/images/1597472029967-b8e51163bf8aea7eef90f41a632b5c6b.png" width="1516" height="491" class="img_ev3q"></p></blockquote><p>从测试可以看出，当模拟的超长请求被高并发以后，访问普通的小请求速率也会被拉低。</p><p>新建消费者 cloud-customer-feign-hystrix-order80 模块：以feign为服务调用，eureka为服务中心的模块，yml、pom等文件不再赘写。</p><p>测试可见，当启动高并发测试时，消费者访问也会变得很慢，甚至出现超时报错。</p><p>解决思路：</p><p><img loading="lazy" alt="1597474348167" src="/Computer-Science-Learn-Notes/assets/images/1597474348167-1b38548c87541a70cb0d980587e0e67e.png" width="1554" height="203" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="服务降级">服务降级<a class="hash-link" href="#服务降级" title="标题的直接链接">​</a></h3><blockquote><p>一般服务降级放在客户端，即 消费者端 ，但是提供者端一样能使用。</p><p>首先提供者，即8001 先从自身找问题，设置自身调用超时的峰值，峰值内正常运行，超出峰值需要有兜底的方法处理，作服务降级fallback</p></blockquote><p>首先 对 8001 的service进行配置（对容易超时的方法进行配置) :</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    @HystrixCommand(fallbackMethod = &quot;paymentInfo_timeoutHandler&quot;, commandProperties = {            //设置峰值，超过 3 秒，就会调用兜底方法，这个时间也可以由feign控制            @HystrixProperty(name=&quot;execution.isolation.thread.timeoutInMilliseconds&quot;, value = &quot;3000&quot;)    })    public String paymentinfo_Timeout(Integer id){        ......会执行5秒.....    }    //兜底方法，根据上述配置，程序内发生异常、或者运行超时，都会执行该兜底方法    public String paymentInfo_timeoutHandler(Integer id){        .......    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类添加注解： @EnableCircuitBreaker</p><p>然后对 80 进行服务降级：很明显 service 层是接口，所以我们对消费者，在它的 controller 层进行降级</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">     @HystrixCommand(fallbackMethod = &quot;paymentInfo_timeoutHandler&quot;, commandProperties = {            //设置峰值，超过 3 秒，就会调用兜底方法            @HystrixProperty(name=&quot;execution.isolation.thread.timeoutInMilliseconds&quot;, value = &quot;3000&quot;)    })    @GetMapping(&quot;/customer/payment/hystrix/timeout/{id}&quot;)    public String paymentInfo_Timeout(@PathVariable(&quot;id&quot;)Integer id){        log.info(&quot;paymentInfo_timeout&quot;);        return orderService.paymentInfo_Timeout(id);    }   //兜底方法，注意，兜底方法参数随意    public String paymentInfo_timeoutHandler(@PathVariable(&quot;id&quot;)Integer id){        log.info(&quot;paymentInfo_timeout--handler&quot;);        return &quot;访问 payment 失败----人工报错&quot;;    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类添加注解： @EnableCircuitBreaker</p><p>完成测试！ 注意，消费者降级设置的超时时间和提供者的没有任何关系，就算提供者峰值是 5 秒，而消费者峰值是 3秒，那么消费者依然报错。就是每个模块在服务降级上，都是独立的。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="全局服务降级">全局服务降级<a class="hash-link" href="#全局服务降级" title="标题的直接链接">​</a></h3><blockquote><p>上面的降级策略，很明显造成了代码的杂乱，提升了耦合度，而且按照这样，每个方法都需要配置一个兜底方法，很繁琐。现在将降级处理方法（兜底方法）做一个全局的配置，设置共有的兜底方法和独享的兜底方法。</p></blockquote><p>问题-每个方法配置一个，解决：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@RestController@Slf4j//全局配置降级方法的注解@DefaultProperties(defaultFallback = &quot;paymentInfo_timeoutHandler&quot;)public class OrderController {    .....    // 不写自己的 fallbackMethod 属性，就使用全局默认的    @HystrixCommand(commandProperties = {            @HystrixProperty(name=&quot;execution.isolation.thread.timeoutInMilliseconds&quot;, value = &quot;3000&quot;)    })    @GetMapping(&quot;/customer/payment/hystrix/timeout/{id}&quot;)    public String paymentInfo_Timeout(@PathVariable(&quot;id&quot;)Integer id){        ......    }    //兜底方法    public String paymentInfo_timeoutHandler(){        log.info(&quot;paymentInfo_timeout--handler&quot;);        return &quot;访问 payment 失败----人工报错&quot;;    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>问题-跟业务逻辑混合，解决（解耦）：</p><blockquote><p>在这种方式一般是在客户端，即消费者端，首先上面再controller中添加的  @HystrixCommand 和 @DefaultProperties 两个注解去掉。就是保持原来的controller</p></blockquote><ol><li>yml文件配置</li></ol><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">80spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cloud-customer-feign-hystrix-serviceeureka</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">client</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">register-with-eureka</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">true    fetch-registry</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">true    service-url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">defaultZone</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//eureka7001.com</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">7001/eureka/</span><span class="token comment" style="color:#999988;font-style:italic"># 用于服务降级 在注解@FeignClient 中添加 fallback 属性值feign:  hystrix:    enabled: true  # 在feign中开启 hystrix</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>修改service 接口：</li></ol><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Component                                          // 这里是重点@FeignClient(value = &quot;CLOUD-PROVIDER-HYSTRIX-PAYMENT&quot;, fallback = OrderFallbackService.class)public interface OrderService {    @GetMapping(&quot;/payment/hystrix/{id}&quot;)    public String paymentInfo_OK(@PathVariable(&quot;id&quot;)Integer id);    @GetMapping(&quot;/payment/hystrix/timeout/{id}&quot;)    public String paymentInfo_Timeout(@PathVariable(&quot;id&quot;)Integer id);}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>fallback 指向的类：</li></ol><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.springcloud.service;import org.springframework.stereotype.Component;@Component                      //注意这里，它实现了service接口public class OrderFallbackService implements  OrderService{    @Override    public String paymentInfo_OK(Integer id) {        return &quot;OrderFallbackService --发生异常&quot;;    }    @Override    public String paymentInfo_Timeout(Integer id) {        return &quot;OrderFallbackService --发生异常--paymentInfo_Timeout&quot;;    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>新问题，这样配置如何设置超时时间？</p><blockquote><p>首先要知道 下面两个 yml 配置项：</p><div class="language-properties codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-properties codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hystrix.command.default.execution.timeout.enable=true    ## 默认值## 为false则超时控制有ribbon控制，为true则hystrix超时和ribbon超时都是用，但是谁小谁生效，默认为truehystrix.command.default.execution.isolation.thread.timeoutInMilliseconds=1000  ## 默认值## 熔断器的超时时长默认1秒，最常修改的参数</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>看懂以后，所以：</p><p>只需要在yml配置里面配置 Ribbon 的 超时时长即可。注意：hystrix 默认自带 ribbon包。</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">ribbon</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">ReadTimeout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">xxxx   ConnectTimeout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> xxx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="服务熔断">服务熔断<a class="hash-link" href="#服务熔断" title="标题的直接链接">​</a></h3><blockquote><p>实际上服务熔断 和 服务降级 没有任何关系，就像 java 和 javaScript</p><p>服务熔断，有点自我恢复的味道</p></blockquote><p><img loading="lazy" alt="1597552755235" src="/Computer-Science-Learn-Notes/assets/images/1597552755235-87b486d3ea7c46482125d63a6339c5a6.png" width="1233" height="281" class="img_ev3q"></p><p><img loading="lazy" alt="1597555271916" src="/Computer-Science-Learn-Notes/assets/images/1597555271916-411c99af9ce46109605f6db159e96941.png" width="1400" height="174" class="img_ev3q"></p><p><img loading="lazy" alt="1597555381295" src="/Computer-Science-Learn-Notes/assets/images/1597555381295-bc1256f5968fc4251f52d885dbcdc3c5.png" width="1537" height="578" class="img_ev3q"></p><p>以 8001 项目为示例：</p><p>service层的方法设置服务熔断:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    //=====服务熔断    @HystrixCommand(fallbackMethod = &quot;paymentCircuitBreaker_fallback&quot;, commandProperties = {            @HystrixProperty(name=&quot;circuitBreaker.enabled&quot;, value=&quot;true&quot;),  // 是否开启断路器            @HystrixProperty(name=&quot;circuitBreaker.requestVolumeThreshold&quot;, value=&quot;10&quot;),  //请求次数            @HystrixProperty(name=&quot;circuitBreaker.sleepWindowInMilliseconds&quot;, value=&quot;10000&quot;), // 时间窗口期            @HystrixProperty(name=&quot;circuitBreaker.errorThresholdPercentage&quot;, value=&quot;60&quot;),  // 失败率达到多少后跳闸            //整体意思：10秒内 10次请求，有6次失败，就跳闸    })    public String paymentCircuitBreaker(Integer id){        //模拟发生异常        if(id &lt; 0){            throw new RuntimeException(&quot;*****id，不能为负数&quot;);        }        String serialNumber = IdUtil.simpleUUID();        return Thread.currentThread().getName() + &quot;\t&quot; + &quot;调用成功，流水号：&quot; + serialNumber;    }    public String paymentCircuitBreaker_fallback(Integer id){        return &quot;id 不能为负数，请稍后再试....&quot;;    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>controller:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    //====服务熔断    @GetMapping(&quot;/payment/circuit/{id}&quot;)    public String paymentCircuitBreaker(@PathVariable(&quot;id&quot;)Integer id){        return paymentService.paymentCircuitBreaker(id);    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>关于解耦以后的全局配置说明：</p><p>例如上面提到的全局服务降级，并且是feign+hystrix整合，即 service 实现类的方式，如何做全局配置？</p><blockquote><p>上面有 做全局配置时，设置超时时间的方式，我们可以从中获得灵感，即在yml文件中 进行熔断配置：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">hystrix:command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">default</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">circuitBreaker</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">true     requestVolumeThreshold</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">10     sleepWindowInMilliseconds</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">10000     errorThresholdPercentage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hystrix-dashboard">Hystrix DashBoard<a class="hash-link" href="#hystrix-dashboard" title="标题的直接链接">​</a></h2><p><img loading="lazy" alt="1597556913055" src="/Computer-Science-Learn-Notes/assets/images/1597556913055-134cb7ab185ff77902ed8ac3f0740c7e.png" width="1547" height="160" class="img_ev3q"></p><p>新建模块 cloud-hystrix-dashboard9001 ：</p><p>pom 文件：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- hystrix Dashboard--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-hystrix-dashboard</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 常规 jar 包 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>yml文件只需要配置端口号，主启动类加上这样注解：@EnableHystrixDashboard</p><p>启动测试：访问  http://ocalhost:9001/hystrix</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="监控实战">监控实战<a class="hash-link" href="#监控实战" title="标题的直接链接">​</a></h3><blockquote><p>下面使用上面 9001 Hystrix Dashboard 项目，来监控 8001 项目 Hystrix 的实时情况：</p></blockquote><p><img loading="lazy" alt="1597557620438" src="/Computer-Science-Learn-Notes/assets/images/1597557620438-65ec383742b824a0d1a115ec24050134.png" width="1072" height="587" class="img_ev3q"></p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Beanpublic ServletRegistrationBean getServlet(){        HystrixMetricsStreamServlet streamServlet = new HystrixMetricsStreamServlet();        ServletRegistrationBean servletRegistrationBean = new ServletRegistrationBean(streamServlet);        servletRegistrationBean.setLoadOnStartup(1);        servletRegistrationBean.addUrlMappings(&quot;/hystrix.stream&quot;);        servletRegistrationBean.setName(&quot;HystrixMetricsStreamServlet&quot;);        return servletRegistrationBean;    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="1597558323714" src="/Computer-Science-Learn-Notes/assets/images/1597558323714-d4aa9b2fffdb71a6d225f030dece4222.png" width="1066" height="697" class="img_ev3q"></p><p><img loading="lazy" alt="1597558486510" src="/Computer-Science-Learn-Notes/assets/images/1597558486510-a3578986702cc3b462e126410d04ba29.png" width="1413" height="621" class="img_ev3q"></p><h1>服务网关</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="gateway">Gateway<a class="hash-link" href="#gateway" title="标题的直接链接">​</a></h2><blockquote><p>内容过多，开发可参考 <a href="https://docs.spring.io/" target="_blank" rel="noopener noreferrer">https://docs.spring.io/</a>  官网文档</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="简介-1">简介<a class="hash-link" href="#简介-1" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="1597559672607" src="/Computer-Science-Learn-Notes/assets/images/1597559672607-0fd9ae8244f71462e3214c74ef4560b1.png" width="1546" height="291" class="img_ev3q"></p><p><img loading="lazy" alt="1597559733238" src="/Computer-Science-Learn-Notes/assets/images/1597559733238-23257bf9c6a682a50bddd11bd14de828.png" width="1126" height="78" class="img_ev3q"></p><p><img loading="lazy" alt="1597559829633" src="/Computer-Science-Learn-Notes/assets/images/1597559829633-9287efa4ea5e28d2db1d65d44d9f76ee.png" width="1321" height="337" class="img_ev3q"></p><p><img loading="lazy" alt="1597559787064" src="/Computer-Science-Learn-Notes/assets/images/1597559787064-a6213282a9532070f0479bd7837683e8.png" width="934" height="611" class="img_ev3q"></p><p>Gateway特性：</p><p><img loading="lazy" alt="1597559871114" src="/Computer-Science-Learn-Notes/assets/images/1597559871114-2a9d422b7dc718875d3248e06bfbffa3.png" width="869" height="364" class="img_ev3q"></p><p>三大核心概念：</p><p><img loading="lazy" alt="1597560126904" src="/Computer-Science-Learn-Notes/assets/images/1597560126904-12211e8791e18e0555e34151c751a81e.png" width="1432" height="218" class="img_ev3q"></p><p><img loading="lazy" alt="1597560156913" src="/Computer-Science-Learn-Notes/assets/images/1597560156913-f23d43065071d58ad58b59420129744b.png" width="1305" height="579" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="入门配置">入门配置<a class="hash-link" href="#入门配置" title="标题的直接链接">​</a></h3><p>新建模块 cloud-gateway-gateway9527</p><blockquote><p>现在实现，通过Gateway (网关) 来访问其它项目，这里选择之前8001项目，要求注册进Eureka Server 。其它没要求。</p></blockquote><p>pom文件：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--gateway--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-gateway</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--eureka-client gateWay作为网关，也要注册进服务中心--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-eureka-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- gateway和web不能同时存在，即web相关jar包不能导入 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>yml文件：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">9527spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cloud</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">gateway  </span><span class="token comment" style="color:#999988;font-style:italic">## GateWay配置  cloud:    gateway:      routes:        - id: payment_routh  # 路由ID ， 没有固定的规则但要求唯一，建议配合服务名          uri: http://localhost:8001  # 匹配后提供服务的路由地址          predicates:            - Path=/payment/get/**  # 断言，路径相匹配的进行路由        - id: payment_routh2  # 路由ID ， 没有固定的规则但要求唯一，建议配合服务名          uri: http://localhost:8001  # 匹配后提供服务的路由地址          predicates:            - Path=/payment/lb/**  # 断言，路径相匹配的进行路由# 注册进 eureka Servereureka:  client:    service-url:      defaultZone: http://eureka7001.com:7001/eureka/    register-with-eureka: true    fetch-registry: true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类，很普通，没有特殊的配置：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootApplication@EnableEurekaClientpublic class GatewayMain9527 {    public static void main(String[] args) {        SpringApplication.run(GatewayMain9527.class,args);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>访问测试：1 启动eureka Server，2 启动 8001 项目，3 启动9527（Gateway项目）</p><blockquote><p>可见，当我们访问 http://localhost:9527/payment/get/1 时，即访问网关地址时，会给我们转发到 8001 项目的请求地址，以此作出响应。</p><p>加入网关前：http://localhost:8001/payment/get/1</p><p>加入网关后：http://localhost:9527/payment/get/1</p></blockquote><p>上面是以 yml 文件配置的路由，也有使用config类配置的方式：</p><p><img loading="lazy" alt="1597562601072" src="/Computer-Science-Learn-Notes/assets/images/1597562601072-c1465907ad5b775b164aea31694663f2.png" width="1049" height="445" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="动态配置">动态配置<a class="hash-link" href="#动态配置" title="标题的直接链接">​</a></h3><blockquote><p>这里所谓的动态配置就是利用服务注册中心，来实现 负载均衡 的调用 多个微服务。</p><p>注意，这是GateWay 的负载均衡</p></blockquote><p>对yml进行配置：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cloud-gateway  cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">gateway</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">discovery</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">locator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 开启从注册中心动态创建路由的功能，利用微服务名进行路由      routes:        - id: payment_routh  # 路由ID ， 没有固定的规则但要求唯一，建议配合服务名         # uri: http://localhost:8001  # 匹配后提供服务的路由地址          uri: lb://CLOUD-PROVIDER-SERVICE          predicates:            - Path=/payment/get/**  # 断言，路径相匹配的进行路由        - id: payment_routh2  # 路由ID ， 没有固定的规则但要求唯一，建议配合服务名        #  uri: http://localhost:8001  # 匹配后提供服务的路由地址          uri: lb://CLOUD-PROVIDER-SERVICE          predicates:            - Path=/payment/lb/**  # 断言，路径相匹配的进行路由# uri: lb://CLOUD-PROVIDER-SERVICE  解释：lb 属于GateWay 的关键字，代表是动态uri，即代表使用的是服务注册中心的微服务名，它默认开启使用负载均衡机制 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>下面可以开启 8002 模块，并将它与8001同微服务名，注册到 Eureka Server 进行测试。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="predicate">Predicate<a class="hash-link" href="#predicate" title="标题的直接链接">​</a></h3><blockquote><p>注意到上面yml配置中，有个predicates 属性值。</p></blockquote><p><img loading="lazy" alt="1597563769828" src="/Computer-Science-Learn-Notes/assets/images/1597563769828-a8cdcd6df7457d3624e0cd37a61bc0fb.png" width="662" height="571" class="img_ev3q"></p><p>具体使用：</p><p><img loading="lazy" alt="1597563898772" src="/Computer-Science-Learn-Notes/assets/images/1597563898772-796fe2c33cb32239bafb9bec79e3c5a3.png" width="869" height="223" class="img_ev3q"></p><p><img loading="lazy" alt="1597564084571" src="/Computer-Science-Learn-Notes/assets/images/1597564084571-fc3413e5eb17662861d852a258d35417.png" width="1006" height="407" class="img_ev3q"></p><p><img loading="lazy" alt="1597564241670" src="/Computer-Science-Learn-Notes/assets/images/1597564241670-2596513e090c92e28f0a5d73ada64b23.png" width="977" height="406" class="img_ev3q"></p><p><img loading="lazy" alt="1597564397523" src="/Computer-Science-Learn-Notes/assets/images/1597564397523-a0a7edd77fbdf78bab672c68d25df856.png" width="1266" height="493" class="img_ev3q"></p><blockquote><p>放爬虫思路，前后端分离的话，只限定前端项目主机访问，这样可以屏蔽大量爬虫。</p><p>例如我加上： - Host=localhost:**       ** 代表允许任何端口</p><p>就只能是主机来访</p></blockquote><p>配置错误页面:</p><blockquote><p>注意，springboot默认/static/error/ 下错误代码命名的页面为错误页面，即 404.html</p><p>而且不需要导入额外的包，Gateway 里面都有。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="filter">Filter<a class="hash-link" href="#filter" title="标题的直接链接">​</a></h3><blockquote><p>主要是配置全局自定义过滤器，其它的小配置具体看官网吧</p></blockquote><p>自定义全局过滤器配置类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Componentpublic class GateWayFilter implements GlobalFilter, Ordered {    @Override    public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) {        System.out.println(&quot;------come in MyGlobalFilter : &quot;+ new Date());        String uname = exchange.getRequest().getQueryParams().getFirst(&quot;uname&quot;);        //合法性检验        if(uname == null){            System.out.println(&quot;----用户名为null,非法用户，请求不被接受&quot;);            //设置 response 状态码   因为在请求之前过滤的，so就算是返回NOT_FOUND 也不会返回错误页面            exchange.getResponse().setStatusCode(HttpStatus.NOT_FOUND);            //完成请求调用            return exchange.getResponse().setComplete();        }        return chain.filter(exchange);    }    //返回值是加载顺序，一般全局的都是第一位加载    @Override    public int getOrder() {        return 0;    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>服务配置</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="config">Config<a class="hash-link" href="#config" title="标题的直接链接">​</a></h2><blockquote><p>SpringCloud Config 分布式配置中心</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="概述-2">概述<a class="hash-link" href="#概述-2" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="1597643368929" src="/Computer-Science-Learn-Notes/assets/images/1597643368929-1558a5aaf24b789aa1c87320f4cd8eac.png" width="1532" height="178" class="img_ev3q"></p><p><img loading="lazy" alt="1597643414093" src="/Computer-Science-Learn-Notes/assets/images/1597643414093-c8e6dade5651fc7fae66e177f9281597.png" width="1559" height="584" class="img_ev3q"></p><p><img loading="lazy" alt="1597643478588" src="/Computer-Science-Learn-Notes/assets/images/1597643478588-5c91f3881908d452692d46871c4d29b3.png" width="1555" height="317" class="img_ev3q"></p><p><img loading="lazy" alt="1597643504380" src="/Computer-Science-Learn-Notes/assets/images/1597643504380-bee74d499bac4ad71619ee060a8f7cb4.png" width="1303" height="236" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="服务端配置">服务端配置<a class="hash-link" href="#服务端配置" title="标题的直接链接">​</a></h3><blockquote><p>首先在github上新建一个仓库 springcloud-config</p><p>然后使用git命令克隆到本地，命令：git clone <a href="https://github.com/LZXYF/springcloud-config" target="_blank" rel="noopener noreferrer">https://github.com/LZXYF/springcloud-config</a></p><p>注意上面的操作不是必须的，只要github上有就可以，克隆到本地只是修改文件。</p></blockquote><p>新建 cloud-config-center3344 模块：</p><p>pom文件：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- config Server --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-config-server</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--eureka-client config Server也要注册进服务中心--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-eureka-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>yml 配置：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">3344spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cloud</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">center  </span><span class="token comment" style="color:#999988;font-style:italic"># 注册进eureka Server 的微服务名  cloud:    config:      server:        git:          uri: https://github.com/LZXYF/springcloud-config # github 仓库位置          ## 搜索目录          search-paths:            - springcloud-config          # 读取的分支          label: mastereureka:  client:    service-url:      defaultZone: http://eureka7001.com:7001/eureka/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootApplication@EnableConfigServer   //关键注解public class ConfigCenterMain3344 {    public static void main(String[] args) {        SpringApplication.run(ConfigCenterMain3344.class,args);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>添加模拟映射：【C:\Windows\System32\drivers\etc\hosts】文件中添加：  127.0.0.1 config-3344.com</p><p>启动微服务3344，访问<a href="http://config-3344.com:3344/master/config-dev.yml" target="_blank" rel="noopener noreferrer">http://config-3344.com:3344/master/config-dev.yml</a> 文件（注意，要提前在git上弄一个这文件）</p><p>文件命名和访问的规则：</p><p><img loading="lazy" alt="1597646186970" src="/Computer-Science-Learn-Notes/assets/images/1597646186970-0045a1afed8a770fde2e7fefaf72f9fa.png" width="1549" height="313" class="img_ev3q"></p><p>不加分支名默认是master:</p><p><img loading="lazy" alt="1597646308915" src="/Computer-Science-Learn-Notes/assets/images/1597646308915-f5c7602a8a084f8c8ea91072ad50b737.png" width="1262" height="328" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="客户端配置">客户端配置<a class="hash-link" href="#客户端配置" title="标题的直接链接">​</a></h3><blockquote><p>这里的客户端指的是，使用 Config Server 统一配置文件的项目。既有之前说的消费者，又有提供者</p></blockquote><p>新建 cloud-config-client-3355 模块：</p><p>pom文件：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- config Client 和 服务端的依赖不一样 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-config</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--eureka-client config Server也要注册进服务中心--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-eureka-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>**** bootstrap.yml文件</p><p><img loading="lazy" alt="1597646809831" src="/Computer-Science-Learn-Notes/assets/images/1597646809831-45720dbb41187a86b393ace20071e19a.png" width="1550" height="466" class="img_ev3q"></p><p>内容：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">3355spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">config-client  cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># config 客户端配置    config:      label: master # 分支名称      name: config # 配置文件名称，文件也可以是client-config-dev.yml这种格式的，这里就写 client-config       profile: dev # 使用配置环境      uri: http://config-3344.com:3344  # config Server 地址      # 综合上面四个 即读取配置文件地址为： http://config-3344.com:3344/master/config-dev.ymleureka:  client:    service-url:      defaultZone: http://eureka7001.com:7001/eureka/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类，极其普通：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootApplication@EnableEurekaClientpublic class ConfigClientMain3355     public static void main(String[] args) {        SpringApplication.run(ConfigClientMain3355.class, args);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>controller层，测试读取配置信息</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.springcloud.controller;import org.springframework.beans.factory.annotation.Value;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RestController;@RestControllerpublic class ConfigClientController {    @Value(&quot;${config.info}&quot;)    private String configInfo;    @GetMapping(&quot;/configInfo&quot;)    public String getConfigInfo(){        return configInfo;    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>启动测试完成！如果报错，注意github上的 yml 格式有没有写错！</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="动态刷新">动态刷新<a class="hash-link" href="#动态刷新" title="标题的直接链接">​</a></h3><p>问题：</p><p><img loading="lazy" alt="1597649646383" src="/Computer-Science-Learn-Notes/assets/images/1597649646383-b63ce3bf1fb0d83a4627b70ea6ccb65f.png" width="692" height="256" class="img_ev3q"></p><blockquote><p>就是github上面配置更新了，config Server 项目上是动态更新的，但是，client端的项目中的配置，目前还是之前的，它不能动态更新，必须重启才行。</p></blockquote><p>解决：</p><ol><li><p>client端一定要有如下依赖：</p><p><img loading="lazy" alt="1597649915331" src="/Computer-Science-Learn-Notes/assets/images/1597649915331-894006afb767fdf6d92b4d7c4baf1c6e.png" width="656" height="187" class="img_ev3q"></p></li><li><p>client 端增加 yml 配置如下，即在 bootstrap.yml 文件中：</p></li></ol><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 暴露监控端点management:  endpoints:    web:      exposure:        include: &quot;*&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>在controller 上添加如下注解：</li></ol><p><img loading="lazy" alt="1597650236798" src="data:image/png;base64,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NqP7Su3MnvOYIXeBhtFtCvSVefMin/DWOc49p/T84UL9a6Ven0ILjkx0Dn7iLx7PtvzFGSZx/bOOH1vDbfFPsThUfHGM4vEEc//4ib/ovWa7eX6cqTqlxj9S1s/9MJn7ByZ3P5R6vlNlGzeyMboj7//ceCokCU99+oyIjBl5wF2UXikoVytZJLoAAAGaSURBVLjlXjaE2s+4QS4iQRpdeOfhR0v+TeEKaI7O77MVkakx5i16exN5TafgNZ/eel0kPW1DRMplpMn8mjv/k6+1zJ94AwKsCdtYNf91xdiKWAP/72TBZQ9FZPJym+4AhlLdHPjlDl6ukPnAImezQJujRUREzmYV0BwtIiJydlISFhERCYiSsIiISECUhEVERAKiJCwiIhIQJWEREZGAKAmLiIgERElYREQkIErCIiIiAVESFhERCYiSsIiISECUhEVERAKiJCwiIhIQJWEREZGAKAmLiIgERElYREQkIErCIiIiAVESFhERCYiSsIiISECUhEVERAKiJCwiIhIQJWEREZGAKAmLiIgERElYREQkIErCIiIiAVESFhERCYiSsIiISECUhEVERAKiJCwiIhIQJWEREZGAKAmLiIgERElYREQkIErCIiIiAVESFhERCYiSsIiISECUhEVERAKiJCwiIhIQJWEREZGAKAmLiIgERElYREQkIErCIiIiAVESFhERCYiSsIiISECUhEVERAKiJCwiIhKQ/w8kdInseMdW7wAAAABJRU5ErkJggg==" width="481" height="151" class="img_ev3q"></p><blockquote><p>到此为止，配置已经完成，但是测试仍然不能动态刷新，需要下一步。</p></blockquote><ol start="4"><li>向 client 端发送一个 POST 请求</li></ol><blockquote><p>如 curl -X POST &quot;http://localhost:3355/actuator/refresh&quot;</p><p>两个必须：1.必须是 POST 请求，2.请求地址：http://localhost:3355/actuator/refresh</p></blockquote><p>成功！</p><p>但是又有一个问题，就是要向每个微服务发送一次POST请求，当微服务数量庞大，又是一个新的问题。</p><p>就有下面的消息总线！</p><h1>消息总线</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bus">Bus<a class="hash-link" href="#bus" title="标题的直接链接">​</a></h2><p><img loading="lazy" alt="1597651086179" src="/Computer-Science-Learn-Notes/assets/images/1597651086179-b60d25cb0419b875014074d13656a4a6.png" width="1206" height="579" class="img_ev3q"></p><p><img loading="lazy" alt="1597651183100" src="/Computer-Science-Learn-Notes/assets/images/1597651183100-9f4b0aee2f1f3eec7afe74f4f82ec041.png" width="1548" height="240" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="安装rabbitmq">安装RabbitMQ<a class="hash-link" href="#安装rabbitmq" title="标题的直接链接">​</a></h3><blockquote><p>在windows 上安装RabbitMQ</p></blockquote><ol><li>安装RabbitMQ的依赖环境 Erlang  下载地址： <a href="http://erlang.org/download/otp_win64_21.3.exe" target="_blank" rel="noopener noreferrer">http://erlang.org/download/otp_win64_21.3.exe</a></li><li>安装RabbitMQ   下载地址： <a href="http://dl.bintray.com/rabbitmq/all/rabbitmq-server/3.7.14/rabbitmq-server-3.7.14.exe" target="_blank" rel="noopener noreferrer">http://dl.bintray.com/rabbitmq/all/rabbitmq-server/3.7.14/rabbitmq-server-3.7.14.exe</a></li><li>进入 rabbitMQ安装目录的sbin目录下，打开cmd窗口，执行 【rabbitmq-plugins enable rabbitmq_management】</li><li>访问【http://localhost:15672/】，输入密码和账号：默认都为 guest</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="广播式刷新配置">广播式刷新配置<a class="hash-link" href="#广播式刷新配置" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="1597723463350" src="/Computer-Science-Learn-Notes/assets/images/1597723463350-337dab29f10a67ce28b3881ae79cf28d.png" width="901" height="605" class="img_ev3q"></p><p>还是按照之前的 3344（config Server）和  3355（config client）两个项目来增进。</p><p>首先给 config Server 和 config client 都添加如下依赖：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 添加rabbitMQ的消息总线支持包 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-bus-amqp</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>config Server 的yml文件增加如下配置：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># rabbitMq的相关配置rabbitmq:  host: localhost  port: 5672  # 这里没错，虽然rabbitMQ网页是 15672  username: guest  password: guest# rabbitmq 的相关配置2 暴露bus刷新配置的端点management:  endpoints:    web:      exposure:        include: &#x27;bus-refresh&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>config Client 的yml文件修改成如下配置：（注意对齐方式，和config Server不一样）</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">config-client  cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># config 客户端配置    config:      label: master         # 分支名称      name: client-config       # 配置文件名称      profile: test      # 使用配置环境      uri: http://config-3344.com:3344  # config Server 地址  # 综合上面四个 即读取配置文件地址为： http://config-3344.com:3344/master/config-dev.yml  # rabbitMq的相关配置  rabbitmq:    host: localhost    port: 5672    username: guest    password: guest</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可在github上修改yml文件进行测试，修改完文件，向 config server 发送 请求：</p><p>【curl -X POST &quot;http://localhost:3344/actuator/bus-refresh&quot;】</p><blockquote><p>注意，之前是向config client 一个个发送请求，但是这次是向 config Server 发送请求，而所有的config client 的配置也都全部更新。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="定点通知">定点通知<a class="hash-link" href="#定点通知" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="1597725204568" src="/Computer-Science-Learn-Notes/assets/images/1597725204568-f085cc7d2a806cb9b1349f0927a88682.png" width="1389" height="265" class="img_ev3q"></p><p><img loading="lazy" alt="1597725365978" src="/Computer-Science-Learn-Notes/assets/images/1597725365978-aa984f278441557e1999261014b51381.png" width="1276" height="220" class="img_ev3q"></p><h1>消息驱动</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stream">Stream<a class="hash-link" href="#stream" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="概述-3">概述<a class="hash-link" href="#概述-3" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="1597725567239" src="/Computer-Science-Learn-Notes/assets/images/1597725567239-94ceaca3214f3754c8e5f1476bc22f33.png" width="1512" height="580" class="img_ev3q"></p><p><img loading="lazy" alt="1597725597884" src="/Computer-Science-Learn-Notes/assets/images/1597725597884-d9dab19dc088b08d34951d2a9d7d26a9.png" width="923" height="73" class="img_ev3q"></p><blockquote><p>就像 JDBC 形成一种规范，统一不同数据库的接口</p></blockquote><p><img loading="lazy" alt="1597725703365" src="/Computer-Science-Learn-Notes/assets/images/1597725703365-f71b2690476c97b76c29320cdb8f1698.png" width="1446" height="442" class="img_ev3q"></p><p><img loading="lazy" alt="1597726446212" src="/Computer-Science-Learn-Notes/assets/images/1597726446212-7bcf6f9af901f360f53d2e1d4529abff.png" width="1494" height="612" class="img_ev3q"></p><p><img loading="lazy" alt="1597730581088" src="/Computer-Science-Learn-Notes/assets/images/1597730581088-0d56c013d82b6896400e84b46ffcb9cd.png" width="851" height="597" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="消息生产者">消息生产者<a class="hash-link" href="#消息生产者" title="标题的直接链接">​</a></h3><p>新建模块 cloud-stream-rabbitmq-provider8801</p><p>pom依赖：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- stream-rabbit --&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-stream-rabbit</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--eureka-client 目前，这个不是必须的--&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-netflix-eureka-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>yml 配置：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">8801spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cloud-stream-provider  cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">stream</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">binders</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 在次配置要绑定的rabbitMQ的服务信息        defaultRabbit: # 表示定义的名称，用于和binding整合          type: rabbit  # 消息组件类型          environment:  # 设置rabbitmq的相关环境配置            spring:              rabbitmq:                host: localhost                port: 5672                username: guest                password: guest      bindings:  # 服务的整合处理        output:   # 表示是生产者，向rabbitMQ发送消息          destination: studyExchange  # 表示要使用的Exchange名称          content-type: application/json  # 设置消息类型，本次是json，文本是 &quot;text/plain&quot;          binder: defaultRabbit  # 设置要绑定的消息服务的具体配置eureka:  client:    service-url:      defaultZone: http://eureka7001.com:7001/eureka/  instance:    lease-renewal-interval-in-seconds: 2 # 设置心跳时间，默认是30秒    lease-expiration-duration-in-seconds: 5 # 最大心跳间隔不能超过5秒,默认90秒    instance-id: send-8801.com # 在信息列表显示主机名称    prefer-ip-address: true # 访问路径变为ip地址</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类没什么特殊的注解。</p><p>业务类：（此业务类不是以前的service，而实负责推送消息的服务类）</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.springcloud.service;import org.springframework.cloud.stream.annotation.EnableBinding;import org.springframework.cloud.stream.messaging.Source;import org.springframework.messaging.MessageChannel;import org.springframework.messaging.support.MessageBuilder;import javax.annotation.Resource;import java.util.UUID;@EnableBinding(Source.class)  // 不是和controller打交道的service,而是发送消息的推送服务类public class IMessageProviderImpl implements IMessageProvider {                                       //上面是自定义的接口    @Resource    private MessageChannel output;    @Override    public String send() {        String serial = UUID.randomUUID().toString();        output.send(MessageBuilder.withPayload(serial).build());        System.out.println(&quot;******serial: &quot; + serial);        return null;    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>controller:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@RestControllerpublic class SendMessageController {    @Resource    private IMessageProvider messageProvider;    @GetMapping(&quot;/sendMessage&quot;)    public String sendMessage(){        return messageProvider.send();    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>启动Eureka Server 7001，再启动8801，进行测试，看是否rabbitMQ中有我们发送的消息。</p><p><img loading="lazy" alt="1597730112088" src="/Computer-Science-Learn-Notes/assets/images/1597730112088-7f8d8211eb485b8824e0225f08b79f2d.png" width="544" height="452" class="img_ev3q"></p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="消息消费者">消息消费者<a class="hash-link" href="#消息消费者" title="标题的直接链接">​</a></h3><p>新建模块 cloud-stream-rabbitmq-consumer8802</p><p>pom依赖和生产者一样。</p><p>yml配置: 在 stream的配置上，和生产者只有一处不同的地方，output 改成 input</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">8802spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cloud-stream-provider  cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">stream</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">binders</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 在次配置要绑定的rabbitMQ的服务信息        defaultRabbit: # 表示定义的名称，用于和binding整合          type: rabbit  # 消息组件类型          environment:  # 设置rabbitmq的相关环境配置            spring:              rabbitmq:                host: localhost                port: 5672                username: guest                password: guest      bindings:  # 服务的整合处理        input:   # 表示是消费者，这里是唯一和生产者不同的地方，向rabbitMQ发送消息          destination: studyExchange  # 表示要使用的Exchange名称          content-type: application/json  # 设置消息类型，本次是json，文本是 &quot;text/plain&quot;          binder: defaultRabbit  # 设置要绑定的消息服务的具体配置eureka:  client:    service-url:      defaultZone: http://eureka7001.com:7001/eureka/  instance:    lease-renewal-interval-in-seconds: 2 # 设置心跳时间，默认是30秒    lease-expiration-duration-in-seconds: 5 # 最大心跳间隔不能超过5秒,默认90秒    instance-id: receive-8802.com # 在信息列表显示主机名称    prefer-ip-address: true # 访问路径变为ip地址</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>接收消息的业务类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.beans.factory.annotation.Value;import org.springframework.cloud.stream.annotation.EnableBinding;import org.springframework.cloud.stream.annotation.StreamListener;import org.springframework.cloud.stream.messaging.Sink;import org.springframework.messaging.Message;import org.springframework.stereotype.Component;@Component@EnableBinding(Sink.class)public class ConsumerController {    @Value(&quot;${server.port}&quot;)    private String serverPort;    @StreamListener(Sink.INPUT)    public void input(Message&lt;String&gt; message){        System.out.println(&quot;消费者1号，serverport: &quot; + serverPort + &quot;，接受到的消息：&quot; + message.getPayload());    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置分组消费">配置分组消费<a class="hash-link" href="#配置分组消费" title="标题的直接链接">​</a></h3><p>新建 cloud-stream-rabbitmq-consumer8802 模块：</p><blockquote><p>8803 就是 8802 clone出来的。</p></blockquote><p>当运行时，会有两个问题。</p><p>第一个问题，两个消费者都接收到了消息，这属于重复消费。例如，消费者进行订单创建，这样就创建了两份订单，会造成系统错误。</p><p><img loading="lazy" alt="1597731525531" src="/Computer-Science-Learn-Notes/assets/images/1597731525531-1ee742b9a3934834ff7d1ec0f4dd4cd5.png" width="1170" height="168" class="img_ev3q"></p><blockquote><p>Stream默认不同的微服务是不同的组</p></blockquote><p><img loading="lazy" alt="1597731630685" src="/Computer-Science-Learn-Notes/assets/images/1597731630685-6b7bb7b08afd2cd9f45b01c550a60397.png" width="1048" height="478" class="img_ev3q"></p><p>对于重复消费这种问题，导致的原因是默认每个微服务是不同的group，组流水号不一样，所以被认为是不同组，两个都可以消费。</p><p>解决的办法就是自定义配置分组：</p><p>消费者 yml 文件配置：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 8802 的消费者 bindings:        input:             destination: studyExchange            content-type: application/json            binder: defaultRabbit            group: dkfA  # 自定义分组配置    # 8803 的消费者  bindings:        input:             destination: studyExchange            content-type: application/json            binder: defaultRabbit            group: dkfB  # 自定义分组配置</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="1597732035990" src="/Computer-Science-Learn-Notes/assets/images/1597732035990-984ec98650516fa4e11cd24bdcec7426.png" width="584" height="536" class="img_ev3q"></p><p>当两个消费者配置的 group 都为 dkfA 时，就属于同一组，就不会被重复消费。</p><p><img loading="lazy" alt="1597732238270" src="/Computer-Science-Learn-Notes/assets/images/1597732238270-3ed688cda4538375f4d5208110a6428b.png" width="893" height="727" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="消息持久化">消息持久化<a class="hash-link" href="#消息持久化" title="标题的直接链接">​</a></h3><blockquote><p>加上group配置，就已经实现了消息的持久化。</p></blockquote><h1>Sleuth</h1><blockquote><p>分布式请求链路跟踪，超大型系统。需要在微服务模块极其多的情况下，比如80调用8001的，8001调用8002的，这样就形成了一个链路，如果链路中某环节出现了故障，我们可以使用Sleuth进行链路跟踪，从而找到出现故障的环节。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="概述-4">概述<a class="hash-link" href="#概述-4" title="标题的直接链接">​</a></h2><p><img loading="lazy" alt="1597732562780" src="/Computer-Science-Learn-Notes/assets/images/1597732562780-04857b546a005b80bafd945e48c35c0f.png" width="1522" height="596" class="img_ev3q"></p><blockquote><p>sleuth 负责跟踪，而zipkin负责展示。</p><p>zipkin 下载地址： <a href="http://dl.bintray.com/openzipkin/maven/io/zipkin/java/zipkin-server/2.12.9/zipkin-server-2.12.9-exec.jar" target="_blank" rel="noopener noreferrer">http://dl.bintray.com/openzipkin/maven/io/zipkin/java/zipkin-server/2.12.9/zipkin-server-2.12.9-exec.jar</a></p><p>使用 【java -jar】 命令运行下载的jar包，访问地址：【 http://localhost:9411/zipkin/ 】</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="案例-1">案例<a class="hash-link" href="#案例-1" title="标题的直接链接">​</a></h2><blockquote><p>使用之前的 提供者8001 和 消费者80</p></blockquote><p>分别给他们引入依赖：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入sleuth + zipkin --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-zipkin</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>yml增加配置：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">zipkin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">base-url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//localhost</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9411</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># zipkin 地址  sleuth:    sampler:      # 采样率值 介于0-1之间 ，1表示全部采集      probability: 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>高级部分</h1><h1>SpringCloud Alibaba</h1><blockquote><p>alibaba 的 github上有中文文档</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="大简介">大简介<a class="hash-link" href="#大简介" title="标题的直接链接">​</a></h2><p><img loading="lazy" alt="1597735215211" src="/Computer-Science-Learn-Notes/assets/images/1597735215211-5ca6d12bda21c7e1aa9b32c19cac4d9f.png" width="1546" height="311" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nacos">Nacos<a class="hash-link" href="#nacos" title="标题的直接链接">​</a></h2><blockquote><p>Nacos = Eureka + Config + Bus</p></blockquote><blockquote><p>github地址：  <a href="https://github.com/alibaba/Nacos" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/Nacos</a></p><p>Nacos 地址：  <a href="https://nacos.io/zh-cn/" target="_blank" rel="noopener noreferrer">https://nacos.io/zh-cn/</a></p></blockquote><p><img loading="lazy" alt="1597755893534" src="/Computer-Science-Learn-Notes/assets/images/1597755893534-5f584f7d5eea90a738f4d832b0a3d14c.png" width="859" height="335" class="img_ev3q"></p><blockquote><p>nacos可以切换 AP 和 CP ,可使用如下命令切换成CP模式：</p><p><img loading="lazy" alt="1597756097369" src="/Computer-Science-Learn-Notes/assets/images/1597756097369-2228efc9a6cb3ac146650286227e35c2.png" width="957" height="90" class="img_ev3q"></p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="下载">下载<a class="hash-link" href="#下载" title="标题的直接链接">​</a></h3><blockquote><p>下载地址：  <a href="https://github.com/alibaba/nacos/releases/tag/1.1.4" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/nacos/releases/tag/1.1.4</a></p><p>直接下载网址： <a href="https://github.com/alibaba/nacos/releases/download/1.1.4/nacos-server-1.1.4.zip" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/nacos/releases/download/1.1.4/nacos-server-1.1.4.zip</a></p><p>下载压缩包以后解压，进入bin目录，打开dos窗口，执行startup命令启动它。</p><p>可访问 ： 【 <a href="http://192.168.101.105:8848/nacos/index.html%E3%80%91%E5%9C%B0%E5%9D%80%EF%BC%8C%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E9%83%BD%E6%98%AFnacos" target="_blank" rel="noopener noreferrer">http://192.168.101.105:8848/nacos/index.html】地址，默认账号密码都是nacos</a></p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="服务中心">服务中心<a class="hash-link" href="#服务中心" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="提供者-4">提供者<a class="hash-link" href="#提供者-4" title="标题的直接链接">​</a></h4><p>新建模块 cloudalibaba-provider-payment9001</p><p>pom依赖：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springcloud alibaba nacos 依赖 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-nacos-discovery</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springboot整合Web组件 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 日常通用jar包 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>yml 配置：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">9001spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">nacos-provider  cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nacos</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">discovery</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">server-addr</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">localhost:8848management</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">endpoints</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">web</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">exposure</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">include</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;*&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类没有特殊的注解。</p><p>Nacos 自带负载均衡机制，下面创建第二个提供者。</p><p>新建 cloudalibaba-provider-payment9003 提供者模块，clone 9001 就可以</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="消费者-4">消费者<a class="hash-link" href="#消费者-4" title="标题的直接链接">​</a></h4><p>新建消费者 模块： cloudalibaba-customer-order80</p><p>pom依赖和主启动类没有好说的，和提供者一致，yml依赖也是类似配置，作为消费者注册进nacos服务中心。</p><p>nacos底层也是ribbon，注入ReatTemplate</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Configurationpublic class ApplicationContextConfig {    @Bean    @LoadBalanced    public RestTemplate getRestTemplate(){        return new RestTemplate();    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>controller :</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@RestControllerpublic class OrderController {    //在yml里面写的提供者服务路径，  值为：http://nacos-provider    @Value(&quot;${service-url.nacos-user-service}&quot;)    private String nacos_user_service;    @Resource    private RestTemplate restTemplate;    @GetMapping(&quot;customer/nacos/{id}&quot;)    public String orderId(@PathVariable(&quot;id&quot;)Integer id){        return restTemplate.getForObject(nacos_user_service + &quot;/payment/nacos/&quot; + id, String.class);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置中心">配置中心<a class="hash-link" href="#配置中心" title="标题的直接链接">​</a></h3><blockquote><p>nacos 还可以作为服务配置中心，下面是案例，创建一个模块，从nacos上读取配置信息。</p><p>nacos 作为配置中心，不需要像springcloud config 一样做一个Server端模块。</p></blockquote><p>新建模块 cloudalibaba-nacos-config3377</p><p>pom依赖：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 以 nacos 做服务配置中心的依赖 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-nacos-config</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springcloud alibaba nacos 依赖 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-nacos-discovery</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springboot整合Web组件 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 日常通用jar包 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类也是极其普通：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootApplication@EnableDiscoveryClientpublic class CloudAlibabaConfigMain3377 {    public static void main(String[] args) {        SpringApplication.run(CloudAlibabaConfigMain3377.class,args);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>***bootstrap.yml 配置：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">3377spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">nacos-config-client  cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nacos</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">discovery</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">server-addr</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> localhost</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">8848</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># nacos作为服务注册中心      config:        server-addr: localhost:8848 # nacos作为服务配置中心        file-extension: yaml # 指定yaml 格式的配置</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>controller 层进行读取配置测试：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@RestController@RefreshScope  //支持Nacos的动态刷新public class ConfigClientController {    @Value(&quot;${config.info}&quot;)    private String configInfo;    @GetMapping(&quot;configclient/getconfiginfo&quot;)    public String getConfigInfo(){        return configInfo;    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>下面在 Nacos 中添加配置文件，需要遵循如下规则：</p></blockquote><p><img loading="lazy" alt="1597757341383" src="/Computer-Science-Learn-Notes/assets/images/1597757341383-77633b9918f1df0fe5b2ab4c30c7427e.png" width="938" height="508" class="img_ev3q"></p><blockquote><p>从上面可以看到重要的一点，配置文件的名称第二项，spring.profiles.active 是依据当前环境的profile属性值的，也就是这个值如果是 dev，即开发环境，它就会读取 dev 的配置信息，如果是test，测试环境，它就会读取test的配置信息，就是从 spring.profile.active 值获取当前应该读取哪个环境下的配置信息。</p></blockquote><p>所以要配置spring.profiles.active，新建application.yml文件，添加如下配置：</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">profiles</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">active</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev </span><span class="token comment" style="color:#999988;font-style:italic"># 表示开发环境</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>综合以上说明，和下面的截图，Nacos 的dataid（类似文件名）应为： nacos-config-client-dev.yaml  (必须是yaml)</p><p><img loading="lazy" alt="1597757775084" src="/Computer-Science-Learn-Notes/assets/images/1597757775084-8727b136cc21f8fe63777f59c8527724.png" width="549" height="372" class="img_ev3q"></p><p><img loading="lazy" alt="1597757747480" src="data:image/png;base64,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" width="398" height="156" class="img_ev3q"></p><p><img loading="lazy" alt="1597758227367" src="/Computer-Science-Learn-Notes/assets/images/1597758227367-cfeed9335a639e7e88da54edb193dcb4.png" width="798" height="481" class="img_ev3q"></p><p>当修改配置值，会发现 3377 上也已经修改，Nacos自带自动刷新功能！</p><p>其它说明：</p><blockquote><p>Nacos 的 Group ,默认创建的配置文件，都是在DEFAULT_GROUP中，可以在创建配置文件时，给文件指定分组。</p><p>yml 配置如下，当修改开发环境时，只会从同一group中进行切换。</p><p><img loading="lazy" alt="1597807821441" src="/Computer-Science-Learn-Notes/assets/images/1597807821441-48ed6ba3254e8ea0324f9873915a71d0.png" width="1413" height="580" class="img_ev3q"></p><p>Nacos 的namespace ,默认的命名空间是public ,这个是不允许删除的，可以创建一个新的命名空间，会自动给创建的命名空间一个流水号。</p><p>在yml配置中，指定命名空间：</p><p><img loading="lazy" alt="1597808181104" src="/Computer-Science-Learn-Notes/assets/images/1597808181104-f25d90553b5193fc5771a368434dd64c.png" width="731" height="397" class="img_ev3q"></p><p>最后，dataid、group、namespace 三者关系如下：（不同的dataid，是相互独立的，不同的group是相互隔离的，不同的namespace也是相互独立的）</p><p><img loading="lazy" alt="1597808385154" src="/Computer-Science-Learn-Notes/assets/images/1597808385154-025fe44211be963b827109f9659595aa.png" width="647" height="401" class="img_ev3q"></p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacos持久化">Nacos持久化<a class="hash-link" href="#nacos持久化" title="标题的直接链接">​</a></h3><blockquote><p>上面只是小打小闹，下面才是真正的高级操作。</p></blockquote><p><img loading="lazy" alt="1597808678658" src="/Computer-Science-Learn-Notes/assets/images/1597808678658-147b3a4d9b0b174539083465a2a1623c.png" width="667" height="634" class="img_ev3q"></p><blockquote><p>搭建集群必须持久化，不然多台机器上的nacos的配置信息不同，造成系统错乱。它不同于单个springcloud config，没有集群一说，而且数据保存在github上，也不同于eureka，配置集群就完事了，没有需要保存的配置信息。</p><p>Nacos默认使用它自带的嵌入式数据库derby:</p><p><img loading="lazy" alt="1597809107487" src="/Computer-Science-Learn-Notes/assets/images/1597809107487-9a14a18a2486f3eb7a97009efa4acc0a.png" width="351" height="112" class="img_ev3q"></p></blockquote><p>Nacos持久化配置：</p><blockquote><p>在 nacos的 conf目录下，有个nacos-mysql.sql 的sql文件，创建一个名为【nacos_config】的数据库，执行里面内容，在nacos_config数据库里面创建数据表。</p><p>找到conf/application.properties 文件，尾部追加如下内容：</p><div class="language-properties codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-properties codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">spring.datasource.platform=mysqldb.num=1db.url.0=jdbc:mysql://localhost:3306/nacos_config?characterEncoding=utf-8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=truedb.user=rootdb.password=123456</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>重启nacos，即完成持久化配置。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="集群架构">集群架构<a class="hash-link" href="#集群架构" title="标题的直接链接">​</a></h3><blockquote><p>现在进行企业中真正需要的nacos集群配置，而不是上面的单机模式，需要准备如下：</p><p>一台linux虚拟机：nginx服务器，3个nacos服务，一个mysql数据库。</p><p>nginx的安装参考之前学，使用 ContOs7 至少需要安装gcc库，不然无法编译安装【yum install gcc】</p><p>nacos下载linux版本的 tar.gz 包：<a href="https://github.com/alibaba/nacos/releases/download/1.1.4/nacos-server-1.1.4.tar.gz" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/nacos/releases/download/1.1.4/nacos-server-1.1.4.tar.gz</a></p><p>mysql root用户密码为 Dkf!!2020</p></blockquote><p>Nacos集群配置</p><ol><li><p>首先对 nacos 进行持久化操作，操作如上面一致。</p></li><li><p>修改 nacos/conf 下的cluster文件，最好先复制一份，添加如下内容:</p><p><img loading="lazy" alt="1597812518508" src="data:image/png;base64,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" width="219" height="127" class="img_ev3q"></p></li><li><p>模拟三台nacos服务，编辑nacos的startup启动脚本，使他能够支持不同的端口启动多次。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">![1597812716080](./images/1597812716080.png)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="1597812799242" src="/Computer-Science-Learn-Notes/assets/images/1597812799242-06672f6110e810104ec869bdf6a2b608.png" width="1327" height="382" class="img_ev3q"></p><p><img loading="lazy" alt="1597813020494" src="/Computer-Science-Learn-Notes/assets/images/1597813020494-518e3f9e7fbf9220ad27505e867f6223.png" width="1473" height="251" class="img_ev3q"></p><p><img loading="lazy" alt="1597815675706" src="data:image/png;base64,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" width="652" height="80" class="img_ev3q"></p></li><li><p>nginx配置负载均衡：</p><p><img loading="lazy" alt="1597813917440" src="/Computer-Science-Learn-Notes/assets/images/1597813917440-6065f3b0c316ed053acf7af96f327aad.png" width="506" height="561" class="img_ev3q"></p></li><li><p>测试完成！</p></li></ol><p>使用 9003 模块注册进Nacos Server 并获取它上面配置文件的信息，进行测试。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sentinel">Sentinel<a class="hash-link" href="#sentinel" title="标题的直接链接">​</a></h2><blockquote><p>sentinel在 springcloud Alibaba 中的作用是实现熔断和限流</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="下载-1">下载<a class="hash-link" href="#下载-1" title="标题的直接链接">​</a></h3><blockquote><p>下载地址： <a href="https://github.com/alibaba/Sentinel/releases/download/1.7.1/sentinel-dashboard-1.7.1.jar" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/Sentinel/releases/download/1.7.1/sentinel-dashboard-1.7.1.jar</a></p><p>下载jar包以后，使用【java -jar】命令启动即可。</p><p>它使用 8080 端口，用户名和密码都为 ： sentinel</p></blockquote><p><img loading="lazy" alt="1597817544663" src="/Computer-Science-Learn-Notes/assets/images/1597817544663-b09342ff30dff414153c25e83dff2085.png" width="938" height="504" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="demo">Demo<a class="hash-link" href="#demo" title="标题的直接链接">​</a></h3><blockquote><p>新建模块 cloudalibaba-sentinel-service8401 ，使用nacos作为服务注册中心，来测试Sentinel的功能。</p></blockquote><p>pom依赖：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 后续做Sentinel的持久化会用到的依赖 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.csp</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">sentinel-datasource-nacos</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- sentinel  --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-sentinel</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springcloud alibaba nacos 依赖,Nacos Server 服务注册中心 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-nacos-discovery</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springboot整合Web组件 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 日常通用jar包 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>yml 配置：</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">8401spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cloudalibaba-sentinel-service  cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nacos</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">discovery</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 服务注册中心        server-addr: localhost:8848    sentinel:      transport:        # 配置 Sentinel Dashboard 的地址        dashboard: localhost:8080        # 默认8719 ，如果端口被占用，端口号会自动 +1，提供给 sentinel 的监控端口        port: 8719management:  endpoints:    web:      exposure:        include: &#x27;*&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>写一个简单的主启动类，再写一个简单的controller测试sentinel的监控。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="流控规则">流控规则<a class="hash-link" href="#流控规则" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="1597819388174" src="/Computer-Science-Learn-Notes/assets/images/1597819388174-c4cb8a79b9ad3f9d7bc80b52b2ae0489.png" width="1060" height="604" class="img_ev3q"></p><p>流控模式--直接：</p><p><img loading="lazy" alt="1597819546992" src="/Computer-Science-Learn-Notes/assets/images/1597819546992-7bc6fd875b7869852684d116537a438f.png" width="1564" height="789" class="img_ev3q"></p><blockquote><p>限流表现：当超过阀值，就会被降级。</p><p><img loading="lazy" alt="1597819613273" src="/Computer-Science-Learn-Notes/assets/images/1597819613273-d69444ac5b15e22169b794d73394e1dd.png" width="417" height="134" class="img_ev3q"></p></blockquote><p>流控模式--关联：</p><p><img loading="lazy" alt="1597819976569" src="/Computer-Science-Learn-Notes/assets/images/1597819976569-5966738daf64444088fc570bc4b1e03b.png" width="902" height="253" class="img_ev3q"></p><p><img loading="lazy" alt="1597820015308" src="/Computer-Science-Learn-Notes/assets/images/1597820015308-26d57928c5d301db290f372e62924d48.png" width="689" height="449" class="img_ev3q"></p><p>流控效果--预热：</p><p><img loading="lazy" alt="1597820393038" src="/Computer-Science-Learn-Notes/assets/images/1597820393038-7a08cb78a1636ff0f81350a725190b8f.png" width="781" height="583" class="img_ev3q"></p><p><img loading="lazy" alt="1597820534168" src="/Computer-Science-Learn-Notes/assets/images/1597820534168-07f0f888562f8b0548357d29745841fc.png" width="822" height="689" class="img_ev3q"></p><p>流控效果--排队等待：</p><p><img loading="lazy" alt="1597820662461" src="/Computer-Science-Learn-Notes/assets/images/1597820662461-9c90e8cd8f2af1fa2154a48fc125c012.png" width="894" height="599" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="熔断降级">熔断降级<a class="hash-link" href="#熔断降级" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="1597820926895" src="/Computer-Science-Learn-Notes/assets/images/1597820926895-1374d4549e608fb36e7e9b9422fa998a.png" width="1110" height="593" class="img_ev3q"></p><p><img loading="lazy" alt="1597820943934" src="/Computer-Science-Learn-Notes/assets/images/1597820943934-0b6fdae83b0da1930c98ec16bf747519.png" width="832" height="86" class="img_ev3q"></p><p><img loading="lazy" alt="1597820987861" src="/Computer-Science-Learn-Notes/assets/images/1597820987861-19c9ba38875dbde92f79fe5744e8b611.png" width="1317" height="194" class="img_ev3q"></p><p>降级策略--RT:</p><p><img loading="lazy" alt="1597821156100" src="/Computer-Science-Learn-Notes/assets/images/1597821156100-88a386d2b4d33d7535382662a861fc4b.png" width="833" height="393" class="img_ev3q"></p><p>降级策略--异常比例：</p><p><img loading="lazy" alt="1597821313361" src="/Computer-Science-Learn-Notes/assets/images/1597821313361-c71642763b230d80b0bfc2027a8a53f9.png" width="940" height="149" class="img_ev3q"></p><p>降级测录--异常数：</p><p><img loading="lazy" alt="1597821525073" src="/Computer-Science-Learn-Notes/assets/images/1597821525073-b43daf696723f4e4e29bb6f563b73a17.png" width="976" height="191" class="img_ev3q"></p><p><img loading="lazy" alt="1597821548056" src="/Computer-Science-Learn-Notes/assets/images/1597821548056-9c3dc1f4e20ace96b0d5ca6877ef36f0.png" width="881" height="462" class="img_ev3q"></p><p><img loading="lazy" alt="1597821618735" src="/Computer-Science-Learn-Notes/assets/images/1597821618735-f4dffb955b484fbe8793996671615f82.png" width="1178" height="629" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="热点key限流">热点Key限流<a class="hash-link" href="#热点key限流" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="1597821753416" src="/Computer-Science-Learn-Notes/assets/images/1597821753416-e88eb56a1d212789009abef5f926e6a6.png" width="906" height="234" class="img_ev3q"></p><p>controller层写一个demo:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    @GetMapping(&quot;/testhotkey&quot;)    @SentinelResource(value = &quot;testhotkey&quot;, blockHandler = &quot;deal_testhotkey&quot;)    //这个value是随意的值，并不和请求路径必须一致    //在填写热点限流的 资源名 这一项时，可以填 /testhotkey 或者是 @SentinelResource的value的值    public String testHotKey(            @RequestParam(value=&quot;p1&quot;, required = false) String p1,            @RequestParam(value = &quot;p2&quot;, required = false) String p2    ){        return &quot;testHotKey__success&quot;;    }    //类似Hystrix 的兜底方法    public String deal_testhotkey(String p1, String p2, BlockException e){        return &quot;testhotkey__fail&quot;;     }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="1597822501876" src="/Computer-Science-Learn-Notes/assets/images/1597822501876-0964a8295da217db99d9379e61962c8a.png" width="754" height="428" class="img_ev3q"></p><p><img loading="lazy" alt="1597822772165" src="/Computer-Science-Learn-Notes/assets/images/1597822772165-e7fd6b1d21cace2bf655ce6641042f74.png" width="684" height="405" class="img_ev3q"></p><p>说明：</p><p><img loading="lazy" alt="1597822972448" src="/Computer-Science-Learn-Notes/assets/images/1597822972448-bbf494ecd5384b0c5e4ef6f7ccc9df6e.png" width="965" height="269" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="系统规则">系统规则<a class="hash-link" href="#系统规则" title="标题的直接链接">​</a></h3><blockquote><p>一般配置在网关或者入口应用中，但是这个东西有点危险，不但值不合适，就相当于系统瘫痪。</p></blockquote><p><img loading="lazy" alt="1597900777242" src="/Computer-Science-Learn-Notes/assets/images/1597900777242-50b13bfe28997f157f4825f53409b400.png" width="927" height="234" class="img_ev3q"></p><p><img loading="lazy" alt="1597900843477" src="/Computer-Science-Learn-Notes/assets/images/1597900843477-5bcde96057cf5e52f978ceba4965467f.png" width="908" height="542" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sentinelresource配置">@SentinelResource配置<a class="hash-link" href="#sentinelresource配置" title="标题的直接链接">​</a></h3><blockquote><p>@SentinelResource 注解，主要是指定资源名（也可以用请求路径作为资源名），和指定降级处理方法的。</p></blockquote><p>例如：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.springcloud.controller;import com.alibaba.csp.sentinel.annotation.SentinelResource;import com.alibaba.csp.sentinel.slots.block.BlockException;import com.dkf.springcloud.entities.CommonResult;import com.dkf.springcloud.entities.Payment;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RestController;@RestControllerpublic class RateLimitController {    @GetMapping(&quot;/byResource&quot;)                      //处理降级的方法名    @SentinelResource(value = &quot;byResource&quot;, blockHandler = &quot;handleException&quot;)    public CommonResult byResource(){        return new CommonResult(200, &quot;按照资源名限流测试0K&quot;, new Payment(2020L,&quot;serial001&quot;));    }    //降级方法    public CommonResult handleException(BlockException e){        return new CommonResult(444, e.getClass().getCanonicalName() + &quot;\t 服务不可用&quot;);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="1597901945492" src="/Computer-Science-Learn-Notes/assets/images/1597901945492-60ca777c828cf861d64a9ddd242dcc86.png" width="1422" height="599" class="img_ev3q"></p><p>很明显，上面虽然自定义了兜底方法，但是耦合度太高，下面要解决这个问题。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="自定义全局blockhandler处理类">自定义全局BlockHandler处理类<a class="hash-link" href="#自定义全局blockhandler处理类" title="标题的直接链接">​</a></h4><p>写一个 CustomerBlockHandler 自定义限流处理类：</p><p><img loading="lazy" alt="1597903188558" src="/Computer-Science-Learn-Notes/assets/images/1597903188558-e00bb29a1a2d7790556a7a73b4bd6d0d.png" width="1170" height="522" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="整合-openfeign-服务降级">整合 openfeign 服务降级<a class="hash-link" href="#整合-openfeign-服务降级" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="前奏">前奏<a class="hash-link" href="#前奏" title="标题的直接链接">​</a></h4><blockquote><p>之前有 open-feign 和 hystrix 的整合，现在来实现sentinel 整合 ribbon + open-feign + fallback 进行服务熔断。</p><p>新建三个模块，两个提供者 9004、9005，和一个消费者 84</p><p>目的：</p><p><img loading="lazy" alt="1597905761214" src="/Computer-Science-Learn-Notes/assets/images/1597905761214-b6e92b4967f36dec51c4cfb25222740d.png" width="730" height="168" class="img_ev3q"></p><p>上面使用sentinel有一个很明显的问题，就是sentinel，对程序内部异常（各种异常，包括超时）这种捕捉，显得很乏力，它主要是针对流量控制，系统吞吐量，或者是异常比例这种，会发生降级或熔断，但是当程序内部发生异常，直接返回给用户错误页面，根本不会触发异常比例这种降级。所以才需要整合open-feign 来解决程序内部异常时，配置相应的兜底方法</p></blockquote><p>-----------------------------------------------------------两个提供者模块一致，如下：</p><p>pom依赖：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springcloud alibaba nacos 依赖 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-nacos-discovery</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springboot整合Web组件 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 日常通用jar包 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>yml配置：</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9005</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># / 9004spring:  application:    name: nacos-payment-provider  cloud:    nacos:      discovery:        server-addr: localhost:8848management:  endpoints:    web:      exposure:        include: &#x27;*&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类只是启动，没有其它注解。</p><p>controller :</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.sprIngcloud.controller;import com.dkf.springcloud.entities.CommonResult;import com.dkf.springcloud.entities.Payment;import org.springframework.beans.factory.annotation.Value;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PathVariable;import org.springframework.web.bind.annotation.RestController;import java.util.HashMap;@RestControllerpublic class PaymentController {    @Value(&quot;${server.port}&quot;)    private String serverPort;    //模拟sql查询    public static HashMap&lt;Long, Payment&gt; hashMap = new HashMap&lt;&gt;();    static {        hashMap.put(1L, new Payment(1L, &quot;xcxcxcxcxcxcxcxcxcxcxcxcxc11111111&quot;));        hashMap.put(2L, new Payment(2L, &quot;xcxcxcxcggggggggg2222222222222222&quot;));        hashMap.put(3L, new Payment(3L, &quot;xcxcxcxccxxcxcfafdgdgdsgdsgds33333&quot;));    }    @GetMapping(&quot;/payment/get/{id}&quot;)    public CommonResult paymentSql(@PathVariable(&quot;id&quot;)Long id){        Payment payment = hashMap.get(id);        CommonResult result = new CommonResult(200, &quot;from mysql, server port : &quot; + serverPort + &quot; ,查询成功&quot;, payment);        return result;    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>---------------------------------------------------------------------------------消费者：</p><p>pom依赖：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 后续做Sentinel的持久化会用到的依赖 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.csp</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">sentinel-datasource-nacos</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- sentinel  --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-sentinel</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springcloud alibaba nacos 依赖 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-nacos-discovery</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springboot整合Web组件 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 日常通用jar包 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>yml配置：</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">84spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nacos</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">discovery</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">server-addr</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">localhost:8848    sentinel</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">transport</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">dashboard</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">localhost:8080        port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">8719  application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nacos</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">order</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">consumer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类不用说了。</p><p>config类里面注入 Resttemplate：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Configurationpublic class ApplicationContextConfig {    @Bean    @LoadBalanced    public RestTemplate getRestTemplate(){        return new RestTemplate();    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>controller 层：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@RestControllerpublic class OrderController {    private static final String PAYMENT_URL=&quot;http://nacos-payment-provider&quot;;    @Resource    private RestTemplate restTemplate;    @GetMapping(&quot;/consutomer/payment/get/{id}&quot;)    public CommonResult getPayment(@PathVariable(&quot;id&quot;)Long id){        if(id &gt;= 4){            throw new IllegalArgumentException(&quot;非法参数异常...&quot;);        }else {            return restTemplate.getForObject(PAYMENT_URL + &quot;/payment/get/&quot; + id, CommonResult.class);        }    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>上面只实现了 以nacos 作为服务注册中心，消费者使用ribbon 实现负载均衡调用提供者的效果。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="正式">正式<a class="hash-link" href="#正式" title="标题的直接链接">​</a></h4><p>只配置 fallback:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    @GetMapping(&quot;/consutomer/payment/get/{id}&quot;)    @SentinelResource(value = &quot;fallback&quot;, fallback = &quot;handleFallback&quot;) //fallback只处理业务异常    public CommonResult getPayment(@PathVariable(&quot;id&quot;)Long id){        if(id &gt;= 4){            throw new IllegalArgumentException(&quot;非法参数异常...&quot;);        }else {            return restTemplate.getForObject(PAYMENT_URL + &quot;/payment/get/&quot; + id, CommonResult.class);        }    }    //兜底方法    public CommonResult handleFallback(@PathVariable(&quot;id&quot;)Long id, Throwable e){        return new CommonResult(414, &quot;---非法参数异常--&quot;, e);    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>业务异常会被 fallback 处理，返回我们自定义的提示信息，而如果给它加上流控，并触发阈值，只能返回sentinel默认的提示信息。</p></blockquote><p>只配置blockHandler:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    //@SentinelResource(value = &quot;fallback&quot;, fallback = &quot;handleFallback&quot;) //fallback只处理业务异常    @GetMapping(&quot;/consutomer/payment/get/{id}&quot;)    @SentinelResource(value = &quot;fallback&quot;, blockHandler = &quot;handleblockHandler&quot;)    public CommonResult getPayment(@PathVariable(&quot;id&quot;)Long id){        if(id &gt;= 4){            throw new IllegalArgumentException(&quot;非法参数异常...&quot;);        }else {            return restTemplate.getForObject(PAYMENT_URL + &quot;/payment/get/&quot; + id, CommonResult.class);        }    }//    //====fallback//    public CommonResult handleFallback(@PathVariable(&quot;id&quot;)Long id, Throwable e){//        return new CommonResult(414, &quot;---非法参数异常--&quot;, e);//    }    //====blockHandler                                       blockHandler的方法必须有这个参数    public CommonResult handleblockHandler(@PathVariable(&quot;id&quot;)Long id, BlockException e){        return new CommonResult(414, &quot;---非法参数异常--&quot;, e);    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>这时候的效果就是，运行异常直接报错错误页面。在sentinel上添加一个降级规则，设置2s内触发异常2次，触发阈值以后，返回的是我们自定义的 blockhanlder 方法返回的内容。</p></blockquote><p>两者都配置：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //@SentinelResource(value = &quot;fallback&quot;, fallback = &quot;handleFallback&quot;) //fallback只处理业务异常    @GetMapping(&quot;/consutomer/payment/get/{id}&quot;)    @SentinelResource(value = &quot;fallback&quot;, blockHandler = &quot;handleblockHandler&quot;, fallback = &quot;handleFallback&quot;)    public CommonResult getPayment(@PathVariable(&quot;id&quot;)Long id){        if(id &gt;= 4){            throw new IllegalArgumentException(&quot;非法参数异常...&quot;);        }else {            return restTemplate.getForObject(PAYMENT_URL + &quot;/payment/get/&quot; + id, CommonResult.class);        }    }    //====fallback    public CommonResult handleFallback(@PathVariable(&quot;id&quot;)Long id, Throwable e){        return new CommonResult(414, &quot;---非法参数异常--form fallback的提示&quot;, e);    }    //====blockHandler                                       blockHandler的方法必须有这个参数    public CommonResult handleblockHandler(@PathVariable(&quot;id&quot;)Long id, BlockException e){        return new CommonResult(414, &quot;---非法参数异常--&quot;, e);    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>明显两者都是有效的，可以同时配置。</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="全局降级">全局降级<a class="hash-link" href="#全局降级" title="标题的直接链接">​</a></h4><blockquote><p>上面是单个进行 fallback 和 blockhandler 的测试，下面是整合 openfeign 实现把降级方法解耦。和Hystrix 几乎一摸一样！</p></blockquote><p>还是使用上面 84 这个消费者做测试：</p><ol><li>先添加open-feign依赖：</li></ol><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-openfeign</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>yml 追加如下配置：</li></ol><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 激活Sentinel对Feign的支持feign:  sentinel:    enabled: true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>主启动类添加注解 ： @EnableFeignClients  激活open-feign</li><li>service :</li></ol><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@FeignClient(value = &quot;nacos-payment-provider&quot;, fallback = PaymentServiceImpl.class)public interface PaymentService {    @GetMapping(&quot;/payment/get/{id}&quot;)    public CommonResult paymentSql(@PathVariable(&quot;id&quot;)Long id);}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li>service 实现类：</li></ol><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Componentpublic class PaymentServiceImpl implements PaymentService {    @Override    public CommonResult paymentSql(Long id) {        return new CommonResult(414, &quot;open-feign 整合 sentinel 实现的全局服务降级策略&quot;,null);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="6"><li>controller 层代码没什么特殊的，和普通调用service 一样即可。</li><li>测试，关闭提供者的项目，会触发 service 实现类的方法。</li><li>总结: 这种全局熔断，是针对 “访问提供者” 这个过程的，只有访问提供者过程中发生异常才会触发降级，也就是这些降级，是给service接口上这些提供者的方法加的，以保证在远程调用时能顺利进行。而且这明显是 fallback ，而不是 blockHandler，注意区分。</li></ol><blockquote><p>fallback 和 blockHandler 肤浅的区别：</p><p>F ： 不需要指定规则，程序内部异常均可触发（超时异常需要配置超时时间）</p><p>B :  配上也没用，必须去 Sentinel 上指定规则才会被触发。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="异常忽略">异常忽略<a class="hash-link" href="#异常忽略" title="标题的直接链接">​</a></h3><blockquote><p>这是 @SentinelResource 注解的一个值：</p><p><img loading="lazy" alt="1597909285814" src="/Computer-Science-Learn-Notes/assets/images/1597909285814-6b1e3dae8c099e4abaf5398867aec3b6.png" width="1387" height="321" class="img_ev3q"></p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="持久化">持久化<a class="hash-link" href="#持久化" title="标题的直接链接">​</a></h3><blockquote><p>目前的sentinel 当重启以后，数据都会丢失，和 nacos 类似原理。需要持久化。它可以被持久化到 nacos 的数据库中。</p></blockquote><ol><li>pom依赖：</li></ol><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.csp</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">sentinel-datasource-nacos</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>yml配置：</li></ol><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sentinel</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">datasource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ds1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">nacos</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">server-addr</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">localhost:8848            dataId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">spring.application.name</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">            group</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">DEFAULT_GROUP            data-type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">json            rule-type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> flow</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>去nacos上创建一个dataid ,名字和yml配置的一致，json格式，内容如下：</li></ol><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;resource&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/testA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;limitApp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;default&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;grade&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;count&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;strategy&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;controlBehavior&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;clusterMode&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="1597913169207" src="/Computer-Science-Learn-Notes/assets/images/1597913169207-152985b227867ae6416294acd13593f2.png" width="874" height="284" class="img_ev3q"></p><ol start="4"><li>启动应用，发现存在 关于 /testA 请求路径的流控规则。</li><li>总结: 就是在 sentinel 启动的时候，去 nacos 上读取相关规则配置信息，实际上它规则的持久化，就是第三步，粘贴到nacos上保存下来，就算以后在 sentinel 上面修改了，重启应用以后也是无效的。</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="seata">Seata<a class="hash-link" href="#seata" title="标题的直接链接">​</a></h2><blockquote><p>Seate 处理分布式事务。</p><p>微服务模块，连接多个数据库，多个数据源，而数据库之间的数据一致性需要被保证。</p><p>官网：  <a href="http://seata.io/zh-cn/" target="_blank" rel="noopener noreferrer">http://seata.io/zh-cn/</a></p></blockquote><p>Seata术语： 一 + 三</p><p><img loading="lazy" alt="1597982738615" src="/Computer-Science-Learn-Notes/assets/images/1597982738615-d86ecc5ed0232623356b6ae63d7ed0f0.png" width="1563" height="260" class="img_ev3q"></p><p><img loading="lazy" alt="1597982788659" src="/Computer-Science-Learn-Notes/assets/images/1597982788659-64037c54361d6c70e11dde7bc7d7ed12.png" width="961" height="405" class="img_ev3q"></p><p><img loading="lazy" alt="1597982858545" src="/Computer-Science-Learn-Notes/assets/images/1597982858545-a22d5122285b27e5d3a84c0f68b5749b.png" width="1214" height="631" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="下载安装">下载安装<a class="hash-link" href="#下载安装" title="标题的直接链接">​</a></h3><blockquote><p>下载地址 ： <a href="https://github.com/seata/seata/releases/download/v1.0.0/seata-server-1.0.0.zip" target="_blank" rel="noopener noreferrer">https://github.com/seata/seata/releases/download/v1.0.0/seata-server-1.0.0.zip</a></p></blockquote><p><img loading="lazy" alt="1597984908755" src="/Computer-Science-Learn-Notes/assets/images/1597984908755-0e9ddeb8d82d9d118b851235532fcc58.png" width="1005" height="633" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="初始化操作">初始化操作<a class="hash-link" href="#初始化操作" title="标题的直接链接">​</a></h3><ol><li>修改 conf/file.conf 文件：</li></ol><blockquote><p>主要修改自定义事务组名称 + 事务日志存储模式为db + 数据库连接信息</p><p><img loading="lazy" alt="1597990431346" src="/Computer-Science-Learn-Notes/assets/images/1597990431346-bc6e0bd3fc16f7e1d49e1bc3a8d9eeb2.png" width="868" height="710" class="img_ev3q"></p></blockquote><ol start="2"><li><p>创建名和 file.conf 指定一致的数据库。</p></li><li><p>在新建的数据库里面创建数据表，db_store.sql文件在 conf 目录下（1.0.0有坑，没有sql文件，下载0.9.0的，使用它的sql文件即可）</p></li><li><p>修改 conf/registry.conf 文件内容：</p><p><img loading="lazy" alt="1597986227251" src="/Computer-Science-Learn-Notes/assets/images/1597986227251-3097c22d911bf2573028363ebf59137a.png" width="495" height="296" class="img_ev3q"></p></li><li><p>先启动 nacos Server 服务，再启动seata Server 。</p></li><li><p>启动 Seata Server 报错，在bin目录创建 /logs/seata_gc.log 文件。再次双击 bat文件启动。</p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="案例-2">案例<a class="hash-link" href="#案例-2" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据库准备">数据库准备<a class="hash-link" href="#数据库准备" title="标题的直接链接">​</a></h4><p><img loading="lazy" alt="1597987564813" src="/Computer-Science-Learn-Notes/assets/images/1597987564813-c6c0b615559b69c1280e0d2660e0c66b.png" width="1031" height="303" class="img_ev3q"></p><p>创建三个数据库： <img loading="lazy" alt="1597987722338" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKcAAAA8CAYAAAADt6psAAAX10lEQVR4nO2de3Bbd7XvP9LWY0tbsmz5ITmOnbbYSW7J6e1cx86UtHFeJ82DA8NwYfIASs/9A+ZOaZoHzJAGmAnlMUPSNG0JJyGnPIY8OIfpISlJWwIMJJy0xEmBywGOHZo0sR3b0cN6S5a0975/yNqx/JDkB5Hb+DujP/ZPWr+1fltLv/1bP63v+ulUVVW5w1BVlXQ6jSzLyLKMqqpkzdDr9doLQKfTYTAY0Ol06HS6O23qLEoIQymU6nQ6jEYjOp2OeDxOKBQiFouRSqUyRhkMGI1GTCYTFouFsrIyTCbTrHPeZdCVYuZUFIVUKoXf7ycUDpMcTAIqOp0OwWAgJcsoSsYsnZKZWevq6igvL8doNN5pc2dRIpRk5kylUvh8Pjw+H3I6jSiKSJKEKIroBQOhaJRwNEY0FiMRixLy+4hEIrzvfe+jtra2FCbPogQoiXPGYnFudHWDICBZLZhFEZPJhMFgIC3LKLLMYDJJLJlCFkwYzBZ+/4c/oqrqrHPeRSiJcyZTSXwDA5glCb1eh16nQ9DrEQwG9DodFrOZMklGr9eTSKYIGU0MBAKEw+FSmDuLEiGvc169eo0bN24QDAbydlJdXcO9991LrdtdlNJ0KkUoGEBSVUSTEavVCoKAig50YDQaKbNJCIJAyufH09sDqorJZCp+ZLN41yOvc3Z1dRFPxHEXcLrevj7sdlvRzqkoCvF4nHAkSiwaIRGPU1HhxGK1YjYZMegFZDlNPBIm6POiymlQFUoQu42Jo0ePMmfOHFasWFFqU0qOjo4OTp06xWc/+1nsdvu09p3XOUOhIFVVVSxevFhr+39/vYHdJnJvfY3Wdvr0aWKx2IQUq4pCOBQkGgkTCgax2W9hMpuxWSUcdjsGg0AsFiMeiyIIQkZmhjjnj3/8Y5qbm2edE+js7OS5555jy5Ytd9Y5x8Lh47/k/qa5/N9P/uOUFOv1eixWiXgsitfjoe/mTWRZxmaz0VBfj9PpxGgyIdnL8Pv96PV6DIbizA2FQgSDwZw2h8NBWVmZdu31eonH41gsFqqqqnI+G4/H8Xq9AFRVVWGxWACQZZn+/n7i8TjBYJCuri4EQcDlcmk/oPFki0Eh2azNQF69xY53eFtFRQX9/f3IsozD4cBoNOb0B4y6V6FQCK/XiyzL3Bz6/kbqnQr0xXxIUVXtla9tIpCHZk69Xs/c+nr+V+sS2lb/I20rVnL/okXUuFzodTqCfh8WqxVZlrVN+kI4fPgwLS0tOa/Dhw/nfGb79u20tLSwffv2UfLnz5/X5M6fP6+1ezwe1q1bx/nz5zUd69atw+PxFJQtBoVkszYX0lvseIe3ZceWlR3Z31j36vDhw5rs+vXrx9Q7FRScilTgyjU/Pz79FwA8AQuX/xzhmRd/i00y8X8+/uCkFOt1eqySRDKZ5Fb/LTy3bgFgk2zU1rops9tBp8dW5qCv9yZ6QSh65oxGo9xzzz18+ctf1tqampoA8Pv9bN26lYceeoiNGzfyzjvv8MlPfpIDBw7gdDo5evQoFy5c4KWXXgLg5MmTeDwetmzZQkVFBfv372fXrl00NjayefNmRFGkoqICIK9sIeSTHWnzxYsX+e53v4uiKGPK7tmzh2g0WnC8Tz75JIqiEAgEcsYWjUZ58MEH2bt3L1u3buVzn/scra2to+7Vhz/8YSKRCC+88ALPPvssTqdTu8/TgYLftpxOYzQo3FMnAdD5dgq71cw9dRIWswElndRu0kSgDP2/rgPMoohZNCMYDNgkCZvNhslsJpVKkU4l0QsCqqoWrWfFihXodDrefPNNALZs2aLdtEQiwa9+9StSqRR9fX10dnZy/vx5EokEAPX19bhcLk327Nmz1NRk1tdms5mVK1dSU1NDU1MT69evz9GbT7YQ8slmbf74xz/O+vXraWpqory8XFvj/e1vf6Orq0uzJxwOa/vBI2VfeeUVvva1r5FIJFi8eDFNTU1cvnw5Z2wANTU1rFy5ElEUaW5uHiULmR98c3MzoiiycuVK5syZU9RYi0VB50ylUpTb9Hxw+TwA/vPiJerdDu1aVZLIsjwhpSqZiF2WZQS9HpPZhDTkkDarhMVixWAQMs6ZTmeSQIYlhxTCsmXLsFgsfP3rXwcyX7SqqixcuFD7zPXr1xkcHATg0UcfRRRFIPOlOJ1OfvnLXwJMaG/1Tsna7XYWLlw47l+58+bNo7y8vGjdMxWFZ05ZZnAwqV3bJDNmo5DTNuGZU1UBFavFSjwew+vx0Du0oLZLNhoabgdEtkkGRLW1tbzwwgsAPP744/h8Pr7yla8gCAK1tbVs3bqVhx9+GMgEFw6HA4AzZ87Q3t6eI5td+I8MBrq7uxEEgZqaGgRBKFp2LOSTzdocjUbp7u7mt7/9LXv37uX06dOIoojdbkeSJLq7uwE4cOAALS0tLFy4cJRsNBqltrZWC6RGymYTcbq7u7UAyefzEQqFgIw/9Pb24nQ6tR90tk1RFMrKyqYtIJpwtP7ZzW0YhKLiqHGhkgmIQuEQZpOJufX1OKuqsUoSNosFi2hGkWWCgQCBoYAoLcskk8mCfUNmob53717tOhAIaI5YXV3Nq6++yhNPPMFTTz0FgMvl4vXXX8ftdvOZz3yGuXPnattngUCAN954A4/Hww9/+EOtz0OHDnH06NFJyY6FfLLf//73c2xua2vj1VdfpbKyckzZ559/ng0bNow53kKyWb1Hjx5FURR8Ph/btm3D6/WyYMECLXD60Y9+xJo1a4DbgaJer2fnzp3s3LmzqO+pEPJmJb3x5pv09PSgFHhsGwwG7r///pzHZj5cvXqVk6+8gl4wkE6nUBWVbDbcyIAoFo/T13uTmz09PPTQQ6xatapg/1euXOHKlSs5bU1NTTmL9UuXLnFrKAgTRZGlS5diNpsBuHXrFpcuXcqRr6mp0b7AqcjmQ7F6x+pvuOzixYtHrXWLlR0PTU1NOByOUTpGyo68z1NBXufs6+/H6/EU3GAvK3PgcrmoqChundPR0cGx48cxmkyYzWYsFuvtgMgqUVXpRDSLpNIpAoEgfb03MZlMNDc388ADD0xshDMAHR0dHDt2bNz3N2/ezIIFC+6gRe8O5H2su10u3C7XtCvV6XToAE9/P1ZJorI6s61ktUrY7HaMJhOKqhCLxYiEQzgcDu67775pjwbvFEKhEH/84x/Hff+DH/zgHbTm3YOSJBv39fXxm9/8hsuXLxMIBNDr9YiiiNlsxul0Ultbi8ViQVVVBEFg4cKFzJs3D5vNdqdNnUUJURLnlIeCm2QyqW0PZTlCOp0OQRByKBkGg0HjEc3i7kFJnBMySRyRSISBgQGNP6QoiuacgiBoJLeKigocDsdsytxdhpI4ZzqdJhwOMzAwQDAUQpZlDEMOmeUQybKCLKdJJhKoikJVVRVut/s9sbk8i+JQkkz4RCJBX18/sXic7Ga8ZBvNIUrEZBKygq+/j+7ubhYtWjTrnHcRprabPkkMDg7Sf8tDSlEwiSJmy20OkaJkOESJ5CDRZIqUYMJiK6PzSub/41mMD1mW6evro6en5z1BaSmJc6ZlmUgsSiQeJ55IkEgkGBxMIiuKxiFySBLlNgnJbEJvNCIP/Rc/i/Hh9XpZu3Ytixcv5tChQ6U2Z8ooyCHq6roxKnF3JKqqq7nv3nsL0jmySA1xiBQYxiHSD+MQGUZwiG6iY5ZDVAgOh4N9+/ZpaW/vduTnEHV3EYvFC6Z99fX3Y7fZi3ZOVVFIxONEYzHi0QiJeIIKZxKr1YrJOIJD5M9yiGYGRQPg2LFjzJkzh+XLl5falByIosiqVatw/R3+OCkF8nOIghkOUUtLi9b2p//uwm4TuWdutdaW4RAV/0vNpswFQyEi4TDBYBD7rbJMypxkpcxehkHQZzhE0SiGGcYhOnHiBM3NzTPOOd9rmHC0fujYL6bMIdKR4RBZh3GIenuGUuZsEvUNDTidTkzDUuZ0er2W5lUI4XBYS/HKoqysLIeA5fP5SCQSiKKoZehkkUgk8Pl8AFRWVuakhnk8HhKJBKFQiJ6eHgRBoLq6WrNtPNliMJbsyLZUKkUoFMqrN5sMPBxjjXd4W3l5OR6PB1mWR92rUqEkHKJsypzGIZpbT3NrK8tXr2bZylXc//5FuIY4RNmUOUVRSKfTRfX/9+IQeb1e1q1bx7lz53I4RMOJYNPNIRrZVozec+fOjeq7EIcoO7bp5gFNBcVxiN7x82+n/wqANyDy1l+ifO3b/4lNMvHPH/ufE1aqzZxDHCKP51aGrKUDuyThdrsps5eBToetrIy+3t5MVZAiZ85IJEJ9fT1f+tKXtLb58+cDGU7Ntm3baG1t5WMf+xjXr1/nscceY//+/TidTo4dO8aFCxe0LyjL5dm8eTMOh4NvfetbPP300zQ2NrJp0yZEUdQSlfPJFsJ4sqtWreKb3/wm27Zt4+mnn2bDhg0cPnw4r96vfvWrWr/5xvvEE0+QTqd5/fXXSSQSfPGLX8RqtWr3qtQoikNk0Cs01FoB6PhbGklUaai1Ik6SQ6SSWT/KQxwik9mMySxiMBiwSVYkyYbJZCKVTpFOpTMcIopfc2bXgtk8w02bNmk3PJFI8Itf/GLoR+Gho6ODc+fOaY/Curo6qqurNdmzZ89SXZ1ZX4uiyOrVq3n++eeZP3/+qGyifLKFcOXKFW7cuKH1efjwYaqrq9m8eTOrV69GFEWamppYvnw5bW1tBWWzyDfelpYW5s+fz+XLl1myZAnr1q2bEY/zLIriEFXY9fzTigxn6MKlSzTUOrTryXCIUBl6TMsIgh6T2YzdbtcCIqskYRD0GedMpxAmyCFqa2vDarXyzDPPAGgUieE5k1evXtXyVNesWaOtDd1uN5WVlZw9exag4DbacExFthhs3LhxlGMWi/HGC5mnyljLm1JjwhwiyWLCZNRPiUOkoqICVuswDlFPT25RhcpKLSDyTSIgqqur4zvf+Q4An/70p3M4RC6Xi+3bt/PII48AuRyin/3sZ7S3t+fIhsNh/H4/TqczR8fNmzcRBIGqqioEQShadizYbDasVis3b96EoXtjs9lIJBIal8fv9xMOh0fNbiNlE4mEpjffeLP9ZXVkxzFTUBIOEQwFROEQJpOJuXPrcVZVYZUkJKsVi9mMqtzmEFknUVRh37592rXf72fp0qVAZhZ97bXXePLJJ9m2bRuQ4RC99tpruFyuUZwav9+vcXl+8IMfaH0eOnSIY8eOTUp2LIyU3b9/Pxs2bOD8+fN84hOfyOHy7NixI6/scL0vvfTSuOP9whe+wMsvv0wqlWLt2rXaOGYKCnKIbg7NaPkgDHGI/keRHKK3336bl3/6U0xmcyYCV1UY+ndoZEAUi8fo6+3l7bff5uGlS1m3bl3B/js7O+ns7Mxpmz9/fs5Cv729nf7+fiCzlnz44Ye1R11/fz/t7e058i6XS9vvnYpsPgyXbWlpweVyjepv5DjGki3W5j/96U/jjmMmID+HqK8fj8dTcIO9zOHA7XJplS8K4Q9/+AMvfvvb1Nc3YJWsWCyWoYBIQJIkqpyViGLGcQOBIL03e+jq6uKRRx5h7dq1ExvhDEBnZyfHjx8f9/3hAdssbiM/h8jtwu2e/mk+Eonw17/8hcDAAHPr66mbOxerZEOy2Siz2zCbzaiqSjQSwef1kEqlaGhoKLp6xkxDIBDg8uXL475fzNPgbkRJ8jkFQcBkMmkRZGBggLKyMkRRxOl04na7sVgspFIpkskkJpOJtWvXMm/evFKYO2W0trZy6tSpUpvxrkNJMuGTySSBQABVVdEPReFZ/tDwa7i9EyCKYtEVP2bx3kBJOUSpVIpgMEgoFCKRSGQKew0dipV9mc1mysvLEUVxRm1zzOLvj5KdQzQ4OIjf7ycYDA6VmdGhF/QYBAMpJXMOkaooKHLm//S6OXNwOp1aZY1ZvPdRmtM0kkk8Hi8+vx9FkRFFC7ZhHKJwNEooGiMejxGPxfHf6icQCDC/qYmGhoZSmDyLEqBE5xDFuHHjBgZRRLJaEC2WnHOIZFkmMThIZDCFIpgQJTtvvfUWqOqsc95FKM0Jbuk0wXAYs6oOnUOkH3UOkcMmIQh6Esk0IaORWDyh1dOcxd2B/Byia9fo6uoiVASH6N577i16TzSdShEMBrABosmE1UpBDhGqMnvu5V2GvM7Z3dVFLBotWPi0v78fm81WtHMqORyiKIPxKpLOFBbrICajAYNeQJHlGcshOnHiBLW1tZPOEHq36S0V8jpncIhD1NraqrX9V0cXdsnCvLm3Hfb06dPEJsD2G8khCgWD2Dy3MJtFJKsVh92OMIM5RMeOHaO5ufmOO0mp9JYKE15z/svR6ecQeTy3uNnTTVqWsU9DylwkEhlVVMBut+dUqRsYGND4MyNzArLbXEDO9lW2BHU2Ja23txdBEKisrNRsG092KjZPVu/ItlQqRTgcnrDN2Xs1HOPpmM6tvhnBIaqbmzmHaPmq1SxbsZL7F/0DrprbHCLrHeYQnTt3bkw+TpZnk4/LM57sVGyerN6RbZO1efj5R4V0TCeK5hD9+5n/Bm5ziL5+8AJ2ycTj/3vilYaHz5zJVBKv5xY+rwfQYbNJ1Lrc2MvsmetJcIjC4TBz5sxh9+7dWls2C97v97Njxw6am5v5yEc+wo0bN3j88cfZt28fTqeT48ePc+HCBQ4ePAjAqVOn8Hq9bNq0CYfDwTe+8Q12795NY2MjGzduzOHy5JOdis2T1bty5UqeeeYZduzYwe7du1m/fj0HDx4s2uaR96q9vZ2DBw+yb98+HnjggSmNtxgUkQmf4RDV1WTy/P56JcMhqqsRsYhG5KlwiGR5GIfodtltq2TFaDSSTqcnxSFqa2tDVVV+//vfA6M5RD//+c9JJpP4fD46Ozv59a9/rT22amtrqays1GTPnj2rBYSiKLJmzRpefPFFFixYwIc+9KEcvflkp2JzIb2dnZ1cv35daz9y5AhVVVVs2rRJo2Tcd999tLW1jeLa57PZaDSyaNEifD4fPp8Pg8HArl27+OhHP4rdbqezszPn8xMZbzEo6JzpIQ7Rh1fdA8Cbb11mXq1Du54ahyiNIOgxm0VsZWWYhzhEkmRDEPQZ55wEh2j58uVYrVb27NkDZE6U0Ol0OYX0Ozs7NY7PqlWrtCTburo6ampqOHPmDJBZbxWLqcgWY/NUsHnz5jGLQOSz2Wg08uCDD/Lyyy9z/fp1WltbR2XhDwwMaEnOjY2Nd/YEt3Q6l0NkFY0YDdPEIZKsxGMxPLf66enpRk5niio0NDRMOSBqaGjgyJEjADz22GN4PB6NQ1RdXc3nP/95li1bBmRS+LKlFU+ePEl7e3uObLbI7fDAKRKJ0NfXpwUXer2+aNmJ2jzycyP1SpKExWKhr68PyBygKkkSg4ODWqGEQCBAJBIZVbo8n83JZJIdO3awa9cu7V55PJ4cvcuXL+fAgQNaf9NZGn0SHKLlGAzTxCEKZThEdfUNGQ6R1YpktWIVRVRZJhi8zSFSJsghevbZZ7Vrn8/HBz7wAeA2h+ipp57SgiGXy8WZM2c0HlB9fb3Gx/H5fLzxxht4vV6+973vaX0eOnSI48ePT0p2ojYPRzF69+3bx/r16zl37hyf+tSn8Hq9bNu2DY/HMyoAzGfzkSNHJnSvIBM8TReTsygOUaGZUS8IE+MQXb3Kf/z0pxhNJo1DlMnfHB0QZTlE71y7xtKlS3n00UcL9t/R0UFHR0dO24IFC3KowRcvXtRmGlEUWbZsWQ4P6He/+12OvNvt1vZ7pyJ7J2xesmSJxj8absvI/rIYz+bGxkYtIMrmNMRiMU6ePKlF8MXqmAzyOmdvXx9ej6dgOT2Hw4HL7cZZJIfov/78Z17613+lwlmJaBERLRbMZjOCkCmqUDVUJ2g4hyiZTLJkyRKWLFkysRHOAHR2dnLixIlx39+4ceOM5BCFw2EOHTpENBrNOSxCluU7cnZS3sd6rdtNbZFlDScCRZa1YlsVTicutxubzY5kk7Db7JhFEVVViUWjBAMDWCwWGhsbqaurm3Zb7gQCgQAXL14c9/2ZStqz2+3s3LmTPXv2aPY7nU6ee+65gjz86UBJko2vXbvGT37yEy5duoSiKEhDx1hbLBaNQ2S1Woei9TSNjY28//3vn60Hf5fh/wPDCab8Qm5NqAAAAABJRU5ErkJggg==" width="167" height="60" class="img_ev3q"></p><p>每个数据库创建数据表：</p><p>order 库：</p><p><img loading="lazy" alt="1597988061545" src="/Computer-Science-Learn-Notes/assets/images/1597988061545-a2d486d5f71b04122ae79f1a80661950.png" width="767" height="354" class="img_ev3q"></p><p>account 库：</p><p><img loading="lazy" alt="1597988768251" src="/Computer-Science-Learn-Notes/assets/images/1597988768251-d6bec79d288de9fa26e839d48b813d22.png" width="837" height="385" class="img_ev3q"></p><p>storage 库：</p><p><img loading="lazy" alt="1597988262441" src="/Computer-Science-Learn-Notes/assets/images/1597988262441-5cc977df928b2f02a7e8dea94b3d3dce.png" width="1286" height="358" class="img_ev3q"></p><p>三个数据库都创建一个回滚日志表，seata/conf/ 有相应的sql文件（1.0.0没有，依然使用0.9.0中的）。</p><p>最终效果：</p><p><img loading="lazy" alt="1597989003349" src="/Computer-Science-Learn-Notes/assets/images/1597989003349-482ff41fed79fe5bb7787a528f1a71b6.png" width="382" height="584" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="开发">开发<a class="hash-link" href="#开发" title="标题的直接链接">​</a></h4><blockquote><p>实现 下订单-&gt; 减库存 -&gt; 扣余额 -&gt; 改（订单）状态</p><p>需要注意的是，下面做了 seata 与 mybatis 的整合，所以注意一下，和以往的mybatis的使用不太一样。</p></blockquote><p>新建模块 cloudalibaba-seata-order2001 ：</p><p>pom依赖：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- seata --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-seata</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">exclusions</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">exclusion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">seata-all</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">io.seata</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">exclusion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">exclusions</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">io.seata</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">seata-all</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.0.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springcloud alibaba nacos 依赖,Nacos Server 服务注册中心 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-nacos-discovery</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- open feign 服务调用 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-openfeign</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- springboot整合Web组件 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-web</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-actuator</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 持久层支持 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">druid-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.1.10</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--mysql-connector-java--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mysql</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mysql-connector-java</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--jdbc--&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-jdbc</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- mybatis --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 日常通用jar包 --&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mybatis.spring.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mybatis-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-devtools</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">runtime</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">optional</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.dkf.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cloud-api-commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>yml配置：</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">2001spring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">seata-order-service  cloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">alibaba</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">seata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 自定义事务组，需要和当时在 seata/conf/file.conf 中的一致        tx-service-group: dkf_tx_group    nacos:      discovery:        server-addr: localhost:8848  datasource:    driver-class-name: com.mysql.jdbc.Driver    url: jdbc:mysql://localhost:3306/seata_order    username: root    password: 123456# 注意，这是自定义的，原来的是mapper_locationsmybatis:  mapperLocations: classpath:mapper/*.xmllogging:  level:    io:      seata: info</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>将 seata/conf/ 下的 file.conf 和 registry.cong 两个文件拷贝到 resource 目录下。</p><p>创建 domain 实体类 ： Order 和 CommonResult<code>&lt;T&gt;</code> 两个实体类。</p><p>dao :</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.dkf.springcloud.dao;import org.apache.ibatis.annotations.Mapper;import com.dkf.springcloud.domain.Order;import org.apache.ibatis.annotations.Param;@Mapperpublic class OrderDao {    //创建订单    public void create(Order order);    //修改订单状态    public void update(@Param(&quot;userId&quot;) Long userId, @Param(&quot;status&quot;) Integer status);}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Mapper文件：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&lt;!</span><span class="token doctype doctype-tag" style="color:#999988;font-style:italic">DOCTYPE</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype name" style="color:#999988;font-style:italic">mapper</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype name" style="color:#999988;font-style:italic">PUBLIC</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype string" style="color:#e3116c;font-style:italic">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype string" style="color:#e3116c;font-style:italic">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">mapper</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">namespace</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">com.dkf.springcloud.dao.OrderDao</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 以备后面会用到 --&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">resultMap</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">BaseResultMap</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">com.dkf.springcloud.domain.Order</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">id</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">column</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">property</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">jdbcType</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">BIGINT</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">id</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">result</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">column</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">user_id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">property</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">userId</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">jdbcType</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">BIGINT</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">result</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">result</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">column</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">product_id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">property</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">productId</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">jdbcType</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">BIGINT</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">result</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">result</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">column</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">count</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">property</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">count</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">jdbcType</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">INTEGER</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">result</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">result</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">column</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">money</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">property</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">money</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">jdbcType</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">DECIMAL</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">result</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">result</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">column</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">status</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">property</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">status</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">jdbcType</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">INTEGER</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">result</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">resultMap</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">insert</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">create</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        insert into t_order(id, user_id, product_id, count, money, status)        values (null, #{userId},#{productId},#{count},#{money},0)    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">insert</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">update</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">update</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">        update t_order set status = 1 where user_id=#{userId} and status=#{status}    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">update</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">mapper</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>创建service ：</p><blockquote><p>注意，红框标记的是通过 open-feign 远程调用微服务的service</p></blockquote><p><img loading="lazy" alt="1597992817318" src="data:image/png;base64,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" width="277" height="168" class="img_ev3q"></p><p>serviceImpl :</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Service@Slf4jpublic class OrderServiceImpl  implements OrderService {    @Resource    private OrderDao orderDao;    @Resource    private StorageService storageService;    @Resource    private AccountService accountService;    @Override    public void create(Order order) {        log.info(&quot;--------》 开始创建订单&quot;);        orderDao.create(order);        log.info(&quot;--------》 订单微服务开始调用库存，做扣减---Count-&quot;);        storageService.decrease(order.getProductId(), order.getCount());        log.info(&quot;--------》 订单微服务开始调用库存，库存扣减完成！！&quot;);        log.info(&quot;--------》 订单微服务开始调用账户，账户扣减---money-&quot;);        accountService.decrease(order.getUserId(),order.getMoney());        log.info(&quot;--------》 订单微服务开始调用账户，账户扣减完成!!&quot;);        //修改订单状态，从0到1        log.info(&quot;--------》 订单微服务修改订单状态，start&quot;);        orderDao.update(order.getUserId(),0);        log.info(&quot;--------》 订单微服务修改订单状态，end&quot;);        log.info(&quot;--订单结束--&quot;);    }    @Override    public void update(Long userId, Integer status) {    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>config （特殊点）:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//下面是两个配置类，这个是和mybatis整合需要的配置@Configuration@MapperScan({&quot;com.dkf.springcloud.alibaba.dao&quot;})public class MybatisConfig {}//这个是配置使用 seata 管理数据源，所以必须配置package com.dkf.springcloud.config;import com.alibaba.druid.pool.DruidDataSource;import io.seata.rm.datasource.DataSourceProxy;import org.apache.ibatis.session.SqlSessionFactory;import org.mybatis.spring.SqlSessionFactoryBean;import org.mybatis.spring.transaction.SpringManagedTransactionFactory;import org.springframework.beans.factory.annotation.Value;import org.springframework.boot.context.properties.ConfigurationProperties;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.core.io.support.PathMatchingResourcePatternResolver;import javax.sql.DataSource;@Configurationpublic class DataSourceProxyConfig {    @Value(&quot;${mybatis.mapperLocations}&quot;)    private String mapperLocations;    @Bean    @ConfigurationProperties(prefix = &quot;spring.datasource&quot;)    public DataSource druidDataSource(){        return new DruidDataSource();    }    @Bean    public DataSourceProxy dataSourceProxy(DataSource dataSource){        return new DataSourceProxy(dataSource);    }    @Bean    public SqlSessionFactory sqlSessionFactoryBean(DataSourceProxy dataSourceProxy) throws Exception {        SqlSessionFactoryBean sqlSessionFactoryBean = new SqlSessionFactoryBean();        sqlSessionFactoryBean.setDataSource(dataSourceProxy);        sqlSessionFactoryBean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(mapperLocations));        sqlSessionFactoryBean.setTransactionFactory(new SpringManagedTransactionFactory());        return sqlSessionFactoryBean.getObject();    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主启动类：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//这里必须排除数据源自动配置，因为写了配置类，让 seata 管理数据源@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)@EnableFeignClients@EnableDiscoveryClientpublic class SeataOrderMain2001 {    public static void main(String[] args) {        SpringApplication.run(SeataOrderMain2001.class,args);    }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>controller 层调用 orderService 方法即可。</p><p>先启动 nacos  --》 再启动 seata --&gt; 再启动此order服务，测试，可以启动。</p><p>仿照上面 创建  cloudalibaba-seata-storage2002 和  cloudalibaba-seata-account2003 两个模块，唯一大的区别就是这两个不需要导入 open-feign 远程调用其它模块。</p><p>操，累死老子啦，测试可以正常使用！</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="seata使用">Seata使用<a class="hash-link" href="#seata使用" title="标题的直接链接">​</a></h4><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    @Override   //只需要在业务类的方法上加上该注解，name值自定义唯一即可。    @GlobalTransactional(name = &quot;dkf-create-order&quot;, rollbackFor = Exception.class)    public void create(Order order) {        log.info(&quot;--------》 开始创建订单&quot;);        orderDao.create(order);        log.info(&quot;--------》 订单微服务开始调用库存，做扣减---Count-&quot;);        storageService.decrease(order.getProductId(), order.getCount());        log.info(&quot;--------》 订单微服务开始调用库存，库存扣减完成！！&quot;);        log.info(&quot;--------》 订单微服务开始调用账户，账户扣减---money-&quot;);        accountService.decrease(order.getUserId(),order.getMoney());        log.info(&quot;--------》 订单微服务开始调用账户，账户扣减完成!!&quot;);        //修改订单状态，从0到1        log.info(&quot;--------》 订单微服务修改订单状态，start&quot;);        orderDao.update(order.getUserId(),0);        log.info(&quot;--------》 订单微服务修改订单状态，end&quot;);        log.info(&quot;--订单结束--&quot;);    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="1597998982271" src="/Computer-Science-Learn-Notes/assets/images/1597998982271-24a560d21ca7a5ebe51a4449117ae347.png" width="1096" height="513" class="img_ev3q"></p><p>原理三个阶段：</p><p><img loading="lazy" alt="1597999156669" src="/Computer-Science-Learn-Notes/assets/images/1597999156669-c2472216d709f96886bcc529372a3260.png" width="890" height="502" class="img_ev3q"></p><p><img loading="lazy" alt="1597999227092" src="/Computer-Science-Learn-Notes/assets/images/1597999227092-f94ed8e7d6cad2f32722548cf3a89a17.png" width="1330" height="567" class="img_ev3q"></p><p><img loading="lazy" alt="1597999292492" src="/Computer-Science-Learn-Notes/assets/images/1597999292492-eee4718fca63a3f42d2b76cc56274e6c.png" width="1390" height="163" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes/edit/master/docs/Java/fm/SpringCloud.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vbeJ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/Computer-Science-Learn-Notes/docs/Java/fm/SpringSecurity"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">SpringSecurity</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Computer-Science-Learn-Notes/docs/Java/docker/main"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">docker</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#cloud简介" class="table-of-contents__link toc-highlight">Cloud简介</a></li><li><a href="#父工程pom配置" class="table-of-contents__link toc-highlight">父工程pom配置</a></li><li><a href="#第一个微服务架构" class="table-of-contents__link toc-highlight">第一个微服务架构</a><ul><li><a href="#提供者" class="table-of-contents__link toc-highlight">提供者</a></li><li><a href="#热部署配置" class="table-of-contents__link toc-highlight">热部署配置</a></li><li><a href="#消费者" class="table-of-contents__link toc-highlight">消费者</a></li><li><a href="#工程重构" class="table-of-contents__link toc-highlight">工程重构</a></li></ul></li><li><a href="#eureka" class="table-of-contents__link toc-highlight">Eureka</a><ul><li><a href="#概念和理论" class="table-of-contents__link toc-highlight">概念和理论</a></li><li><a href="#server模块" class="table-of-contents__link toc-highlight">Server模块</a></li><li><a href="#提供者-1" class="table-of-contents__link toc-highlight">提供者</a></li><li><a href="#消费者-1" class="table-of-contents__link toc-highlight">消费者</a></li><li><a href="#eureka-集群" class="table-of-contents__link toc-highlight">Eureka 集群</a></li><li><a href="#提供者集群" class="table-of-contents__link toc-highlight">提供者集群</a></li><li><a href="#actuator信息配置" class="table-of-contents__link toc-highlight">actuator信息配置</a></li><li><a href="#服务发现discovery" class="table-of-contents__link toc-highlight">服务发现Discovery</a></li><li><a href="#eureka-自我保护机制" class="table-of-contents__link toc-highlight">Eureka 自我保护机制</a></li></ul></li><li><a href="#zookeeper" class="table-of-contents__link toc-highlight">Zookeeper</a><ul><li><a href="#提供者-2" class="table-of-contents__link toc-highlight">提供者</a></li><li><a href="#消费者-2" class="table-of-contents__link toc-highlight">消费者</a></li></ul></li><li><a href="#consul" class="table-of-contents__link toc-highlight">Consul</a><ul><li><a href="#安装并运行" class="table-of-contents__link toc-highlight">安装并运行</a></li><li><a href="#提供者-3" class="table-of-contents__link toc-highlight">提供者</a></li><li><a href="#消费者-3" class="table-of-contents__link toc-highlight">消费者</a></li></ul></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li><li><a href="#ribbon" class="table-of-contents__link toc-highlight">Ribbon</a><ul><li><a href="#简介" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#负载均衡" class="table-of-contents__link toc-highlight">负载均衡</a></li><li><a href="#轮询算法原理" class="table-of-contents__link toc-highlight">轮询算法原理</a></li></ul></li><li><a href="#openfeign" class="table-of-contents__link toc-highlight">OpenFeign</a><ul><li><a href="#概述" class="table-of-contents__link toc-highlight">概述</a></li><li><a href="#使用" class="table-of-contents__link toc-highlight">使用</a></li><li><a href="#超时控制" class="table-of-contents__link toc-highlight">超时控制</a></li><li><a href="#开启日志打印" class="table-of-contents__link toc-highlight">开启日志打印</a></li></ul></li><li><a href="#概述-1" class="table-of-contents__link toc-highlight">概述</a></li><li><a href="#案例" class="table-of-contents__link toc-highlight">案例</a><ul><li><a href="#模拟高并发" class="table-of-contents__link toc-highlight">模拟高并发</a></li><li><a href="#服务降级" class="table-of-contents__link toc-highlight">服务降级</a></li><li><a href="#全局服务降级" class="table-of-contents__link toc-highlight">全局服务降级</a></li><li><a href="#服务熔断" class="table-of-contents__link toc-highlight">服务熔断</a></li></ul></li><li><a href="#hystrix-dashboard" class="table-of-contents__link toc-highlight">Hystrix DashBoard</a><ul><li><a href="#监控实战" class="table-of-contents__link toc-highlight">监控实战</a></li></ul></li><li><a href="#gateway" class="table-of-contents__link toc-highlight">Gateway</a><ul><li><a href="#简介-1" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#入门配置" class="table-of-contents__link toc-highlight">入门配置</a></li><li><a href="#动态配置" class="table-of-contents__link toc-highlight">动态配置</a></li><li><a href="#predicate" class="table-of-contents__link toc-highlight">Predicate</a></li><li><a href="#filter" class="table-of-contents__link toc-highlight">Filter</a></li></ul></li><li><a href="#config" class="table-of-contents__link toc-highlight">Config</a><ul><li><a href="#概述-2" class="table-of-contents__link toc-highlight">概述</a></li><li><a href="#服务端配置" class="table-of-contents__link toc-highlight">服务端配置</a></li><li><a href="#客户端配置" class="table-of-contents__link toc-highlight">客户端配置</a></li><li><a href="#动态刷新" class="table-of-contents__link toc-highlight">动态刷新</a></li></ul></li><li><a href="#bus" class="table-of-contents__link toc-highlight">Bus</a><ul><li><a href="#安装rabbitmq" class="table-of-contents__link toc-highlight">安装RabbitMQ</a></li><li><a href="#广播式刷新配置" class="table-of-contents__link toc-highlight">广播式刷新配置</a></li><li><a href="#定点通知" class="table-of-contents__link toc-highlight">定点通知</a></li></ul></li><li><a href="#stream" class="table-of-contents__link toc-highlight">Stream</a><ul><li><a href="#概述-3" class="table-of-contents__link toc-highlight">概述</a></li><li><a href="#消息生产者" class="table-of-contents__link toc-highlight">消息生产者</a></li><li><a href="#消息消费者" class="table-of-contents__link toc-highlight">消息消费者</a></li><li><a href="#配置分组消费" class="table-of-contents__link toc-highlight">配置分组消费</a></li><li><a href="#消息持久化" class="table-of-contents__link toc-highlight">消息持久化</a></li></ul></li><li><a href="#概述-4" class="table-of-contents__link toc-highlight">概述</a></li><li><a href="#案例-1" class="table-of-contents__link toc-highlight">案例</a></li><li><a href="#大简介" class="table-of-contents__link toc-highlight">大简介</a></li><li><a href="#nacos" class="table-of-contents__link toc-highlight">Nacos</a><ul><li><a href="#下载" class="table-of-contents__link toc-highlight">下载</a></li><li><a href="#服务中心" class="table-of-contents__link toc-highlight">服务中心</a></li><li><a href="#配置中心" class="table-of-contents__link toc-highlight">配置中心</a></li><li><a href="#nacos持久化" class="table-of-contents__link toc-highlight">Nacos持久化</a></li><li><a href="#集群架构" class="table-of-contents__link toc-highlight">集群架构</a></li></ul></li><li><a href="#sentinel" class="table-of-contents__link toc-highlight">Sentinel</a><ul><li><a href="#下载-1" class="table-of-contents__link toc-highlight">下载</a></li><li><a href="#demo" class="table-of-contents__link toc-highlight">Demo</a></li><li><a href="#流控规则" class="table-of-contents__link toc-highlight">流控规则</a></li><li><a href="#熔断降级" class="table-of-contents__link toc-highlight">熔断降级</a></li><li><a href="#热点key限流" class="table-of-contents__link toc-highlight">热点Key限流</a></li><li><a href="#系统规则" class="table-of-contents__link toc-highlight">系统规则</a></li><li><a href="#sentinelresource配置" class="table-of-contents__link toc-highlight">@SentinelResource配置</a></li><li><a href="#整合-openfeign-服务降级" class="table-of-contents__link toc-highlight">整合 openfeign 服务降级</a></li><li><a href="#异常忽略" class="table-of-contents__link toc-highlight">异常忽略</a></li><li><a href="#持久化" class="table-of-contents__link toc-highlight">持久化</a></li></ul></li><li><a href="#seata" class="table-of-contents__link toc-highlight">Seata</a><ul><li><a href="#下载安装" class="table-of-contents__link toc-highlight">下载安装</a></li><li><a href="#初始化操作" class="table-of-contents__link toc-highlight">初始化操作</a></li><li><a href="#案例-2" class="table-of-contents__link toc-highlight">案例</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Computer-Science-Learn-Notes/docs/intro">主页</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="#" class="footer__link-item">莫得</a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/zhiyu1998" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Computer Science Learn Notes, Inc. Built with Zhiyu1998.</div></div></div></footer></div>
<script src="/Computer-Science-Learn-Notes/assets/js/runtime~main.af325474.js"></script>
<script src="/Computer-Science-Learn-Notes/assets/js/main.7db0b496.js"></script>
</body>
</html>