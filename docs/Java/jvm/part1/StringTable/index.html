<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Java/jvm/part1/StringTable">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<title data-rh="true">StringTable | Computer Science Learn Notes</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/docs/Java/jvm/part1/StringTable"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="StringTable | Computer Science Learn Notes"><meta data-rh="true" name="description" content="[TOC]"><meta data-rh="true" property="og:description" content="[TOC]"><link data-rh="true" rel="icon" href="/Computer-Science-Learn-Notes/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/docs/Java/jvm/part1/StringTable"><link data-rh="true" rel="alternate" href="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/docs/Java/jvm/part1/StringTable" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/docs/Java/jvm/part1/StringTable" hreflang="x-default"><link rel="stylesheet" href="/Computer-Science-Learn-Notes/assets/css/styles.e2ac7477.css">
<link rel="preload" href="/Computer-Science-Learn-Notes/assets/js/runtime~main.ac9df2f9.js" as="script">
<link rel="preload" href="/Computer-Science-Learn-Notes/assets/js/main.a8b3a5e6.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Computer-Science-Learn-Notes/"><div class="navbar__logo"><img src="/Computer-Science-Learn-Notes/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/Computer-Science-Learn-Notes/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Computer Science Learn Notes</b></a><a class="navbar__item navbar__link" href="/Computer-Science-Learn-Notes/docs/intro">主页</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/Computer-Science-Learn-Notes/docs/golang/learnInProblem">目录</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Computer-Science-Learn-Notes/docs/golang/learnInProblem">Go语言</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Computer-Science-Learn-Notes/docs/frontend/react/">前端</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Computer-Science-Learn-Notes/docs/fundamental/datastruct">基础知识</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/basic/">Java基础</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/basic/">基础知识</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/concurrent/">并发编程</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/简介">虚拟机</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/简介">简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/类加载子系统">类加载子系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/运行时数据区">运行时数据区</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/程序计数器（PC寄存器）">程序计数器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/虚拟机栈">虚拟机栈</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/本地方法接口">本地方法接口</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/本地方法栈">本地方法栈</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/堆">堆</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/方法区">方法区</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/对象的实例化内存布局与访问定位">对象的实例化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/直接内存">直接内存</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/执行引擎">执行引擎</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/StringTable">StringTable</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/垃圾回收概述">垃圾回收概述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/垃圾回收相关算法">垃圾回收相关算法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/垃圾回收相关概念">垃圾回收相关概念</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/垃圾回收器">垃圾回收器</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/Spring">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/SpringMVC">SpringMVC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/Mybatis">Mybatis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/SpringBoot">SpringBoot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/SpringDataJpa">SpringDataJpa</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/SpringSecurity">SpringSecurity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/fm/SpringCloud">SpringCloud</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/docker/main">Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/integration/main">SpringBoot整合其他框架</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Computer-Science-Learn-Notes/docs/Java/eightpart/main">Java面试</a></div></li></ul></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/Computer-Science-Learn-Notes/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">目录</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Java基础</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">虚拟机</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">StringTable</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>StringTable</h1></header><p>[TOC]</p><h1>String的基本特性</h1><ul><li><p>String：字符串，使用一对&quot; &quot;引起来表示</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">String s1 = “baidu”; //字面量的定义方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String s2 = new String(&quot;hello&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">12</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>String声明为final的，不可被继承</p></li><li><p>String实现了Serializable接口：表示字符串是支持序列化的</p></li><li><p>String实现了Comparable接口：表示string可以比较大小</p></li><li><p>String在jdk8及以前内部定义了final char<!-- -->[ ]<!-- --> value用于存储字符串数据。JDK9时改为byte<!-- -->[ ]</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="string在jdk9中存储结构变更">String在jdk9中存储结构变更<a class="hash-link" href="#string在jdk9中存储结构变更" title="标题的直接链接">​</a></h2><p>官网地址：<a href="http://openjdk.java.net/jeps/254" target="_blank" rel="noopener noreferrer">JEP 254: Compact Strings (java.net)</a></p><blockquote><p>Motivation</p><p>The current implementation of the <code>String</code> class stores characters in a <code>char</code> array, using two bytes (sixteen bits) for each character. Data gathered from many different applications indicates that strings are a major  component of heap usage and, moreover, that most <code>String</code> objects contain only Latin-1 characters. Such characters require only  one byte of storage, hence half of the space in the internal <code>char</code> arrays of such <code>String</code> objects is going unused.</p><p>Description</p><p>We propose to change the internal representation of the <code>String</code> class from a UTF-16 <code>char</code> array to a <code>byte</code> array plus an encoding-flag field. The new <code>String</code> class will store characters encoded either as ISO-8859-1/Latin-1 (one  byte per character), or as UTF-16 (two bytes per character), based upon  the contents of the string. The encoding flag will indicate which  encoding is used.</p><p>String-related classes such as <code>AbstractStringBuilder</code>, <code>StringBuilder</code>, and <code>StringBuffer</code> will be updated to use the same representation, as will the HotSpot VM’s intrinsic string operations.</p><p>This is purely an implementation change, with no changes to existing public interfaces. There are no plans to add any new public APIs or  other interfaces.</p><p>The prototyping work done to date confirms the expected reduction in memory footprint, substantial reductions of GC activity, and minor  performance regressions in some corner cases.</p></blockquote><blockquote><p><strong>动机</strong></p><p>该类的当前实现<code>String</code>将字符存储在一个 <code>char</code>数组中，每个字符使用两个字节（十六位）。从许多不同应用程序收集的数据表明，字符串是堆使用的主要组成部分，而且大多数<code>String</code>对象仅包含 Latin-1 字符。此类字符仅需要一个字节的存储空间，因此此类对象的内部<code>char</code>数组中的 一半空间未使用。<code>String</code></p><p><strong>描述</strong></p><p>我们建议将<code>String</code>类的内部表示从 UTF-16<code>char</code>数组更改为<code>byte</code>数组加上编码标志字段。新<code>String</code>类将根据字符串的内容存储编码为 ISO-8859-1/Latin-1（每个字符一个字节）或 UTF-16（每个字符两个字节）的字符。编码标志将指示使用哪种编码。</p><p>与字符串相关的类（例如<code>AbstractStringBuilder</code>、<code>StringBuilder</code>和 ）<code>StringBuffer</code>将被更新为使用相同的表示形式，HotSpot VM 的内在字符串操作也是如此。</p><p>这纯粹是一个实现更改，对现有的公共接口没有任何更改。没有计划添加任何新的公共 API 或其他接口。</p><p>迄今为止完成的原型设计工作证实了内存占用的预期减少、GC 活动的大幅减少以及在某些极端情况下的轻微性能回归。</p></blockquote><blockquote><p>结论：String再也不用char<!-- -->[ ]<!-- --> 来存储了，改成了byte<!-- -->[ ]<!-- --> 加上编码标记，节约了一些空间</p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public final class String implements java.io.Serializable, Comparable&lt;String&gt;, CharSequence {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Stable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final byte[] value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="string的基本特性-1">String的基本特性<a class="hash-link" href="#string的基本特性-1" title="标题的直接链接">​</a></h2><ul><li>String：代表不可变的字符序列。简称：不可变性   <ul><li>当对字符串重新赋值时，需要重写指定内存区域赋值，不能使用原有的value进行赋值</li><li>当对现有的字符串进行连接操作时，也需要重新指定内存区域赋值，不能使用原有的value进行赋值</li><li>当调用string的replace( )方法修改指定字符或字符串时，也需要重新指定内存区域赋值，不能使用原有的value进行赋值</li></ul></li><li>通过字面量的方式（区别于new）给一个字符串赋值，此时的字符串值声明在字符串常量池中</li><li>字符串常量池是不会存储相同内容的字符串的   <ul><li>String的String Pool是一个固定大小的Hashtable，默认值大小长度是1009。如果放进String  Pool的String非常多，就会造成Hash冲突严重，从而导致链表会很长，而链表长了后直接会造成的影响就是当调用String.intern时性能会大幅下降</li><li>使用<code>-XX:StringTablesize</code>可设置StringTable的长度</li><li>在JDK6中StringTable是固定的，就是1009的长度，所以如果常量池中的字符串过多就会导致效率下降很快。<code>StringTablesize</code>设置没有要求</li><li>在JDK7中，StringTable的长度默认值是60013，<code>StringTablesize</code>设置没有要求</li><li>在<u><em>JDK8开始，设置StringTable长度的话，1009是可以设置的最小值</em></u></li></ul></li></ul><blockquote><p>代码示例：体现 String 的不可变性</p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * String的基本使用:体现String的不可变性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class StringTest1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void test1() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s1 = &quot;abc&quot;; //字面量定义的方式，&quot;abc&quot;存储在字符串常量池中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s2 = &quot;abc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        s1 = &quot;hello&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s1 == s2); //判断地址：true  --&gt; false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s1); //hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s2); //abc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void test2() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s1 = &quot;abc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s2 = &quot;abc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        s2 += &quot;def&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s2); //abcdef</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s1); //abc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void test3() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s1 = &quot;abc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s2 = s1.replace(&#x27;a&#x27;, &#x27;m&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s1); //abc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s2); //mbc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>在JDK8开始，设置StringTable长度的话，1009是可以设置的最小值</p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //测试StringTableSize参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        System.out.println(&quot;我来打个酱油&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//            Thread.sleep(1000000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        } catch (InterruptedException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>默认什么都不设置，运行</li><li>命令行输入指令查看 StringTable 的长度</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jinfo -flag StringTableSize</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="image-20220303210426840" src="/Computer-Science-Learn-Notes/assets/images/image-20220303210426840-d037764d52de24b72e5a7c7b7d1e2147.png" width="1010" height="211" class="img_ev3q"></p><ul><li>可以看到默认长度就是60013</li><li>设置JVM参数</li></ul><blockquote><p>-XX:StringTableSize=10</p></blockquote><p>发生报错</p><p><img loading="lazy" alt="image-20220303210521297" src="/Computer-Science-Learn-Notes/assets/images/image-20220303210521297-407d89a32a30d4a7179eec406578c0c1.png" width="740" height="86" class="img_ev3q"></p><p>StringTable 大小为 10 无效；必须介于 1009 和 2305843009213693951 之间</p><blockquote><p>String 笔试题：考察对String不可变性的认识</p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class StringExer {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String str = new String(&quot;good&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    char[] ch = {&#x27;t&#x27;, &#x27;e&#x27;, &#x27;s&#x27;, &#x27;t&#x27;};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void change(String str, char ch[]) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        str = &quot;test ok&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ch[0] = &#x27;b&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        StringExer ex = new StringExer();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ex.change(ex.str, ex.ch);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(ex.str); //good</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(ex.ch); //best</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>测试StringTable大小对性能的影响</p></blockquote><ol><li>生成10万个字符串</li></ol><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 产生10万个长度不超过10的字符串，包含a-z,A-Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class GenerateString {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileWriter fw =  new FileWriter(&quot;words.txt&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 100000; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //1 - 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int length = (int)(Math.random() * (10 - 1 + 1) + 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fw.write(getString(length) + &quot;\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fw.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String getString(int length){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String str = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; length; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //65 - 90, 97-122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int num = (int)(Math.random() * (90 - 65 + 1) + 65) + (int)(Math.random() * 2) * 32;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            str += (char)num;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return str;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>再将这 10万 个字符串存入字符串常量池中，测试不同的StringTable对性能的影响</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *  -XX:StringTableSize=1009</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class StringTest2 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 测试StringTableSize参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        System.out.println(&quot;我来打个酱油&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//            Thread.sleep(1000000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        } catch (InterruptedException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BufferedReader br = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            br = new BufferedReader(new FileReader(&quot;words.txt&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            long start = System.currentTimeMillis();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while((data = br.readLine()) != null){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                data.intern(); //如果字符串常量池中没有对应data的字符串的话，则在常量池中生成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            long end = System.currentTimeMillis();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;花费的时间为：&quot; + (end - start)); // 1009:206ms  10000:51ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (IOException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(br != null){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    br.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                } catch (IOException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>设置 StringTable 大小为默认最小值 1009</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-XX:StringTableSize=1009</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>结果为：206ms</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">花费的时间为：206</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>再将 StringTable 大小设置为 100009</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-XX:StringTableSize=100009</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>结果为：51ms</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">花费的时间为：51</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>String的内存分配</h1><ul><li>在Java语言中有8种基本数据类型和一种比较特殊的类型String。这些类型为了使它们在运行过程中速度更快、更节省内存，都提供了一种常量池的概念。</li><li>常量池就类似一个Java系统级别提供的缓存。8种基本数据类型的常量池都是系统协调的，String类型的常量池比较特殊。它的主要使用方法有两种。   <ul><li>直接使用双引号声明出来的String对象会直接存储在常量池中。     <ul><li>比如：<code>String info = “cn.bing.com”</code>;</li></ul></li><li>如果不是用双引号声明的String对象，可以使用String提供的intern( )方法。这个后面重点谈</li></ul></li><li>Java 6及以前，字符串常量池存放在永久代</li><li>Java 7中 Oracle的工程师对字符串池的逻辑做了很大的改变，即将字符串常量池的位置调整到Java堆内   <ul><li>所有的字符串都保存在堆（Heap）中，和其他普通对象一样，这样可以让你在进行调优应用时仅需要调整堆大小就可以了。</li><li>字符串常量池概念原本使用得比较多，但是这个改动使得我们有足够的理由让我们重新考虑在Java 7中使用<code>String.intern()</code></li></ul></li><li>Java8元空间，字符串常量在堆空间中</li></ul><p><img loading="lazy" src="/Computer-Science-Learn-Notes/assets/images/image-20220227161025841-b1f7d18544c885710cf68506971ce75d.png" width="1083" height="524" class="img_ev3q"></p><p><img loading="lazy" src="/Computer-Science-Learn-Notes/assets/images/image-20220227161034169-31c4e5cf845c57ad1d72f07b620e0e0b.png" width="1074" height="508" class="img_ev3q"></p><p><img loading="lazy" src="/Computer-Science-Learn-Notes/assets/images/image-20220227161042271-25626f56218cf3c124179ac85dc6a1d3.png" width="1177" height="435" class="img_ev3q"></p><blockquote><p>StringTable为什么要调整？</p></blockquote><ul><li>permSize默认比较小</li><li>永久代垃圾回收频率低</li></ul><p>官网地址：<a href="https://www.oracle.com/java/technologies/javase/jdk7-relnotes.html#jdk7changes" target="_blank" rel="noopener noreferrer">Java SE 7 Features and Enhancements (oracle.com)</a></p><blockquote><p><strong>Synopsis:</strong> In JDK 7, interned strings are no longer  allocated in the permanent generation of the Java heap, but are instead  allocated in the main part of the Java heap (known as the young and old  generations), along with the other objects created by the application.  This change will result in more data residing in the main Java heap, and less data in the permanent generation, and thus may require heap sizes  to be adjusted. Most applications will see only relatively small  differences in heap usage due to this change, but larger applications  that load many classes or make heavy use of the <code>String.intern()</code> method will see more significant differences.</p></blockquote><blockquote><p>简介：在JDK  7中，内部字符串不再分配在Java堆的永久代中，而是分配在Java堆的主要部分（称为年轻代和老年代），与应用程序创建的其他对象一起。这种变化将导致更多的数据驻留在主Java堆中，而更少的数据在永久代中，因此可能需要调整堆的大小。大多数应用程序将看到由于这一变化而导致的堆使用的相对较小的差异，但加载许多类或大量使用String.intern( )方法的大型应用程序将看到更明显的差异。</p></blockquote><blockquote><p>代码示例</p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * jdk6中：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * -XX:PermSize=6m -XX:MaxPermSize=6m -Xms6m -Xmx6m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * jdk8中：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * -XX:MetaspaceSize=6m -XX:MaxMetaspaceSize=6m -Xms6m -Xmx6m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class StringTest3 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //使用Set保持着常量池引用，避免full gc回收常量池行为</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set&lt;String&gt; set = new HashSet&lt;String&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //在short可以取值的范围内足以让6MB的PermSize或heap产生OOM了。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        short i = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while(true){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            set.add(String.valueOf(i++).intern());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可以看到OOM是发生在堆空间中，所以字符串常量池在JDK8中确实是存在堆空间中的</p><p><img loading="lazy" alt="image-20220303212519952" src="/Computer-Science-Learn-Notes/assets/images/image-20220303212519952-84823ab26a3ddeacd00468fcc2d04587.png" width="403" height="116" class="img_ev3q"></p><h1>String 基本操作</h1><blockquote><p>Java语言规范里要求完全相同的字符串字面量，应该包含同样的Unicode字符序列（包含同一份码点序列的常量），并且必须是指向同一个String类实例。</p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class StringTest4 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println();//1230</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;1&quot;);//1231</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;2&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;3&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;4&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;5&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;6&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;7&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;8&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;9&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;10&quot;);//1240</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //如下的字符串&quot;1&quot; 到 &quot;10&quot;不会再次加载</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;1&quot;);//1241</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;2&quot;);//1241</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;3&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;4&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;5&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;6&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;7&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;8&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;9&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;10&quot;);//1241</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>对一些代码进行打断点操作</li><li>初始化有 2123 个字符串</li></ul><p><img loading="lazy" alt="image-20220304110839064" src="/Computer-Science-Learn-Notes/assets/images/image-20220304110839064-ed4a5afd749f642d26009ed5ff6a7cce.png" width="1928" height="1048" class="img_ev3q"></p><p>执行字符串”1”，可以发现字符串数量变成了2124个</p><p><img loading="lazy" alt="image-20220304110904919" src="/Computer-Science-Learn-Notes/assets/images/image-20220304110904919-fd02cae1626d233e6aaaf1d167475508.png" width="1928" height="1048" class="img_ev3q"></p><p>执行字符串”10”，可以发现字符串数量变成了2133个</p><p><img loading="lazy" alt="image-20220304110930069" src="/Computer-Science-Learn-Notes/assets/images/image-20220304110930069-9836d69c25bb2c05ca6aea8bbb3424b6.png" width="1928" height="1048" class="img_ev3q"></p><p>下面相同的字符串都在字符串常量池加载过一次了，所以下面相同的字符串都不会再被加载了</p><p><img loading="lazy" alt="image-20220304111124367" src="/Computer-Science-Learn-Notes/assets/images/image-20220304111124367-a9cf247db556adc63b28c35485319db5.png" width="1928" height="1048" class="img_ev3q"></p><blockquote><p>代码示例2</p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class Memory {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {//line 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int i = 1;//line 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object obj = new Object();//line 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Memory mem = new Memory();//line 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mem.foo(obj);//line 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }//line 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private void foo(Object param) {//line 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String str = param.toString();//line 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }//line 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Untitled" src="/Computer-Science-Learn-Notes/assets/images/8f8c491a8a4e961805a4df04f2291182-8235d05ff688d6af8e2951bc8d3a8396.png" width="1134" height="492" class="img_ev3q"></p><p>上面图片的局部变量表还缺少几个参数，下面列出正确的局部变量表数量</p><ul><li>注意这里是非静态方法所以第一个位置放得是this，第二个才是param</li></ul><p><img loading="lazy" alt="image-20220304111646344" src="/Computer-Science-Learn-Notes/assets/images/image-20220304111646344-45aeb0c6352e520f9aef6bc92ad9478d.png" width="712" height="533" class="img_ev3q"></p><p>全过程解析：</p><ol><li>main方法的param对应的是mem这个变量</li><li>把这个param给了字符串str，然后记录在字符串常量池中（当前对象类型和存储地址）</li></ol><p>注：这里的toString调用的是Object的，底层通过StringBuilder进行拼接，会在堆内存中new一个String对象，因此这时的字符串常量池没字符串对象。str指向堆String对象</p><h1>字符串拼接操作</h1><ul><li>常量与常量的拼接结果在常量池，原理是编译期优化</li><li>常量池中不会存在相同内容的变量</li><li>只要其中有一个是变量，结果就在堆中。变量拼接的原理是<code>StringBuilder</code></li><li>如果拼接的结果调用intern( )方法，则主动将常量池中还没有的字符串对象放入池中，并返回此对象地址</li></ul><blockquote><p>代码示例1</p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void test1() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s1 = &quot;a&quot; + &quot;b&quot; + &quot;c&quot;; //编译期优化：等同于&quot;abc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s2 = &quot;abc&quot;; //&quot;abc&quot;一定是放在字符串常量池中，将此地址赋给s2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 最终.java编译成.class,再执行.class</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * String s1 = &quot;abc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * String s2 = &quot;abc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s1 == s2); //true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s1.equals(s2)); //true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>通过编译后查看class文件可以看到</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void test1() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s1 = &quot;abc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s2 = &quot;abc&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s1 == s2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s1.equals(s2));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>再次查看jclasslib的情况</p><ul><li>可以看到ldc是从字符串常量池中取出的，放入局部变量表中，不仅是第二个，第一个字符串也是从常量池取出，所以显然是值一样</li></ul><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> ldc </span><span class="token comment" style="color:#999988;font-style:italic">#2 &lt;abc&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> astore_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> ldc </span><span class="token comment" style="color:#999988;font-style:italic">#2 &lt;abc&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> astore_2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> getstatic </span><span class="token comment" style="color:#999988;font-style:italic">#3 &lt;java/lang/System.out : Ljava/io/PrintStream;&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> aload_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> aload_2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> if_acmpne </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> iconst_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> goto </span><span class="token number" style="color:#36acaa">19</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> iconst_0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">19</span><span class="token plain"> invokevirtual </span><span class="token comment" style="color:#999988;font-style:italic">#4 &lt;java/io/PrintStream.println : (Z)V&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> getstatic </span><span class="token comment" style="color:#999988;font-style:italic">#3 &lt;java/lang/System.out : Ljava/io/PrintStream;&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> aload_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">26</span><span class="token plain"> aload_2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">27</span><span class="token plain"> invokevirtual </span><span class="token comment" style="color:#999988;font-style:italic">#5 &lt;java/lang/String.equals : (Ljava/lang/Object;)Z&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">30</span><span class="token plain"> invokevirtual </span><span class="token comment" style="color:#999988;font-style:italic">#4 &lt;java/io/PrintStream.println : (Z)V&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">33</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>代码示例2</p></blockquote><p>这就解释了：只要其中有一个是变量，结果就在堆中。变量拼接的原理是<code>StringBuilder</code></p><ul><li>如果拼接符号的前后出现了变量，则相当于在堆空间中new String()</li><li>intern<ul><li>判断字符串常量池中是否存在javaEEhadoop值，如果存在，则返回常量池中javaEEhadoop的地址</li><li>如果字符串常量池中不存在javaEEhadoop，则在常量池中加载一份javaEEhadoop，并返回此对象的地址。</li></ul></li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void test2() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s1 = &quot;javaEE&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s2 = &quot;hadoop&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s3 = &quot;javaEEhadoop&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s4 = &quot;javaEE&quot; + &quot;hadoop&quot;;//编译期优化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //如果拼接符号的前后出现了变量，则相当于在堆空间中new String()，具体的内容为拼接的结果：javaEEhadoop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s5 = s1 + &quot;hadoop&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s6 = &quot;javaEE&quot; + s2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s7 = s1 + s2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s3 == s4);//true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s3 == s5);//false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s3 == s6);//false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s3 == s7);//false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s5 == s6);//false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s5 == s7);//false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s6 == s7);//false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //intern():判断字符串常量池中是否存在javaEEhadoop值，如果存在，则返回常量池中javaEEhadoop的地址；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //如果字符串常量池中不存在javaEEhadoop，则在常量池中加载一份javaEEhadoop，并返回此对象的地址。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s8 = s6.intern();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s3 == s8);//true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>代码示例3</p></blockquote><p>比如s1，它在栈结构里面，里面有test3的栈帧，栈帧里面有一个局部变量表是一个数组，索引为0是this，索引为1是s1，指向的就是堆空间里面的常量池中的&#x27;a&#x27;</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void test3(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s1 = &quot;a&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s2 = &quot;b&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s3 = &quot;ab&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        如下的s1 + s2 的执行细节：(变量s是我临时定义的）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ① StringBuilder s = new StringBuilder();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ② s.append(&quot;a&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ③ s.append(&quot;b&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ④ s.toString()  --&gt; 约等于 new String(&quot;ab&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        补充：在jdk5.0之后使用的是StringBuilder,在jdk5.0之前使用的是StringBuffer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s4 = s1 + s2;//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(s3 == s4);//false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>反编译字节码文件</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> ldc </span><span class="token comment" style="color:#999988;font-style:italic">#14 &lt;a&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> astore_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> ldc </span><span class="token comment" style="color:#999988;font-style:italic">#15 &lt;b&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> astore_2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> ldc </span><span class="token comment" style="color:#999988;font-style:italic">#16 &lt;ab&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> astore_3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> new </span><span class="token comment" style="color:#999988;font-style:italic">#9 &lt;java/lang/StringBuilder&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">12</span><span class="token plain"> dup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> invokespecial </span><span class="token comment" style="color:#999988;font-style:italic">#10 &lt;java/lang/StringBuilder.&lt;init&gt; : ()V&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">16</span><span class="token plain"> aload_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">17</span><span class="token plain"> invokevirtual </span><span class="token comment" style="color:#999988;font-style:italic">#11 &lt;java/lang/StringBuilder.append : (Ljava/lang/String;)Ljava/lang/StringBuilder;&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> aload_2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> invokevirtual </span><span class="token comment" style="color:#999988;font-style:italic">#11 &lt;java/lang/StringBuilder.append : (Ljava/lang/String;)Ljava/lang/StringBuilder;&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> invokevirtual </span><span class="token comment" style="color:#999988;font-style:italic">#12 &lt;java/lang/StringBuilder.toString : ()Ljava/lang/String;&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">27</span><span class="token plain"> astore </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> getstatic </span><span class="token comment" style="color:#999988;font-style:italic">#3 &lt;java/lang/System.out : Ljava/io/PrintStream;&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">32</span><span class="token plain"> aload_3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">33</span><span class="token plain"> aload </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">35</span><span class="token plain"> if_acmpne </span><span class="token number" style="color:#36acaa">42</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">38</span><span class="token plain"> iconst_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">39</span><span class="token plain"> goto </span><span class="token number" style="color:#36acaa">43</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">42</span><span class="token plain"> iconst_0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">43</span><span class="token plain"> invokevirtual </span><span class="token comment" style="color:#999988;font-style:italic">#4 &lt;java/io/PrintStream.println : (Z)V&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">46</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Untitled" src="/Computer-Science-Learn-Notes/assets/images/478f3f95a84314dcb2b9b906ed71d698-fedecf4f57d377c5cd03a13de135afb0.png" width="1283" height="671" class="img_ev3q"></p><p>可以看到 String s4 = s1 + s2; 相当于new了一个 StringBuilder，然后使用append拼接 s1 和 s2  字符串，最后再使用toString( )方法约等于new  了一个String对象存放在堆中，这里要和字符串常量池区分开，s3存放在字符串常量池中，s4存放在堆中，所以 s3 不等于 s4</p><blockquote><p>知识补充：在 JDK 5 之后，使用的是 StringBuilder，在 JDK 5 之前使用的是 StringBuffer</p></blockquote><table><thead><tr><th>String</th><th>StringBuffer</th><th>StringBuilder</th></tr></thead><tbody><tr><td>String 的值是不可变的，这就导致每次对 String 的操作都会生成新的 String 对象，不仅效率低下，而且浪费大量优先的内存空间</td><td>StringBuffer 是可变类，和线程安全的字符串操作类，任何对它指向的字符串的操作都不会产生新的对象。每个 StringBuffer 对象都有一定的缓冲区容量，当字符串大小没有超过容量时，不会分配新的容量，当字符串大小超过容量时，会自动增加容量</td><td>可变类，速度更快</td></tr><tr><td>不可变</td><td>可变</td><td>可变</td></tr><tr><td></td><td>线程安全</td><td>线程不安全</td></tr><tr><td></td><td>多线程操作字符串</td><td>单线程操作字符串</td></tr></tbody></table><blockquote><p>代码示例4</p></blockquote><ol><li>字符串拼接操作不一定使用的是StringBuilder<ol><li>如果拼接符号左右两边都是字符串常量或常量引用，则仍然使用编译期优化，即非StringBuilder的方式。</li></ol></li><li>针对于final修饰类、方法、基本数据类型、引用数据类型的量的结构时，能使用上final的时候建议使用上。</li></ol><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        /*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    1. 字符串拼接操作不一定使用的是StringBuilder!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       如果拼接符号左右两边都是字符串常量或常量引用，则仍然使用编译期优化，即非StringBuilder的方式。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    2. 针对于final修饰类、方法、基本数据类型、引用数据类型的量的结构时，能使用上final的时候建议使用上。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void test4(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        final String s1 = &quot;a&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        final String s2 = &quot;b&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s3 = &quot;ab&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s4 = s1 + s2; //s4:常量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s3 == s4);//true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>注意，我们左右两边如果是变量的话，就是需要 new StringBuilder 进行拼接，但是如果使用的是 final  修饰，则是从常量池中获取。所以说拼接符号左右两边都是字符串常量或常量引用 则仍然使用编译器优化。也就是说被 final  修饰的变量，将会变成常量，类和方法将不能被继承。   <ul><li>在开发中，能够使用 final 的时候，建议使用上</li></ul></li></ul><blockquote><p>代码示例5</p></blockquote><p>通过StringBuilder的append()的方式添加字符串的效率要远高于使用String的字符串拼接方式</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        体会执行效率：通过StringBuilder的append()的方式添加字符串的效率要远高于使用String的字符串拼接方式！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        详情：① StringBuilder的append()的方式：自始至终中只创建过一个StringBuilder的对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          使用String的字符串拼接方式：创建过多个StringBuilder和String的对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ② 使用String的字符串拼接方式：内存中由于创建了较多的StringBuilder和String的对象，内存占用更大；如果进行GC，需要花费额外的时间。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        改进的空间：在实际开发中，如果基本确定要前前后后添加的字符串长度不高于某个限定值highLevel的情况下,建议使用构造器实例化：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               StringBuilder s = new StringBuilder(highLevel);//new char[highLevel]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void test6() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        long start = System.currentTimeMillis();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        method1(100000);// 3375</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        method2(100000);// 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        long end = System.currentTimeMillis();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;花费的时间为：&quot; + (end - start));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void method1(int highLevel) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String src = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; highLevel; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            src = src + &quot;a&quot;;//每次循环都会创建一个StringBuilder、String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        System.out.println(src);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void method2(int highLevel) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //只需要创建一个StringBuilder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        StringBuilder src = new StringBuilder();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; highLevel; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            src.append(&quot;a&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        System.out.println(src);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>intern( )的使用</h1><blockquote><p>官方API文档中的解释</p><p>public String intern( )</p><p>Returns a canonical representation for the string object.</p><p>A pool of strings, initially empty, is maintained privately by the class <code>String</code>.</p><p>When the intern method is invoked, if the pool already contains a string equal to this <code>String</code> object as determined by the <code>[equals(Object)] method, then the string from the pool is returned. Otherwise, this </code>String<code>object is added to the pool and a reference to this</code>String` object is returned.</p><p>It follows that for any two strings <code>s</code> and <code>t</code>, <code>s.intern() == t.intern()</code> is <code>true</code> if and only if <code>s.equals(t)</code> is <code>true</code>.</p><p>All literal strings and string-valued constant expressions are  interned. String literals are defined in section 3.10.5 of the The Java™ Language Specification.</p><ul><li><strong>Returns:</strong>a string that has the same contents as this string, but is guaranteed to be from a pool of unique strings.</li></ul><p>中文：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public String intern()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>返回字符串对象的规范表示。</p><p>最初为空的字符串池由<code>String</code>类<code>String</code> 。</p><p>当调用intern方法时，如果池已经包含与<code>equals(Object)</code>方法确定的相当于此<code>String</code>对象的字符串，则返回来自池的字符串。 否则，此<code>String</code>对象将添加到池中，并返回对此<code>String</code>对象的引用。</p><p>由此可见，对于任何两个字符串<code>s</code>和<code>t</code> ， <code>s.intern() == t.intern()</code>是<code>true</code>当且仅当<code>s.equals(t)</code>是<code>true</code> 。</p><p>所有文字字符串和字符串值常量表达式都被实体化。 字符串文字在The Java™ Language Specification的 3.10.5节中定义。</p><ul><li><p><strong>结果</strong></p><p>一个字符串与该字符串具有相同的内容，但保证来自一个唯一的字符串池。</p></li></ul></blockquote><blockquote><p>当调用intern方法时，如果池子里已经包含了一个与这个String对象相等的字符串，正如equals(Object)方法所确定的，那么池子里的字符串会被返回。否则，这个String对象被添加到池中，并返回这个String对象的引用。</p><p>由此可见，对于任何两个字符串s和t，当且仅当s.equals(t)为真时，s.intern( ) == t.intern( )为真。</p><p>所有字面字符串和以字符串为值的常量表达式都是interned。</p><p>返回一个与此字符串内容相同的字符串，但保证是来自一个唯一的字符串池。</p></blockquote><ul><li><code>intern()</code> 是一个 native 方法，调用的是底层 C 的方法。</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public native String intern();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>如果不是用双引号声明的String对象，可以使用String提供的intern方法，它会从字符串常量池中查询当前字符串是否存在，若不存在就会将当前字符串放入常量池中。</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">String myInfo = new string(&quot;I love alibaba&quot;).intern();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>也就是说，如果在任意字符串上调用String.intern方法，那么其返回结果所指向的那个类实例，必须和直接以常量形式出现的字符串实例完全相同。因此，下列表达式的值必定是true</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(&quot;a&quot;+&quot;b&quot;+&quot;c&quot;).intern() == &quot;abc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>通俗点讲，Interned string就是确保字符串在内存里只有一份拷贝，这样可以节约内存空间，加快字符串操作任务的执行速度。注意，这个值会被存放在字符串内部池（String Intern Pool）</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 如何保证变量s指向的是字符串常量池中的数据呢？</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 有两种方式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 方式一： String s = &quot;shkstart&quot;;//字面量定义的方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 方式二： 调用intern()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *         String s = new String(&quot;shkstart&quot;).intern();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *         String s = new StringBuilder(&quot;shkstart&quot;).toString().intern();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Untitled" src="/Computer-Science-Learn-Notes/assets/images/f0e813156bdcaddaff24b9e7a9192714-0cb587212bf2e9ede0a8db11457c1f1b.png" width="745" height="233" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="面试题">面试题<a class="hash-link" href="#面试题" title="标题的直接链接">​</a></h2><blockquote><p>new String(“ab”)会创建几个对象</p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * new String(&quot;ab&quot;) 会创建几个对象？ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 看字节码就知道是2个对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class StringNewTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String str = new String(&quot;ab&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>转换成字节码来查看</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> new </span><span class="token comment" style="color:#999988;font-style:italic">#2 &lt;java/lang/String&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> dup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> ldc </span><span class="token comment" style="color:#999988;font-style:italic">#3 &lt;ab&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> invokespecial </span><span class="token comment" style="color:#999988;font-style:italic">#4 &lt;java/lang/String.&lt;init&gt; : (Ljava/lang/String;)V&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> astore_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这里面就是两个对象   </p><ul><li>一个对象是：new 关键字在堆空间中创建 （new #2 <code>&lt;java/lang/String&gt;</code>）</li><li>另一个对象：字符串常量池中的对象<em>“ab”</em> （ldc #3 <code>&lt;ab&gt;</code>）</li></ul><blockquote><p>new String(“a”) + new String(“b”) 会创建几个对象</p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * new String(&quot;a&quot;) + new String(&quot;b&quot;) 会创建几个对象? </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class StringNewTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String str = new String(&quot;a&quot;) + new String(&quot;b&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>转换成字节码来查看</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> new </span><span class="token comment" style="color:#999988;font-style:italic">#2 &lt;java/lang/StringBuilder&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> dup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> invokespecial </span><span class="token comment" style="color:#999988;font-style:italic">#3 &lt;java/lang/StringBuilder.&lt;init&gt; : ()V&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> new </span><span class="token comment" style="color:#999988;font-style:italic">#4 &lt;java/lang/String&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> dup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> ldc </span><span class="token comment" style="color:#999988;font-style:italic">#5 &lt;a&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> invokespecial </span><span class="token comment" style="color:#999988;font-style:italic">#6 &lt;java/lang/String.&lt;init&gt; : (Ljava/lang/String;)V&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">16</span><span class="token plain"> invokevirtual </span><span class="token comment" style="color:#999988;font-style:italic">#7 &lt;java/lang/StringBuilder.append : (Ljava/lang/String;)Ljava/lang/StringBuilder;&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">19</span><span class="token plain"> new </span><span class="token comment" style="color:#999988;font-style:italic">#4 &lt;java/lang/String&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> dup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> ldc </span><span class="token comment" style="color:#999988;font-style:italic">#8 &lt;b&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> invokespecial </span><span class="token comment" style="color:#999988;font-style:italic">#6 &lt;java/lang/String.&lt;init&gt; : (Ljava/lang/String;)V&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">28</span><span class="token plain"> invokevirtual </span><span class="token comment" style="color:#999988;font-style:italic">#7 &lt;java/lang/StringBuilder.append : (Ljava/lang/String;)Ljava/lang/StringBuilder;&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">31</span><span class="token plain"> invokevirtual </span><span class="token comment" style="color:#999988;font-style:italic">#9 &lt;java/lang/StringBuilder.toString : ()Ljava/lang/String;&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">34</span><span class="token plain"> astore_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">35</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我们创建了 6 个对象   </p><ul><li>对象1：<code>new StringBuilder()</code>  （ 0 new #2 <code>&lt;java/lang/StringBuilder&gt;</code>）</li><li>对象2：<code>new String(&quot;a&quot;)</code>  （7 new #4 <code>&lt;java/lang/String&gt;</code>）</li><li>对象3：常量池中的 “a”  （11 ldc #5 <code>&lt;a&gt;</code>）</li><li>对象4：<code>new String(&quot;b&quot;)</code>  （19 new #4 <code>&lt;java/lang/String&gt;</code>）</li><li>对象5：常量池中的 “b”  （23 ldc #8 <code>&lt;b&gt;</code>）</li><li>对象6：toString 中会创建一个 <code>new String(&quot;ab&quot;)</code> （31 invokevirtual #9 <code>&lt;java/lang/StringBuilder.toString : ()Ljava/lang/String;&gt;</code>）<ul><li>toString( )的调用，在字符串常量池中，没有生成&quot;ab&quot;</li></ul></li></ul><p>StringBuilder中toString( )源码</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public String toString() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Create a copy, don&#x27;t share the array</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new String(value, 0, count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我们转换成字节码来查看</p><p><img loading="lazy" alt="Untitled" src="/Computer-Science-Learn-Notes/assets/images/798a9f236ca88d01b7c7f408ac09dc20-6bed6ba547d0e61ce3ee8bd88951788d.png" width="2258" height="1052" class="img_ev3q"></p><p>可以看到toString( )里面只是new了一个String对象，并没有存放到字符串常量池中</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="intern的使用jdk6-vs-jdk78">intern的使用：JDK6 vs JDK7/8<a class="hash-link" href="#intern的使用jdk6-vs-jdk78" title="标题的直接链接">​</a></h2><p>注意观看注释：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class StringIntern {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * ① String s = new String(&quot;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 创建了两个对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         *      堆空间中一个new对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         *      字符串常量池中一个字符串常量&quot;1&quot;（注意：此时字符串常量池中已有&quot;1&quot;）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * ② s.intern()由于字符串常量池中已存在&quot;1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * s  指向的是堆空间中的对象地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * s2 指向的是堆空间中常量池中&quot;1&quot;的地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 所以不相等</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s = new String(&quot;1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        s.intern();//调用此方法之前，字符串常量池中已经存在了&quot;1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s2 = &quot;1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s == s2);//jdk6：false   jdk7/8：false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * ① String s3 = new String(&quot;1&quot;) + new String(&quot;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 等价于new String（&quot;11&quot;），但是，常量池中并不生成字符串&quot;11&quot;；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * ② s3.intern()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 由于此时常量池中并无&quot;11&quot;，所以把s3中记录的对象的地址存入常量池</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 所以s3 和 s4 指向的都是一个地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s3 = new String(&quot;1&quot;) + new String(&quot;1&quot;); // s3变量记录的地址为：new String(&quot;11&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 执行完上一行代码以后，字符串常量池中，是否存在&quot;11&quot;呢？答案：不存在！！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        s3.intern(); // 在字符串常量池中生成&quot;11&quot;。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 如何理解：jdk6:在常量池中真正创建了一个新的对象&quot;11&quot;,也就有新的地址。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //         jdk7:此时常量池中并没有真正创建&quot;11&quot;,而是创建一个指向堆空间中new String(&quot;11&quot;)的地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s4 = &quot;11&quot;;// s4变量记录的地址：使用的是上一行代码代码执行时，在常量池中生成的&quot;11&quot;的地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s3 == s4); // jdk6：false  jdk7/8：true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>详细解释第二段代码：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">String s3 = new String(&quot;1&quot;) + new String(&quot;1&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s3.intern();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String s4 = &quot;11&quot;;的&quot;11&quot;的地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(s3 == s4); // jdk6：false  jdk7/8：true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这段代码中在jdk6的时候intern会在堆中创建一个字符串对象，而s4使用的是常量池的对象，所以两者对象不同；而JDK7的时候，因为s3已经在堆里创建了一个11的对象了，所以intern--字符串常量池就可以引用这个对象，此时在再创建s4的时候是从字符串常量池中取出的，所以两者相等。</p><blockquote><p>JDK6</p></blockquote><p><img loading="lazy" alt="Untitled" src="/Computer-Science-Learn-Notes/assets/images/4bff89dae448aa94592f71326bc4f6a0-0e43a50cd65428607fd489f7b73dfcdf.png" width="1336" height="760" class="img_ev3q"></p><blockquote><p>JDK7</p></blockquote><p><img loading="lazy" alt="Untitled" src="/Computer-Science-Learn-Notes/assets/images/efe92bdce0b79d6013df82f7d278c275-ca4862f924b14f442e3022542c83c208.png" width="1097" height="469" class="img_ev3q"></p><blockquote><p>拓展</p></blockquote><p>调换了上一份代码的两个位置后结果发生了变化</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class StringIntern1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //StringIntern.java中练习的拓展：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s3 = new String(&quot;1&quot;) + new String(&quot;1&quot;);//new String(&quot;11&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //执行完上一行代码以后，字符串常量池中，是否存在&quot;11&quot;呢？答案：不存在！！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s4 = &quot;11&quot;;//在字符串常量池中生成对象&quot;11&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s5 = s3.intern();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s3 == s4);//false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s5 == s4);//true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>总结</p></blockquote><ul><li>JDK1.6中，将这个字符串对象尝试放入字符串常量池中。   <ul><li>如果字符串常量池中有，则并不会放入。返回已有的字符串常量池中的对象的地址</li><li>如果没有，会把<u>此对象复制一份</u>，放入字符串常量池，并返回字符串常量池中的对象地址</li></ul></li><li>JDK1.7起，将这个字符串对象尝试放入字符串常量池中。   <ul><li>如果字符串常量池中有，则并不会放入。返回已有的字符串常量池中的对象的地址</li><li>如果没有，则会把<u>对象的引用地址复制一份</u>，放入字符串常量池，并返回字符串常量池中的引用地址</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="练习">练习<a class="hash-link" href="#练习" title="标题的直接链接">​</a></h2><blockquote><p>练习1</p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class StringExer1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s = new String(&quot;a&quot;) + new String(&quot;b&quot;);//new String(&quot;ab&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //在上一行代码执行完以后，字符串常量池中并没有&quot;ab&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s2 = s.intern();//jdk6中：在字符串常量池中创建一个字符串&quot;ab&quot;,并把字符串常量池中的&quot;ab&quot;地址返回给s2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               //jdk8中：字符串常量池中没有创建字符串&quot;ab&quot;,而是创建一个引用，指向new String(&quot;ab&quot;)，将此引用返回给s2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s2 == &quot;ab&quot;);//jdk6:true  jdk8:true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s == &quot;ab&quot;);//jdk6:false  jdk8:true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Untitled" src="/Computer-Science-Learn-Notes/assets/images/b23c34ed87aaf2be2eae5b24de0052dd-49f367e97eb2b95b10a46e011b89147c.png" width="1105" height="576" class="img_ev3q"></p><p><img loading="lazy" alt="Untitled" src="/Computer-Science-Learn-Notes/assets/images/e610a302fb23ebff2d5069c3ed85473a-d4a33bdc89de10f2d3075f516e13e53c.png" width="1074" height="562" class="img_ev3q"></p><blockquote><p>练习2</p></blockquote><p>总结： String s1 = new String(&quot;a&quot;) + new String(&quot;b&quot;); 类似这样的代码是不会在字符串常量池中生成的</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class StringExer2 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        String s1 = new String(&quot;ab&quot;); // 执行完以后，会在字符串常量池中生成“ab”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s1 = new String(&quot;a&quot;) + new String(&quot;b&quot;); // 执行完以后，不会在字符串常量池中生成“ab”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        s1.intern();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s2 = &quot;ab&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(s1 == s2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Untitled" src="/Computer-Science-Learn-Notes/assets/images/9bfac92557e1e3023d28ef255b941c0f-da1b82cb5f84429ad59e541f58870939.png" width="1122" height="592" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="intern的效率测试空间角度">intern的效率测试：空间角度<a class="hash-link" href="#intern的效率测试空间角度" title="标题的直接链接">​</a></h2><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 使用intern()测试执行效率：空间使用上</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class StringIntern2 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static final int MAX_COUNT = 1000 * 10000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static final String[] arr = new String[MAX_COUNT];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Integer[] data = new Integer[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 10};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        long start = System.currentTimeMillis();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; MAX_COUNT; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            arr[i] = new String(String.valueOf(data[i % data.length]));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//            arr[i] = new String(String.valueOf(data[i % data.length])).intern();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        long end = System.currentTimeMillis();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;花费的时间为：&quot; + (end - start));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Thread.sleep(1000000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (InterruptedException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.gc();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>运行结果</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">不使用intern：4385ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">使用intern：901ms</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>不使用intern的情况下，产生了1千多万个String的实例对象</p><p><img loading="lazy" alt="image-20220304150012452" src="/Computer-Science-Learn-Notes/assets/images/image-20220304150012452-f19a8eae8d761d9530fed988df76bcba.png" width="1200" height="900" class="img_ev3q"></p><p>使用intern的情况下，只产生了2百多万个String的实例对象</p><p><img loading="lazy" alt="image-20220304145945546" src="/Computer-Science-Learn-Notes/assets/images/image-20220304145945546-78ef33e95621690a7d218981c7534c40.png" width="1200" height="900" class="img_ev3q"></p><blockquote><p>结论</p></blockquote><ul><li>对于程序中大量使用存在的字符串时，尤其存在很多已经重复的字符串时，使用intern( )方法能够节省内存空间。</li><li>大的网站平台，需要内存中存储大量的字符串。比如社交网站，很多人都存储：北京市、海淀区等信息。这时候如果字符串都调用intern( )方法，就会很明显降低内存的大小。</li></ul><h1>StringTable垃圾回收</h1><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * String的垃圾回收:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * -Xms15m -Xmx15m -XX:+PrintStringTableStatistics -XX:+PrintGCDetails</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class StringGCTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int j = 0; j &lt; 100000; j++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String.valueOf(j).intern();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当循环次数为00时，没有发生GC</p><p><img loading="lazy" alt="image-20220304150840853" src="/Computer-Science-Learn-Notes/assets/images/image-20220304150840853-3cfaf4da82f86d297ec4e9c4ec912448.png" width="940" height="714" class="img_ev3q"></p><p>当循环次数达到，发生了GC</p><p><img loading="lazy" alt="image-20220304150724397" src="/Computer-Science-Learn-Notes/assets/images/image-20220304150724397-e90b0887630c24739ee08b5f8ed2faca.png" width="1299" height="212" class="img_ev3q"></p><p><img loading="lazy" alt="image-20220304150806071" src="/Computer-Science-Learn-Notes/assets/images/image-20220304150806071-51ed53980f2035fbaa9b5f8217eca70c.png" width="672" height="152" class="img_ev3q"></p><h1>G1中的String去重操作</h1><p>官网地址：<a href="http://openjdk.java.net/jeps/192" target="_blank" rel="noopener noreferrer">JEP 192: String Deduplication in G1 (java.net)</a></p><blockquote><p>Motivation</p><p>Many large-scale Java applications are currently bottlenecked on  memory. Measurements have shown that roughly 25% of the Java heap live  data set in these types of applications is consumed by <code>String</code> objects. Further, roughly half of those <code>String</code> objects are duplicates, where duplicates means <code>string1.equals(string2)</code> is true. Having duplicate <code>String</code> objects on the heap is, essentially, just a waste of memory. This project will implement automatic and continuous <code>String</code> deduplication in the G1 garbage collector to avoid wasting memory and reduce the memory footprint.</p></blockquote><blockquote><p>目前，许多大规模的Java应用程序在内存上遇到了瓶颈。测量表明，在这些类型的应用程序中，大约25%的Java堆实时数据集被<code>String&#x27;对象所消耗。此外，这些 &quot;String &quot;对象中大约有一半是重复的，其中重复意味着 &quot;string1.equals(string2) &quot;是真的。在堆上有重复的</code>String’对象，从本质上讲，只是一种内存的浪费。这个项目将在G1垃圾收集器中实现自动和持续的`String’重复数据删除，以避免浪费内存，减少内存占用。</p></blockquote><blockquote><p>注意这里说的重复，指的是在堆中的数据，而不是常量池中的，因为常量池中的本身就不会重复</p></blockquote><blockquote><p>背景：对许多Java应用（有大的也有小的）做的测试得出以下结果：</p></blockquote><ul><li>堆存活数据集合里面string对象占了25%</li><li>堆存活数据集合里面重复的string对象有13.5%</li><li>string对象的平均长度是45</li></ul><blockquote><p>许多大规模的Java应用的瓶颈在于内存，测试表明，在这些类型的应用里面，Java堆中存活的数据集合差不多25%是String对象。更进一步，这里面差不多一半string对象是重复的，重复的意思是说： <code>string1.equals(string2) == true</code>。堆上存在重复的String对象必然是一种内存的浪费。这个项目将在G1垃圾收集器中实现自动持续对重复的string对象进行去重，这样就能避免浪费内存。</p></blockquote><blockquote><p><strong>实现</strong></p></blockquote><ul><li>当垃圾收集器工作的时候，会访问堆上存活的对象。对每一个访问的对象都会检查是否是候选的要去重的String对象</li><li>如果是，把这个对象的一个引用插入到队列中等待后续的处理。一个去重的线程在后台运行，处理这个队列。处理队列的一个元素意味着从队列删除这个元素，然后尝试去重它引用的string对象。</li><li>使用一个hashtable来记录所有的被String对象使用的不重复的char数组。当去重的时候，会查这个hashtable，来看堆上是否已经存在一个一模一样的char数组。</li><li>如果存在，String对象会被调整引用那个数组，释放对原来的数组的引用，最终会被垃圾收集器回收掉。</li><li>如果查找失败，char数组会被插入到hashtable，这样以后的时候就可以共享这个数组了。</li></ul><blockquote><p><strong>命令行选项</strong></p></blockquote><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 开启String去重，默认是不开启的，需要手动开启。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UseStringDeduplication(bool)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打印详细的去重统计信息 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PrintStringDeduplicationStatistics(bool)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 达到这个年龄的String对象被认为是去重的候选对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StringpeDuplicationAgeThreshold(uintx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes/edit/master/docs/Java/jvm/part1/13.StringTable.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vbeJ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/执行引擎"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">执行引擎</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Computer-Science-Learn-Notes/docs/Java/jvm/part1/垃圾回收概述"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">垃圾回收概述</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#string在jdk9中存储结构变更" class="table-of-contents__link toc-highlight">String在jdk9中存储结构变更</a></li><li><a href="#string的基本特性-1" class="table-of-contents__link toc-highlight">String的基本特性</a></li><li><a href="#面试题" class="table-of-contents__link toc-highlight">面试题</a></li><li><a href="#intern的使用jdk6-vs-jdk78" class="table-of-contents__link toc-highlight">intern的使用：JDK6 vs JDK7/8</a></li><li><a href="#练习" class="table-of-contents__link toc-highlight">练习</a></li><li><a href="#intern的效率测试空间角度" class="table-of-contents__link toc-highlight">intern的效率测试：空间角度</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Computer-Science-Learn-Notes/docs/intro">主页</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="#" class="footer__link-item">莫得</a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/zhiyu1998" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Computer Science Learn Notes, Inc. Built with Zhiyu1998.</div></div></div></footer></div>
<script src="/Computer-Science-Learn-Notes/assets/js/runtime~main.ac9df2f9.js"></script>
<script src="/Computer-Science-Learn-Notes/assets/js/main.a8b3a5e6.js"></script>
</body>
</html>